import{r as Ae,P as Je,s as Le,n as ve,d as v,i as V,Q,A as m,c as y,e as I,h as _,k as ke,x as Gt,R as ii,C as be,a as he,S as X,b as h,f as J,g as P,t as ee,j as R,T as xt,U as ni,V as ft,W as dt,B as Ze,v as pe,m as ai,X as ue,Y as _e}from"../chunks/D6DlaX6_.js";import{a as G,t as j,S as Ie,i as Be,g as ze,c as Pe,d as ne,m as ae,e as se,b as le,f as Te}from"../chunks/COUIFFA3.js";import{b as Xt,d as lt,w as Fe}from"../chunks/C3Y4d0h1.js";function Ye(t){return t?.length!==void 0?t:Array.from(t)}function jt(t,e){j(t,1,1,()=>{e.delete(t.key)})}function Zt(t,e,n,i,s,a,r,o,l,f,u,d){let c=t.length,g=a.length,b=c;const E={};for(;b--;)E[t[b].key]=b;const M=[],D=new Map,C=new Map,p=[];for(b=g;b--;){const A=d(s,a,b),T=n(A);let $=r.get(T);$?p.push(()=>$.p(A,e)):($=f(T,A),$.c()),D.set(T,M[b]=$),T in E&&C.set(T,Math.abs(b-E[T]))}const S=new Set,w=new Set;function L(A){G(A,1),A.m(o,u),r.set(A.key,A),u=A.first,g--}for(;c&&g;){const A=M[g-1],T=t[c-1],$=A.key,z=T.key;A===T?(u=A.first,c--,g--):D.has(z)?!r.has($)||S.has($)?L(A):w.has(z)?c--:C.get($)>C.get(z)?(w.add($),L(A)):(S.add(z),c--):(l(T,r),c--)}for(;c--;){const A=t[c];D.has(A.key)||l(A,r)}for(;g;)L(M[g-1]);return Ae(p),M}const et=new Map;async function Yt(t){if(et.has(t))return et.get(t);const e=await fetch(t);if(!e.ok)throw new Error(`Failed to load shader: ${t}`);const n=await e.text();return et.set(t,n),n}async function Wt(t,e,n=new Set){const i=/#include\s+"([^"]+)"/g;let s=t,a;const r=[];for(;(a=i.exec(t))!==null;)r.push({full:a[0],path:a[1]});for(const{full:o,path:l}of r){const f=e+l;if(n.has(f)){console.warn(`Circular include detected: ${f}`),s=s.replace(o,"");continue}n.add(f);try{let u=await Yt(f);u=await Wt(u,e,n),s=s.replace(o,u)}catch(u){console.error(`Failed to include shader: ${f}`,u),s=s.replace(o,`// Failed to include: ${l}`)}}return s}async function ct(t,e=`${Xt}/shaders/`){const n=await Yt(e+t);return Wt(n,e)}function mt(t,e,n){const i=t.createShader(e);if(!i)return console.error("Failed to create shader"),null;if(t.shaderSource(i,n),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){const s=t.getShaderInfoLog(i);console.error("Shader compilation error:",s);const r=n.split(`
`).map((o,l)=>`${l+1}: ${o}`);return console.error(`Shader source:
`+r.join(`
`)),t.deleteShader(i),null}return i}function si(t,e,n){const i=mt(t,t.VERTEX_SHADER,e),s=mt(t,t.FRAGMENT_SHADER,n);if(!i||!s)return null;const a=t.createProgram();if(!a)return console.error("Failed to create program"),null;if(t.attachShader(a,i),t.attachShader(a,s),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS)){const r=t.getProgramInfoLog(a);return console.error("Program linking error:",r),t.deleteProgram(a),null}return t.deleteShader(i),t.deleteShader(s),a}async function ht(t,e,n,i=`${Xt}/shaders/`){const[s,a]=await Promise.all([ct(e,i),ct(n,i)]);return si(t,s,a)}const He=[{id:"glow",label:"Center Glow",description:"Pulsing core with arcs",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerGlow",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerGlowZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerGlowTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerGlowSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerGlowMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/glow.glsl",randomizable:!0},{id:"turbulence",label:"Turbulence",description:"Audio-reactive turbulence",properties:[{id:"intensity",label:"Intensity",type:"range",default:.4,min:0,max:.8,step:.01,uniform:"uLayerTurbulence",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerTurbulenceZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerTurbulenceTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:.6,min:0,max:1.2,step:.01,uniform:"uLayerTurbulenceSensitivity",randomizable:!0,randomMin:.3,randomMax:.9},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerTurbulenceMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:.7,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.4,transform:"linear"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.2,transform:"linear"}],shaderPath:"layers/turbulence.glsl",randomizable:!0},{id:"displacement",label:"Displacement",description:"Cellular displacement waves",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerDisplacement",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerDisplacementZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerDisplacementTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerDisplacementSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerDisplacementMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.3,transform:"linear"}],shaderPath:"layers/displacement.glsl",randomizable:!0},{id:"starfield",label:"Starfield",description:"Warp tunnel streaks",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerStarfield",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerStarfieldZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerStarfieldTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerStarfieldSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerStarfieldMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"}],shaderPath:"layers/starfield.glsl",randomizable:!0},{id:"cubescape",label:"Cubescape",description:"3D cube lattice",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerCubescape",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerCubescapeZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerCubescapeTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerCubescapeSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerCubescapeMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/cubescape.glsl",randomizable:!0},{id:"spires",label:"Spires",description:"Cathedral-like pillars",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerSpires",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerSpiresZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerSpiresTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerSpiresSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerSpiresMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.3,transform:"linear"}],shaderPath:"layers/spires.glsl",randomizable:!0},{id:"mandala",label:"Mandala",description:"Radial symmetries",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerMandala",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerMandalaZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerMandalaTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerMandalaSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerMandalaMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/mandala.glsl",randomizable:!0},{id:"kaleidoscope",label:"Kaleidoscope",description:"Sacred geometry mirroring",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerKaleidoscope",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerKaleidoscopeZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerKaleidoscopeTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerKaleidoscopeSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerKaleidoscopeMouseSens"}],audioBindings:[{audioMetric:"treble",targetProperty:"intensity",sensitivity:1,transform:"linear"}],shaderPath:"layers/kaleidoscope.glsl",randomizable:!0},{id:"lissajous",label:"Lissajous",description:"Flowing curves",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerLissajous",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerLissajousZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerLissajousTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerLissajousSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerLissajousMouseSens"}],audioBindings:[{audioMetric:"energy",targetProperty:"intensity",sensitivity:1,transform:"linear"}],shaderPath:"layers/lissajous.glsl",randomizable:!0},{id:"flower",label:"Flower of Life",description:"Sacred circles",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerFlower",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerFlowerZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerFlowerTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerFlowerSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerFlowerMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"}],shaderPath:"layers/flower.glsl",randomizable:!0},{id:"fibonacci",label:"Fibonacci",description:"Golden spiral with phyllotaxis",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerFibonacci",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerFibonacciZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"points",label:"Points",type:"range",default:100,min:10,max:200,step:1,uniform:"uLayerFibonacciPoints",randomizable:!0,randomMin:30,randomMax:150},{id:"speed",label:"Spin",type:"range",default:1,min:0,max:3,step:.1,uniform:"uLayerFibonacciSpeed",randomizable:!0,randomMin:.3,randomMax:2},{id:"angle",label:"Angle",type:"range",default:1,min:.8,max:1.2,step:.01,uniform:"uLayerFibonacciAngle",randomizable:!0,randomMin:.92,randomMax:1.08},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerFibonacciTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerFibonacciSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerFibonacciMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"}],shaderPath:"layers/fibonacci.glsl",randomizable:!0},{id:"hopalong",label:"Hopalong Orbits",description:"Barry Martin attractor",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerHopalong",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerHopalongZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerHopalongTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerHopalongSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerHopalongMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/hopalong.glsl",randomizable:!0},{id:"metatron",label:"Metatron's Cube",description:"Sacred geometry with nested rings",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerMetatron",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerMetatronZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"rings",label:"Rings",type:"range",default:2,min:1,max:10,step:1,uniform:"uLayerMetatronRings",randomizable:!0,randomMin:1,randomMax:6},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerMetatronTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerMetatronSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerMetatronMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.6,transform:"linear"}],shaderPath:"layers/metatron.glsl",randomizable:!0}];class li{canvas;gl=null;program=null;uniformLocations={};mouseUniformLocations={};layerUniformLocations=new Map;reactionProgram=null;reactionUniforms={input:null,texel:null,time:null,treble:null};reactionSeeded=!1;feedbackTexture=null;feedbackReady=!1;reactionBuffer=null;positionBuffer=null;initialized=!1;currentTime=0;constructor(e){this.canvas=e}async init(){if(this.gl=this.canvas.getContext("webgl",{antialias:!1,preserveDrawingBuffer:!0}),!this.gl)return console.error("WebGL not supported"),!1;const e=this.gl;try{if(this.program=await ht(e,"quad.vert","composite.frag"),!this.program)return console.error("Failed to create shader program"),!1;if(this.reactionProgram=await ht(e,"quad.vert","reaction_diffusion.frag"),!this.reactionProgram)return console.error("Failed to create reaction-diffusion program"),!1;this.reactionUniforms={input:e.getUniformLocation(this.reactionProgram,"uInput"),texel:e.getUniformLocation(this.reactionProgram,"uTexel"),time:e.getUniformLocation(this.reactionProgram,"uTime"),treble:e.getUniformLocation(this.reactionProgram,"uTreble")}}catch(r){return console.error("Failed to load shaders:",r),!1}this.uniformLocations={time:e.getUniformLocation(this.program,"uTime"),resolution:e.getUniformLocation(this.program,"uResolution"),beat:e.getUniformLocation(this.program,"uBeat"),energy:e.getUniformLocation(this.program,"uEnergy"),treble:e.getUniformLocation(this.program,"uTreble"),feedbackTexture:e.getUniformLocation(this.program,"uFeedbackTex"),feedbackReady:e.getUniformLocation(this.program,"uFeedbackReady"),reactionTexture:e.getUniformLocation(this.program,"uReactionTex")},this.mouseUniformLocations={position:e.getUniformLocation(this.program,"uMouse"),velocity:e.getUniformLocation(this.program,"uMouseVelocity"),speed:e.getUniformLocation(this.program,"uMouseSpeed"),down:e.getUniformLocation(this.program,"uMouseDown"),click:e.getUniformLocation(this.program,"uMouseClick")};for(const r of He)for(const o of r.properties){const l=e.getUniformLocation(this.program,o.uniform);this.layerUniformLocations.set(o.uniform,l)}this.positionBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.positionBuffer);const n=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]);e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW);const i=e.getAttribLocation(this.program,"aPosition");e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),this.feedbackTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.feedbackTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.canvas.width,this.canvas.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);const s=Math.max(1,this.canvas.width),a=Math.max(1,this.canvas.height);return this.reactionBuffer=this.createPingPongBuffer(s,a),this.initialized=!0,!0}resize(){if(!this.gl||!this.canvas)return;const e=this.gl,n=window.devicePixelRatio||1,i=Math.floor(this.canvas.clientWidth*n),s=Math.floor(this.canvas.clientHeight*n);(this.canvas.width!==i||this.canvas.height!==s)&&(this.canvas.width=i,this.canvas.height=s,e.viewport(0,0,i,s),this.feedbackTexture&&(e.bindTexture(e.TEXTURE_2D,this.feedbackTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,i,s,0,e.RGBA,e.UNSIGNED_BYTE,null)),this.reactionBuffer&&(this.resizePingPongBuffer(this.reactionBuffer,i,s),this.reactionSeeded=!1),this.feedbackReady=!1)}render(e,n,i,s){if(!this.gl||!this.program||!this.initialized)return;const a=this.gl;this.currentTime=e,this.resize(),this.renderReactionDiffusion(8,n.treble),a.clearColor(0,0,0,1),a.clear(a.COLOR_BUFFER_BIT),a.useProgram(this.program);const r=a.getAttribLocation(this.program,"aPosition");a.bindBuffer(a.ARRAY_BUFFER,this.positionBuffer),a.enableVertexAttribArray(r),a.vertexAttribPointer(r,2,a.FLOAT,!1,0,0),a.uniform1f(this.uniformLocations.time,e),a.uniform2f(this.uniformLocations.resolution,this.canvas.width,this.canvas.height),a.uniform1f(this.uniformLocations.beat,n.beat),a.uniform1f(this.uniformLocations.energy,n.energy),a.uniform1f(this.uniformLocations.treble,n.treble),a.uniform2f(this.mouseUniformLocations.position,i.x,i.y),a.uniform2f(this.mouseUniformLocations.velocity,i.velocityX,i.velocityY),a.uniform1f(this.mouseUniformLocations.speed,i.speed),a.uniform1f(this.mouseUniformLocations.down,i.down),a.uniform2f(this.mouseUniformLocations.click,i.clickX,i.clickY);for(const[o,l]of Object.entries(s)){const f=this.layerUniformLocations.get(o);f&&a.uniform1f(f,l)}a.activeTexture(a.TEXTURE0),this.feedbackTexture&&this.feedbackReady?a.bindTexture(a.TEXTURE_2D,this.feedbackTexture):a.bindTexture(a.TEXTURE_2D,null),a.uniform1i(this.uniformLocations.feedbackTexture,0),a.uniform1f(this.uniformLocations.feedbackReady,this.feedbackReady?1:0),a.activeTexture(a.TEXTURE1),this.reactionBuffer&&this.reactionBuffer.textures[this.reactionBuffer.index]?a.bindTexture(a.TEXTURE_2D,this.reactionBuffer.textures[this.reactionBuffer.index]):a.bindTexture(a.TEXTURE_2D,null),a.uniform1i(this.uniformLocations.reactionTexture,1),a.drawArrays(a.TRIANGLES,0,6),this.canvas.width>0&&this.canvas.height>0&&this.feedbackTexture&&(a.bindTexture(a.TEXTURE_2D,this.feedbackTexture),a.copyTexSubImage2D(a.TEXTURE_2D,0,0,0,0,0,this.canvas.width,this.canvas.height),this.feedbackReady=!0),a.activeTexture(a.TEXTURE0)}dispose(){if(!this.gl)return;const e=this.gl;this.program&&(e.deleteProgram(this.program),this.program=null),this.reactionProgram&&(e.deleteProgram(this.reactionProgram),this.reactionProgram=null),this.positionBuffer&&(e.deleteBuffer(this.positionBuffer),this.positionBuffer=null),this.feedbackTexture&&(e.deleteTexture(this.feedbackTexture),this.feedbackTexture=null),this.reactionBuffer&&(this.disposePingPongBuffer(this.reactionBuffer),this.reactionBuffer=null),this.reactionSeeded=!1,this.initialized=!1}isInitialized(){return this.initialized}getCanvas(){return this.canvas}createPingPongBuffer(e,n){if(!this.gl)return null;const i=this.gl,s={textures:[null,null],framebuffers:[null,null],index:0,width:e,height:n};for(let a=0;a<2;a++){const r=i.createTexture();i.bindTexture(i.TEXTURE_2D,r),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e,n,0,i.RGBA,i.UNSIGNED_BYTE,null),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),s.textures[a]=r;const o=i.createFramebuffer();i.bindFramebuffer(i.FRAMEBUFFER,o),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,r,0);const l=i.checkFramebufferStatus(i.FRAMEBUFFER);l!==i.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer not complete:",l),s.framebuffers[a]=o}return i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindTexture(i.TEXTURE_2D,null),s}swapPingPong(e){e.index=1-e.index}resizePingPongBuffer(e,n,i){if(!this.gl||e.width===n&&e.height===i)return;const s=this.gl;e.width=n,e.height=i;for(let a=0;a<2;a++)e.textures[a]&&(s.bindTexture(s.TEXTURE_2D,e.textures[a]),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,n,i,0,s.RGBA,s.UNSIGNED_BYTE,null));s.bindTexture(s.TEXTURE_2D,null)}disposePingPongBuffer(e){if(!this.gl)return;const n=this.gl;for(let i=0;i<2;i++)e.textures[i]&&(n.deleteTexture(e.textures[i]),e.textures[i]=null),e.framebuffers[i]&&(n.deleteFramebuffer(e.framebuffers[i]),e.framebuffers[i]=null)}seedReactionBuffer(){if(!this.gl||!this.reactionBuffer)return;const e=this.gl,n=this.reactionBuffer.width,i=this.reactionBuffer.height,s=new Uint8Array(n*i*4);for(let a=0;a<i;a++)for(let r=0;r<n;r++){const o=(a*n+r)*4;s[o]=255;const l=r-n/2,f=a-i/2,u=Math.sqrt(l*l+f*f),d=Math.min(n,i)*.3;u<d&&Math.random()<.15?s[o+1]=255:s[o+1]=0,s[o+2]=0,s[o+3]=255}for(let a=0;a<2;a++)e.bindTexture(e.TEXTURE_2D,this.reactionBuffer.textures[a]),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n,i,0,e.RGBA,e.UNSIGNED_BYTE,s);e.bindTexture(e.TEXTURE_2D,null),this.reactionSeeded=!0}renderReactionDiffusion(e,n){if(!this.gl||!this.reactionProgram||!this.reactionBuffer||!this.positionBuffer)return;const i=this.gl;this.reactionSeeded||this.seedReactionBuffer(),i.useProgram(this.reactionProgram);const s=i.getAttribLocation(this.reactionProgram,"aPosition");i.bindBuffer(i.ARRAY_BUFFER,this.positionBuffer),i.enableVertexAttribArray(s),i.vertexAttribPointer(s,2,i.FLOAT,!1,0,0),i.uniform2f(this.reactionUniforms.texel,1/this.reactionBuffer.width,1/this.reactionBuffer.height),i.uniform1f(this.reactionUniforms.time,this.currentTime),i.uniform1f(this.reactionUniforms.treble,n);for(let a=0;a<e;a++){const r=this.reactionBuffer.index,o=1-r;i.bindFramebuffer(i.FRAMEBUFFER,this.reactionBuffer.framebuffers[o]),i.viewport(0,0,this.reactionBuffer.width,this.reactionBuffer.height),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.reactionBuffer.textures[r]),i.uniform1i(this.reactionUniforms.input,0),i.drawArrays(i.TRIANGLES,0,6),this.swapPingPong(this.reactionBuffer)}i.bindFramebuffer(i.FRAMEBUFFER,null),i.viewport(0,0,this.canvas.width,this.canvas.height)}}function xe(t,e,n){return t+(e-t)*n}function ri(t,e,n){return Math.min(Math.max(t,e),n)}class oi{context=null;analyser=null;source=null;freqData=null;stream=null;energy=0;treble=0;highs=0;mids=0;lows=0;bass=0;beatValue=0;beatCutoff=0;beatHold=0;smoothing=.3;beatFalloff=2.4;beatMin=.15;beatDecay=.98;beatHoldTime=.08;async init(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});const e=window.AudioContext||window.webkitAudioContext;return this.context=new e,this.source=this.context.createMediaStreamSource(this.stream),this.analyser=this.context.createAnalyser(),this.analyser.fftSize=2048,this.analyser.smoothingTimeConstant=.8,this.source.connect(this.analyser),this.freqData=new Uint8Array(this.analyser.frequencyBinCount),!0}catch(e){return console.error("Failed to initialize audio:",e),!1}}dispose(){this.source&&(this.source.disconnect(),this.source=null),this.context&&(this.context.close(),this.context=null),this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null),this.analyser=null,this.freqData=null}update(e){if(!this.analyser||!this.freqData)return this.getEmptyMetrics();this.analyser.getByteFrequencyData(this.freqData);const n=this.freqData.length,s=(this.context?.sampleRate||44100)/this.analyser.fftSize,a=120,r=200,o=2e3,l=6e3,f=Math.max(2,Math.floor(a/s)),u=Math.max(f+1,Math.floor(r/s)),d=Math.max(u+1,Math.floor(o/s)),c=Math.max(d+1,Math.floor(l/s)),g=Math.min(n-1,u),b=Math.min(n-1,d),E=Math.min(n-1,c);let M=0,D=0,C=0,p=0,S=0,w=0;for(let O=0;O<n;O++){const Y=this.freqData[O];M+=Y,O<f&&(D+=Y),O<g?C+=Y:O<b?p+=Y:O<E?S+=Y:w+=Y}const L=M/(n*255),A=D/(Math.max(1,f)*255),T=C/(Math.max(1,g)*255),$=p/(Math.max(1,b-g)*255),z=S/(Math.max(1,E-b)*255),x=w/(Math.max(1,n-E)*255);this.energy=xe(this.energy,L,this.smoothing),this.treble=xe(this.treble,x,this.smoothing),this.highs=xe(this.highs,z,this.smoothing),this.mids=xe(this.mids,$,this.smoothing),this.lows=xe(this.lows,T,this.smoothing),this.bass=xe(this.bass,A,this.smoothing);const U=Math.max(0,e);return this.beatValue=Math.max(0,this.beatValue-U*this.beatFalloff),T>this.beatCutoff&&T>this.beatMin&&(this.beatValue=ri(T*1.5,0,1),this.beatCutoff=T*1.1,this.beatHold=this.beatHoldTime),this.beatHold>0?this.beatHold-=U:this.beatCutoff=Math.max(this.beatMin,this.beatCutoff-U*this.beatDecay),{energy:this.energy,treble:this.treble,highs:this.highs,mids:this.mids,lows:this.lows,bass:this.bass,beat:this.beatValue}}getEmptyMetrics(){return{energy:0,treble:0,highs:0,mids:0,lows:0,bass:0,beat:0}}isInitialized(){return this.analyser!==null}}const ui={energy:0,treble:0,bass:0,mids:0,highs:0,lows:0,beat:0},fi={sensitivity:1,highsBoost:1,midsBoost:1,lowsBoost:1,trebleBoost:1,bassBoost:1,beatBoost:1,minMotion:.02,beatGate:.35,autoEnabled:!1,autoStrength:.4,autoDecay:.6,autoTarget:"all"},Kt=Fe(ui),ge=Fe(fi),at=Fe(!1),Qt=Fe(0);function Ee(t,e,n){return Math.min(Math.max(t,e),n)}const rt=lt([Kt,ge,Qt],([t,e,n])=>{const i=Ee(e.sensitivity,0,2);let s=Ee(t.energy*i,0,2),a=Ee(t.treble*i*e.trebleBoost,0,2),r=Ee(t.beat*i*e.beatBoost*e.bassBoost,0,2);const o=(e.highsBoost+e.midsBoost+e.lowsBoost)/3;if(s*=o,s=Math.max(s,e.minMotion),a=Math.max(a,e.minMotion),r=Math.max(r,e.minMotion),e.autoEnabled&&n>0){const l=n*e.autoStrength;switch(e.autoTarget){case"energy":s+=l;break;case"treble":a+=l;break;case"beat":r+=l;break;default:s+=l,a+=l,r+=l}}return{energy:Ee(s,0,2),treble:Ee(a,0,2),beat:Ee(r,0,2),raw:{highs:Ee(t.highs*i,0,2),mids:Ee(t.mids*i,0,2),lows:Ee(t.lows*i,0,2),treble:Ee(t.treble*i,0,2),bass:Ee(t.bass*i,0,2),beat:Ee(t.beat*i,0,2)}}});function di(){const t=new Map;for(const e of He){const n={};for(const i of e.properties)n[i.id]=i.default;t.set(e.id,{id:e.id,enabled:!1,properties:n,includeInRandomizer:e.randomizable!==!1,includeInStrobe:e.randomizable!==!1})}return t}const Ce=Fe(di());function pt(t,e,n){Ce.update(i=>{const s=i.get(t);return s&&(s.properties[e]=n),i})}function ci(t){Ce.update(e=>{const n=e.get(t);if(n&&(n.enabled=!n.enabled,n.enabled)){const s=He.find(a=>a.id===t)?.properties.find(a=>a.id==="intensity");s&&(n.properties.intensity=s.default)}return e})}function mi(t){Ce.update(e=>{const n=e.get(t);return n&&(n.includeInRandomizer=!n.includeInRandomizer),e})}function hi(t){Ce.update(e=>{const n=e.get(t);return n&&(n.includeInStrobe=!n.includeInStrobe),e})}function pi(t){Ce.update(e=>{for(const n of e.values())if(n.enabled=t,t){const s=He.find(a=>a.id===n.id)?.properties.find(a=>a.id==="intensity");s&&(n.properties.intensity=s.default)}return e})}const vi=lt([Ce,rt],([t,e])=>{const n={};for(const i of He){const s=t.get(i.id);if(s){for(const a of i.properties){let r=s.properties[a.id]??a.default;a.id==="intensity"&&!s.enabled&&(r=0),n[a.uniform]=r}for(const a of i.audioBindings)if(e[a.audioMetric],i.properties.find(o=>o.id===a.targetProperty)){const o=i.properties.find(l=>l.id==="sensitivity");o&&(n[o.uniform]=s.properties.sensitivity??1)}}}return n}),bi={panelsVisible:!0,fullscreen:!1,pipEnabled:!1,powerSaverEnabled:!1,targetFps:60,randomizerEnabled:!0,randomizerCooldown:2,randomizerTogglesLayers:!0,randomizerToggleChance:.3},me=Fe(bi);function gi(){me.update(t=>({...t,panelsVisible:!t.panelsVisible}))}function yi(){me.update(t=>({...t,powerSaverEnabled:!t.powerSaverEnabled}))}function _i(){me.update(t=>({...t,randomizerEnabled:!t.randomizerEnabled}))}function Ti(){me.update(t=>({...t,randomizerTogglesLayers:!t.randomizerTogglesLayers}))}const ot=[{id:0,label:"LSD (Rainbow)",preview:"linear-gradient(90deg, #ff0000, #ff8800, #ffff00, #00ff00, #00ffff, #0088ff, #8800ff, #ff00ff)",brightness:"bright",temperature:"neutral",saturation:"high",family:"spectrum"},{id:1,label:"Sunset",preview:"linear-gradient(90deg, #ff2e1f, #ff8c1f, #ffd940)",brightness:"bright",temperature:"warm",saturation:"high",family:"fire"},{id:2,label:"Aurora",preview:"linear-gradient(90deg, #0dd9b3, #1a59ff, #8ce6ff)",brightness:"medium",temperature:"cool",saturation:"high",family:"ocean"},{id:3,label:"Ultraviolet",preview:"linear-gradient(90deg, #8c26ff, #ff33bf, #3366ff)",brightness:"medium",temperature:"cool",saturation:"high",family:"cosmic"},{id:4,label:"Neon",preview:"linear-gradient(90deg, #1aff73, #ff1ad9)",brightness:"bright",temperature:"neutral",saturation:"high",family:"neon"},{id:5,label:"Split Complement",preview:"linear-gradient(90deg, #14d1ff, #ff7333, #cc33ff)",brightness:"bright",temperature:"neutral",saturation:"high",family:"spectrum"},{id:6,label:"Analogous Cool",preview:"linear-gradient(90deg, #14e6bf, #268cff, #6640ff)",brightness:"medium",temperature:"cool",saturation:"high",family:"ocean"},{id:7,label:"Tetradic",preview:"linear-gradient(90deg, #ff4d59, #33e699, #4073ff, #ffd933)",brightness:"bright",temperature:"neutral",saturation:"high",family:"spectrum"},{id:8,label:"Pastel Triad",preview:"linear-gradient(90deg, #e6a3a3, #a3e6b8, #a3b8e6)",brightness:"medium",temperature:"neutral",saturation:"low",family:"twilight"},{id:9,label:"Bioluminescent",preview:"linear-gradient(90deg, #001426, #00a3cc, #4dff99, #004066)",brightness:"dark",temperature:"cool",saturation:"medium",family:"ocean"},{id:10,label:"Iridescent",preview:"linear-gradient(90deg, #1a004d, #0080a6, #e6338c, #ffcc33, #33e666)",brightness:"medium",temperature:"neutral",saturation:"medium",family:"twilight"},{id:11,label:"Chromatic",preview:"linear-gradient(90deg, #ff0066, #00ff88, #0066ff, #ff0066)",brightness:"bright",temperature:"neutral",saturation:"high",family:"neon"},{id:12,label:"Golden Liminal",preview:"linear-gradient(90deg, #ffbf4d, #d9738c, #664db3, #261a59)",brightness:"medium",temperature:"warm",saturation:"medium",family:"twilight"},{id:13,label:"OK Rainbow",preview:"linear-gradient(90deg, #ff6b8a, #e6a040, #8fbf40, #40bfbf, #6b8aff, #bf40bf)",brightness:"medium",temperature:"neutral",saturation:"medium",family:"spectrum"},{id:14,label:"Synesthetic",preview:"linear-gradient(90deg, #7733ff, #cc33cc, #ff33aa, #ff66cc)",brightness:"medium",temperature:"cool",saturation:"high",family:"cosmic"},{id:15,label:"Entropy",preview:"linear-gradient(90deg, #00ffff, #1a0033, #ff4d00, #00cc33)",brightness:"medium",temperature:"neutral",saturation:"high",family:"neon"},{id:16,label:"Velvet Depths",preview:"linear-gradient(90deg, #1f142e, #8c59a6, #e6d9f2, #402659)",brightness:"dark",temperature:"cool",saturation:"low",family:"cosmic"},{id:17,label:"Solar Flare",preview:"linear-gradient(90deg, #1a0000, #cc1a00, #ff9900, #ffffb3)",brightness:"bright",temperature:"warm",saturation:"high",family:"fire"},{id:18,label:"Void Pulse",preview:"linear-gradient(90deg, #000000, #660019, #cc3366, #000000)",brightness:"dark",temperature:"warm",saturation:"low",family:"cosmic"},{id:19,label:"Starless Night",preview:"linear-gradient(90deg, #050a14, #1a3a66, #050a14)",brightness:"dark",temperature:"cool",saturation:"low",family:"ocean"},{id:20,label:"Event Horizon",preview:"linear-gradient(90deg, #000000, #000000, #ff6619, #99ccff, #000000)",brightness:"dark",temperature:"neutral",saturation:"medium",family:"cosmic"}],ki={spectrum:[0,5,7,13],fire:[1,12,17,18],ocean:[2,6,9,19],cosmic:[3,14,16,18,20],neon:[4,11,15],twilight:[8,10,12]};function Qe(t){return ot.find(e=>e.id===t)}const wi={dark:.2,medium:.5,bright:1},vt=Fe({lastChangeTime:0,cooldown:2}),bt=2.5;function gt(t,e){return t+Math.random()*(e-t)}function st(t,e){return Math.floor(Math.random()*(e-t+1))+t}function tt(t){if(t.length===0)throw new Error("randomChoice called with empty array");return t[st(0,t.length-1)]}function Ei(t,e){let n=0;for(const[i,s]of t)if(s.enabled&&i!==e){const a=Qe(s.properties.theme);a&&(n+=wi[a.brightness])}return n}function Mi(t){return ot.filter(e=>t.includes(e.brightness))}function Si(t,e){const n={};for(const[a,r]of t)if(r.enabled&&a!==e){const o=Qe(r.properties.theme);o&&(n[o.family]=(n[o.family]||0)+1)}let i=0,s=null;for(const[a,r]of Object.entries(n))r>i&&(i=r,s=a);return s}function Li(t,e){const n=Ei(t,e),i=Si(t,e);let s;n>=bt?s=["dark"]:n>=bt-.5?s=["dark","medium"]:s=["dark","medium","bright"];const a=Mi(s);if(a.length===0)return 0;if(i&&Math.random()<.5){const r=ki[i],o=a.filter(l=>r.includes(l.id));if(o.length>0)return tt(o).id}if(Math.random()<.3){const r=new Set;for(const[o,l]of t)if(l.enabled&&o!==e){const f=Qe(l.properties.theme);f&&r.add(f.temperature)}if(r.size===1){const o=[...r][0];let l=null;if(o==="warm"?l="cool":o==="cool"&&(l="warm"),l){const f=a.filter(u=>u.temperature===l);if(f.length>0)return tt(f).id}}}return tt(a).id}function Ii(t){const e=Qe(t);if(!e)return{min:.3,max:.7};switch(e.brightness){case"dark":return{min:.5,max:.9};case"medium":return{min:.3,max:.7};case"bright":return{min:.2,max:.5}}}function Bi(t){const e=Je(me);if(!e.randomizerEnabled)return;const n=Je(vt),i=performance.now()/1e3;if(i-n.lastChangeTime<e.randomizerCooldown||t<.6)return;const s=Je(Ce),a=He.filter(l=>{const f=s.get(l.id);return l.randomizable!==!1&&(f?.includeInRandomizer||f?.includeInStrobe)});if(a.length===0)return;const r=a[st(0,a.length-1)];s.get(r.id)&&(Ce.update(l=>{const f=l.get(r.id);if(!f)return l;if(e.randomizerTogglesLayers&&f.includeInStrobe&&Math.random()<e.randomizerToggleChance&&(f.enabled=!f.enabled),f.enabled&&f.includeInRandomizer){const u=He.find(d=>d.id===r.id);if(!u)return l;for(const d of u.properties)if(d.randomizable){if(d.id==="theme"){f.properties.theme=Li(l,r.id);continue}if(d.id==="intensity"){const c=Ii(f.properties.theme);f.properties.intensity=gt(c.min,c.max);continue}if(d.type==="range"&&d.min!==void 0&&d.max!==void 0){const c=d.randomMin??d.min,g=d.randomMax??d.max;d.step&&d.step>=1?f.properties[d.id]=st(c,g):f.properties[d.id]=gt(c,g)}}}return l}),vt.update(l=>({...l,lastChangeTime:i})))}const Di={position:{x:.5,y:.5},velocity:{x:0,y:0},speed:0,isDown:!1,clickPosition:{x:.5,y:.5},isInside:!1},We=Fe(Di),yt=.15,zi=.1;let Xe={x:0,y:0},it=0;function $e(t,e,n){return Math.min(Math.max(t,e),n)}const Pi=lt(We,t=>(Xe.x+=(t.velocity.x-Xe.x)*yt,Xe.y+=(t.velocity.y-Xe.y)*yt,it+=(t.speed-it)*zi,{x:t.position.x,y:t.position.y,velocityX:$e(Xe.x,-1,1),velocityY:$e(Xe.y,-1,1),speed:$e(it,0,1),down:t.isDown?1:0,clickX:t.clickPosition.x,clickY:t.clickPosition.y,inside:t.isInside?1:0}));function Ri(t,e,n,i){We.update(s=>{const a=$e((t-n.left)/n.width,0,1),r=$e((e-n.top)/n.height,0,1),o=Math.max(i,1),l=(a-s.position.x)/o*16.67,f=(r-s.position.y)/o*16.67,u=Math.sqrt(l*l+f*f);return{...s,position:{x:a,y:r},velocity:{x:l,y:f},speed:$e(u*10,0,1),isInside:!0}})}function Ci(t,e,n){We.update(i=>{const s=$e((t-n.left)/n.width,0,1),a=$e((e-n.top)/n.height,0,1);return{...i,isDown:!0,clickPosition:{x:s,y:a}}})}function Ai(){We.update(t=>({...t,isDown:!1}))}function Fi(){We.update(t=>({...t,isInside:!1,velocity:{x:0,y:0},speed:0}))}const Ui={fps:0,frameTime:0,targetFps:60,cpuSavings:0,mode:"normal"},Jt=Fe(Ui);function Vi(t){let e,n,i;return{c(){e=_("canvas"),this.h()},l(s){e=y(s,"CANVAS",{class:!0,"aria-label":!0}),I(e).forEach(v),this.h()},h(){m(e,"class","visualizer-canvas svelte-1nin8xa"),m(e,"aria-label","Audio reactive canvas")},m(s,a){V(s,e,a),t[9](e),n||(i=[Q(e,"click",t[1]),Q(e,"touchend",t[2]),Q(e,"mousemove",t[3]),Q(e,"mousedown",t[4]),Q(e,"mouseup",t[5]),Q(e,"mouseleave",t[6])],n=!0)},p:ve,i:ve,o:ve,d(s){s&&v(e),t[9](null),n=!1,Ae(i)}}}const Ni=500,Oi=100,Ke=32;function $i(t,e,n){let i,s,a,r,o;ke(t,me,k=>n(22,i=k)),ke(t,vi,k=>n(23,s=k)),ke(t,Pi,k=>n(24,a=k)),ke(t,rt,k=>n(25,r=k)),ke(t,ge,k=>n(26,o=k));let l,f=null,u=null,d,c=0,g=0,b=0,E=0,M=0,D=null,C=null,p=null;function S(){D=document.createElement("canvas"),D.width=Ke,D.height=Ke,C=D.getContext("2d"),p=document.querySelector('link[rel="icon"]'),p||(p=document.createElement("link"),p.rel="icon",p.type="image/png",document.head.appendChild(p))}function w(k){if(!D||!C||!p||!l||k-b<Oi)return;b=k;const q=Math.min(l.width,l.height),te=(l.width-q)/2,F=(l.height-q)/2;C.drawImage(l,te,F,q,q,0,0,Ke,Ke);try{p.href=D.toDataURL("image/png")}catch{}}async function L(){u||(u=new oi);const k=await u.init();return at.set(k),k}function A(){u&&(u.dispose(),u=null),at.set(!1)}function T(k){const q=1e3/i.targetFps;if(i.powerSaverEnabled){const F=k-c;if(F<q){d=window.setTimeout(()=>requestAnimationFrame(T),q-F);return}}i.powerSaverEnabled?d=window.setTimeout(()=>requestAnimationFrame(T),q):d=requestAnimationFrame(T);const te=(k-c)/1e3;if(c=k,u?.isInitialized()){const F=u.update(te);Kt.set(F);const N=o.beatGate,ie=F.beat>N;Qt.update(ye=>{if(o.autoEnabled){if(ie)return 1;const fe=.5+o.autoDecay*3.5;return Math.max(0,ye-te*fe)}return 0}),Bi(F.beat)}if(f?.isInitialized()&&(f.render(k/1e3,r,a,s),w(k)),E++,k-M>=Ni){const F=(k-M)/1e3,N=Math.round(E/F),ie=i.targetFps,ye=F*1e3/E,fe=i.powerSaverEnabled?Math.round((1-ie/60)*100):0;Jt.set({fps:N,frameTime:ye,targetFps:ie,cpuSavings:Math.max(0,fe),mode:i.powerSaverEnabled?"power-saver":"normal"}),E=0,M=k}}Gt(async()=>{if(f=new li(l),await f.init()){const q=performance.now();c=q,M=q,S(),d=requestAnimationFrame(T)}}),ii(()=>{d&&(cancelAnimationFrame(d),clearTimeout(d)),f&&f.dispose(),u&&u.dispose()});function $(){me.update(k=>({...k,panelsVisible:!k.panelsVisible}))}let z=0;function x(k){const q=Date.now();q-z<300&&U(),z=q}async function U(){document.fullscreenElement?(await document.exitFullscreen(),me.update(k=>({...k,fullscreen:!1}))):(await document.documentElement.requestFullscreen(),me.update(k=>({...k,fullscreen:!0})))}function O(k){if(!l)return;const q=performance.now(),te=q-g;g=q;const F=l.getBoundingClientRect();Ri(k.clientX,k.clientY,F,te)}function Y(k){if(!l)return;const q=l.getBoundingClientRect();Ci(k.clientX,k.clientY,q)}function W(){Ai()}function Z(){Fi()}function H(k){be[k?"unshift":"push"](()=>{l=k,n(0,l)})}return[l,$,x,O,Y,W,Z,L,A,H]}class Hi extends Ie{constructor(e){super(),Be(this,e,$i,Vi,Le,{enableMicrophone:7,disableMicrophone:8})}get enableMicrophone(){return this.$$.ctx[7]}get disableMicrophone(){return this.$$.ctx[8]}}function _t(t){let e,n=t[6](t[0])+"",i;return{c(){e=_("span"),i=ee(n),this.h()},l(s){e=y(s,"SPAN",{class:!0});var a=I(e);i=J(a,n),a.forEach(v),this.h()},h(){m(e,"class","slider-value svelte-13dvwfr")},m(s,a){V(s,e,a),h(e,i)},p(s,a){a&65&&n!==(n=s[6](s[0])+"")&&he(i,n)},d(s){s&&v(e)}}}function qi(t){let e,n,i,s,a,r,o,l,f,u=t[5]&&_t(t);return{c(){e=_("div"),n=_("div"),i=_("span"),s=ee(t[1]),a=R(),u&&u.c(),r=R(),o=_("input"),this.h()},l(d){e=y(d,"DIV",{class:!0});var c=I(e);n=y(c,"DIV",{class:!0});var g=I(n);i=y(g,"SPAN",{class:!0});var b=I(i);s=J(b,t[1]),b.forEach(v),a=P(g),u&&u.l(g),g.forEach(v),r=P(c),o=y(c,"INPUT",{type:!0,min:!0,max:!0,step:!0,"aria-label":!0,class:!0}),c.forEach(v),this.h()},h(){m(i,"class","slider-label svelte-13dvwfr"),m(n,"class","slider-header svelte-13dvwfr"),m(o,"type","range"),m(o,"min",t[2]),m(o,"max",t[3]),m(o,"step",t[4]),o.value=t[0],m(o,"aria-label",t[1]),m(o,"class","svelte-13dvwfr"),m(e,"class","slider svelte-13dvwfr"),X(e,"compact",t[7])},m(d,c){V(d,e,c),h(e,n),h(n,i),h(i,s),h(n,a),u&&u.m(n,null),h(e,r),h(e,o),l||(f=Q(o,"input",t[8]),l=!0)},p(d,[c]){c&2&&he(s,d[1]),d[5]?u?u.p(d,c):(u=_t(d),u.c(),u.m(n,null)):u&&(u.d(1),u=null),c&4&&m(o,"min",d[2]),c&8&&m(o,"max",d[3]),c&16&&m(o,"step",d[4]),c&1&&(o.value=d[0]),c&2&&m(o,"aria-label",d[1]),c&128&&X(e,"compact",d[7])},i:ve,o:ve,d(d){d&&v(e),u&&u.d(),l=!1,f()}}}function Gi(t,e,n){let{label:i}=e,{value:s}=e,{min:a=0}=e,{max:r=1}=e,{step:o=.01}=e,{showValue:l=!0}=e,{formatValue:f=g=>g.toFixed(2)}=e,{compact:u=!0}=e;const d=xt();function c(g){const b=g.target;n(0,s=parseFloat(b.value)),d("input",s)}return t.$$set=g=>{"label"in g&&n(1,i=g.label),"value"in g&&n(0,s=g.value),"min"in g&&n(2,a=g.min),"max"in g&&n(3,r=g.max),"step"in g&&n(4,o=g.step),"showValue"in g&&n(5,l=g.showValue),"formatValue"in g&&n(6,f=g.formatValue),"compact"in g&&n(7,u=g.compact)},[s,i,a,r,o,l,f,u,c]}class Me extends Ie{constructor(e){super(),Be(this,e,Gi,qi,Le,{label:1,value:0,min:2,max:3,step:4,showValue:5,formatValue:6,compact:7})}}function xi(t){let e,n,i,s,a,r,o;return{c(){e=_("button"),n=_("span"),i=R(),s=_("span"),a=ee(t[1]),this.h()},l(l){e=y(l,"BUTTON",{class:!0,"aria-pressed":!0,type:!0});var f=I(e);n=y(f,"SPAN",{class:!0}),I(n).forEach(v),i=P(f),s=y(f,"SPAN",{class:!0});var u=I(s);a=J(u,t[1]),u.forEach(v),f.forEach(v),this.h()},h(){m(n,"class","toggle-indicator svelte-1qxicao"),m(s,"class","toggle-label svelte-1qxicao"),m(e,"class","toggle svelte-1qxicao"),m(e,"aria-pressed",t[0]),e.disabled=t[2],m(e,"type","button"),X(e,"checked",t[0]),X(e,"disabled",t[2]),X(e,"compact",t[3])},m(l,f){V(l,e,f),h(e,n),h(e,i),h(e,s),h(s,a),r||(o=Q(e,"click",t[4]),r=!0)},p(l,[f]){f&2&&he(a,l[1]),f&1&&m(e,"aria-pressed",l[0]),f&4&&(e.disabled=l[2]),f&1&&X(e,"checked",l[0]),f&4&&X(e,"disabled",l[2]),f&8&&X(e,"compact",l[3])},i:ve,o:ve,d(l){l&&v(e),r=!1,o()}}}function Xi(t,e,n){let{label:i}=e,{checked:s=!1}=e,{disabled:a=!1}=e,{compact:r=!0}=e;function o(){a||n(0,s=!s)}return t.$$set=l=>{"label"in l&&n(1,i=l.label),"checked"in l&&n(0,s=l.checked),"disabled"in l&&n(2,a=l.disabled),"compact"in l&&n(3,r=l.compact)},[s,i,a,r,o]}class ei extends Ie{constructor(e){super(),Be(this,e,Xi,xi,Le,{label:1,checked:0,disabled:2,compact:3})}}function Tt(t,e,n){const i=t.slice();return i[8]=e[n],i}function kt(t){let e;return{c(){e=_("span"),this.h()},l(n){e=y(n,"SPAN",{class:!0,style:!0}),I(e).forEach(v),this.h()},h(){m(e,"class","select-preview svelte-1weciec"),Ze(e,"background",t[2].find(t[6])?.preview)},m(n,i){V(n,e,i)},p(n,i){i&5&&Ze(e,"background",n[2].find(n[6])?.preview)},d(n){n&&v(e)}}}function wt(t){let e,n=t[8].label+"",i,s;return{c(){e=_("option"),i=ee(n),this.h()},l(a){e=y(a,"OPTION",{});var r=I(e);i=J(r,n),r.forEach(v),this.h()},h(){e.__value=s=t[8].value,dt(e,e.__value)},m(a,r){V(a,e,r),h(e,i)},p(a,r){r&4&&n!==(n=a[8].label+"")&&he(i,n),r&4&&s!==(s=a[8].value)&&(e.__value=s,dt(e,e.__value))},d(a){a&&v(e)}}}function ji(t){let e,n,i,s,a,r=t[2].find(t[5])?.preview,o,l,f,u,d=r&&kt(t),c=Ye(t[2]),g=[];for(let b=0;b<c.length;b+=1)g[b]=wt(Tt(t,c,b));return{c(){e=_("div"),n=_("span"),i=ee(t[1]),s=R(),a=_("div"),d&&d.c(),o=R(),l=_("select");for(let b=0;b<g.length;b+=1)g[b].c();this.h()},l(b){e=y(b,"DIV",{class:!0});var E=I(e);n=y(E,"SPAN",{class:!0});var M=I(n);i=J(M,t[1]),M.forEach(v),s=P(E),a=y(E,"DIV",{class:!0});var D=I(a);d&&d.l(D),o=P(D),l=y(D,"SELECT",{"aria-label":!0,class:!0});var C=I(l);for(let p=0;p<g.length;p+=1)g[p].l(C);C.forEach(v),D.forEach(v),E.forEach(v),this.h()},h(){m(n,"class","select-label svelte-1weciec"),m(l,"aria-label",t[1]),m(l,"class","svelte-1weciec"),m(a,"class","select-container svelte-1weciec"),m(e,"class","select-wrapper svelte-1weciec"),X(e,"compact",t[3])},m(b,E){V(b,e,E),h(e,n),h(n,i),h(e,s),h(e,a),d&&d.m(a,null),h(a,o),h(a,l);for(let M=0;M<g.length;M+=1)g[M]&&g[M].m(l,null);ft(l,t[0]),f||(u=Q(l,"change",t[4]),f=!0)},p(b,[E]){if(E&2&&he(i,b[1]),E&5&&(r=b[2].find(b[5])?.preview),r?d?d.p(b,E):(d=kt(b),d.c(),d.m(a,o)):d&&(d.d(1),d=null),E&4){c=Ye(b[2]);let M;for(M=0;M<c.length;M+=1){const D=Tt(b,c,M);g[M]?g[M].p(D,E):(g[M]=wt(D),g[M].c(),g[M].m(l,null))}for(;M<g.length;M+=1)g[M].d(1);g.length=c.length}E&5&&ft(l,b[0]),E&2&&m(l,"aria-label",b[1]),E&8&&X(e,"compact",b[3])},i:ve,o:ve,d(b){b&&v(e),d&&d.d(),ni(g,b),f=!1,u()}}}function Zi(t,e,n){let{label:i}=e,{value:s}=e,{options:a=[]}=e,{compact:r=!0}=e;const o=xt();function l(d){const c=d.target;n(0,s=isNaN(Number(c.value))?c.value:Number(c.value)),o("change",s)}const f=d=>d.value===s,u=d=>d.value===s;return t.$$set=d=>{"label"in d&&n(1,i=d.label),"value"in d&&n(0,s=d.value),"options"in d&&n(2,a=d.options),"compact"in d&&n(3,r=d.compact)},[s,i,a,r,l,f,u]}class ti extends Ie{constructor(e){super(),Be(this,e,Zi,ji,Le,{label:1,value:0,options:2,compact:3})}}function Yi(t){let e,n,i,s,a,r,o,l,f;return{c(){e=_("div"),n=_("span"),i=ee(t[0]),s=R(),a=_("div"),r=_("div"),o=R(),l=_("span"),f=ee(t[1]),this.h()},l(u){e=y(u,"DIV",{class:!0});var d=I(e);n=y(d,"SPAN",{class:!0});var c=I(n);i=J(c,t[0]),c.forEach(v),s=P(d),a=y(d,"DIV",{class:!0});var g=I(a);r=y(g,"DIV",{class:!0,style:!0}),I(r).forEach(v),g.forEach(v),o=P(d),l=y(d,"SPAN",{class:!0});var b=I(l);f=J(b,t[1]),b.forEach(v),d.forEach(v),this.h()},h(){m(n,"class","level-label svelte-2vktfp"),m(r,"class","level-fill svelte-2vktfp"),Ze(r,"width",t[2]+"%"),m(a,"class","level-bar svelte-2vktfp"),m(l,"class","level-value svelte-2vktfp"),m(e,"class","level-meter svelte-2vktfp")},m(u,d){V(u,e,d),h(e,n),h(n,i),h(e,s),h(e,a),h(a,r),h(e,o),h(e,l),h(l,f)},p(u,[d]){d&1&&he(i,u[0]),d&4&&Ze(r,"width",u[2]+"%"),d&2&&he(f,u[1])},i:ve,o:ve,d(u){u&&v(e)}}}function Wi(t,e,n){let i,s,{label:a}=e,{value:r=0}=e,{max:o=1}=e;return t.$$set=l=>{"label"in l&&n(0,a=l.label),"value"in l&&n(3,r=l.value),"max"in l&&n(4,o=l.max)},t.$$.update=()=>{t.$$.dirty&24&&n(2,i=Math.min(100,r/o*100)),t.$$.dirty&8&&n(1,s=r.toFixed(2))},[a,s,i,r,o]}class je extends Ie{constructor(e){super(),Be(this,e,Wi,Yi,Le,{label:0,value:3,max:4})}}function Et(t){let e,n,i='<span class="panel-title svelte-60ik2m">CONTROLS</span>',s,a,r,o,l,f,u,d,c='<span class="label">FULLSCR</span>',g,b,E='<span class="label">PWR SAV</span>',M,D,C='<span class="label">README</span>',p,S,w='<kbd class="svelte-60ik2m">C</kbd> panels <kbd class="svelte-60ik2m">F</kbd> fullscreen <kbd class="svelte-60ik2m">?</kbd> help',L,A;function T(x,U){return x[2]?Ji:x[3]?Qi:Ki}let $=T(t),z=$(t);return{c(){e=_("div"),n=_("div"),n.innerHTML=i,s=R(),a=_("div"),r=_("button"),o=_("span"),l=R(),f=_("span"),z.c(),u=R(),d=_("button"),d.innerHTML=c,g=R(),b=_("button"),b.innerHTML=E,M=R(),D=_("button"),D.innerHTML=C,p=R(),S=_("div"),S.innerHTML=w,this.h()},l(x){e=y(x,"DIV",{class:!0});var U=I(e);n=y(U,"DIV",{class:!0,"data-svelte-h":!0}),ue(n)!=="svelte-i65zl2"&&(n.innerHTML=i),s=P(U),a=y(U,"DIV",{class:!0});var O=I(a);r=y(O,"BUTTON",{class:!0,title:!0});var Y=I(r);o=y(Y,"SPAN",{class:!0}),I(o).forEach(v),l=P(Y),f=y(Y,"SPAN",{class:!0});var W=I(f);z.l(W),W.forEach(v),Y.forEach(v),u=P(O),d=y(O,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),ue(d)!=="svelte-1xg66l0"&&(d.innerHTML=c),g=P(O),b=y(O,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),ue(b)!=="svelte-e1kxas"&&(b.innerHTML=E),M=P(O),D=y(O,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),ue(D)!=="svelte-c7hw7k"&&(D.innerHTML=C),O.forEach(v),p=P(U),S=y(U,"DIV",{class:!0,title:!0,"data-svelte-h":!0}),ue(S)!=="svelte-1ll3wf0"&&(S.innerHTML=w),U.forEach(v),this.h()},h(){m(n,"class","panel-header svelte-60ik2m"),m(o,"class","indicator svelte-60ik2m"),X(o,"on",t[3]),m(f,"class","label"),m(r,"class","ctrl-btn mic svelte-60ik2m"),r.disabled=t[2],m(r,"title","Enable microphone to let visuals react to music and sounds around you"),X(r,"active",t[3]),X(r,"loading",t[2]),m(d,"class","ctrl-btn svelte-60ik2m"),m(d,"title","Enter or exit fullscreen mode for an immersive experience"),X(d,"active",t[4].fullscreen),m(b,"class","ctrl-btn svelte-60ik2m"),m(b,"title","Reduce frame rate to save battery and CPU on laptops"),X(b,"active",t[4].powerSaverEnabled),m(D,"class","ctrl-btn svelte-60ik2m"),m(D,"title","Show help and information (press ?)"),m(a,"class","controls-grid svelte-60ik2m"),m(S,"class","panel-footer svelte-60ik2m"),m(S,"title","Keyboard shortcuts for quick access"),m(e,"class","panel controls-panel svelte-60ik2m")},m(x,U){V(x,e,U),h(e,n),h(e,s),h(e,a),h(a,r),h(r,o),h(r,l),h(r,f),z.m(f,null),h(a,u),h(a,d),h(a,g),h(a,b),h(a,M),h(a,D),h(e,p),h(e,S),L||(A=[Q(r,"click",t[5]),Q(d,"click",t[6]),Q(b,"click",yi),Q(D,"click",function(){ai(t[0])&&t[0].apply(this,arguments)})],L=!0)},p(x,U){t=x,U&8&&X(o,"on",t[3]),$!==($=T(t))&&(z.d(1),z=$(t),z&&(z.c(),z.m(f,null))),U&4&&(r.disabled=t[2]),U&8&&X(r,"active",t[3]),U&4&&X(r,"loading",t[2]),U&16&&X(d,"active",t[4].fullscreen),U&16&&X(b,"active",t[4].powerSaverEnabled)},d(x){x&&v(e),z.d(),L=!1,Ae(A)}}}function Ki(t){let e;return{c(){e=ee("MIC OFF")},l(n){e=J(n,"MIC OFF")},m(n,i){V(n,e,i)},d(n){n&&v(e)}}}function Qi(t){let e;return{c(){e=ee("MIC ON")},l(n){e=J(n,"MIC ON")},m(n,i){V(n,e,i)},d(n){n&&v(e)}}}function Ji(t){let e;return{c(){e=ee("...")},l(n){e=J(n,"...")},m(n,i){V(n,e,i)},d(n){n&&v(e)}}}function en(t){let e,n=t[1]&&Et(t);return{c(){n&&n.c(),e=pe()},l(i){n&&n.l(i),e=pe()},m(i,s){n&&n.m(i,s),V(i,e,s)},p(i,[s]){i[1]?n?n.p(i,s):(n=Et(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:ve,o:ve,d(i){i&&v(e),n&&n.d(i)}}}function tn(t,e,n){let i,s;ke(t,at,c=>n(3,i=c)),ke(t,me,c=>n(4,s=c));let{onEnableMic:a}=e,{onDisableMic:r}=e,{onShowInfo:o}=e,{visible:l=!0}=e,f=!1;async function u(){if(i){r();return}n(2,f=!0),await a(),n(2,f=!1)}async function d(){document.fullscreenElement?(await document.exitFullscreen(),me.update(c=>({...c,fullscreen:!1}))):(await document.documentElement.requestFullscreen(),me.update(c=>({...c,fullscreen:!0})))}return t.$$set=c=>{"onEnableMic"in c&&n(7,a=c.onEnableMic),"onDisableMic"in c&&n(8,r=c.onDisableMic),"onShowInfo"in c&&n(0,o=c.onShowInfo),"visible"in c&&n(1,l=c.visible)},[o,l,f,i,s,u,d,a,r]}class nn extends Ie{constructor(e){super(),Be(this,e,tn,en,Le,{onEnableMic:7,onDisableMic:8,onShowInfo:0,visible:1})}}function Mt(t,e,n){const i=t.slice();return i[19]=e[n].definition,i[20]=e[n].state,i}function St(t,e,n){const i=t.slice();return i[23]=e[n],i}function Lt(t){let e,n,i,s,a,r,o,l="LAYERS",f,u,d=t[1].filter(Rt).length+"",c,g,b=t[1].length+"",E,M,D,C="?",p,S,w,L,A="RANDOM",T,$,z="STROBE",x,U,O=[],Y=new Map,W,Z,H,k=t[3]&&It(t),q=Ye(t[1]);const te=F=>F[19].id;for(let F=0;F<q.length;F+=1){let N=Mt(t,q,F),ie=te(N);Y.set(ie,O[F]=Pt(ie,N))}return{c(){e=_("div"),n=_("div"),i=_("button"),s=_("span"),r=R(),o=_("span"),o.textContent=l,f=R(),u=_("span"),c=ee(d),g=ee("/"),E=ee(b),M=R(),D=_("button"),D.textContent=C,p=R(),k&&k.c(),S=R(),w=_("div"),L=_("button"),L.textContent=A,T=R(),$=_("button"),$.textContent=z,x=R(),U=_("div");for(let F=0;F<O.length;F+=1)O[F].c();this.h()},l(F){e=y(F,"DIV",{class:!0});var N=I(e);n=y(N,"DIV",{class:!0});var ie=I(n);i=y(ie,"BUTTON",{class:!0,title:!0,type:!0});var ye=I(i);s=y(ye,"SPAN",{class:!0}),I(s).forEach(v),ye.forEach(v),r=P(ie),o=y(ie,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),ue(o)!=="svelte-1k3t9ew"&&(o.textContent=l),f=P(ie),u=y(ie,"SPAN",{class:!0,title:!0});var fe=I(u);c=J(fe,d),g=J(fe,"/"),E=J(fe,b),fe.forEach(v),M=P(ie),D=y(ie,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),ue(D)!=="svelte-bv0qfb"&&(D.textContent=C),ie.forEach(v),p=P(N),k&&k.l(N),S=P(N),w=y(N,"DIV",{class:!0});var oe=I(w);L=y(oe,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),ue(L)!=="svelte-oljq6x"&&(L.textContent=A),T=P(oe),$=y(oe,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),ue($)!=="svelte-1j3wa1w"&&($.textContent=z),oe.forEach(v),x=P(N),U=y(N,"DIV",{class:!0});var qe=I(U);for(let De=0;De<O.length;De+=1)O[De].l(qe);qe.forEach(v),N.forEach(v),this.h()},h(){m(s,"class","master-indicator svelte-ncxsyn"),m(i,"class","master-toggle svelte-ncxsyn"),m(i,"title",a=t[4]?"Turn off all layers":"Turn on all layers"),m(i,"type","button"),X(i,"active",t[4]),m(o,"class","panel-title svelte-ncxsyn"),m(o,"title","Visual effect layers - toggle and customize each one"),m(u,"class","panel-count svelte-ncxsyn"),m(u,"title","Number of active layers"),m(D,"class","help-btn svelte-ncxsyn"),m(D,"title","What do these buttons mean?"),m(D,"type","button"),m(n,"class","panel-header svelte-ncxsyn"),m(L,"class","global-btn svelte-ncxsyn"),m(L,"title","Automatically change visual settings on every beat for variety"),m(L,"type","button"),X(L,"active",t[5].randomizerEnabled),m($,"class","global-btn strobe svelte-ncxsyn"),m($,"title","Flash layers on/off with the beat for a strobe-like effect"),m($,"type","button"),X($,"active",t[5].randomizerTogglesLayers),m(w,"class","global-controls svelte-ncxsyn"),m(U,"class","layer-list svelte-ncxsyn"),m(e,"class","panel layers-panel svelte-ncxsyn")},m(F,N){V(F,e,N),h(e,n),h(n,i),h(i,s),h(n,r),h(n,o),h(n,f),h(n,u),h(u,c),h(u,g),h(u,E),h(n,M),h(n,D),h(e,p),k&&k.m(e,null),h(e,S),h(e,w),h(w,L),h(w,T),h(w,$),h(e,x),h(e,U);for(let ie=0;ie<O.length;ie+=1)O[ie]&&O[ie].m(U,null);W=!0,Z||(H=[Q(i,"click",t[6]),Q(D,"click",t[10]),Q(L,"click",_i),Q($,"click",Ti)],Z=!0)},p(F,N){(!W||N&16&&a!==(a=F[4]?"Turn off all layers":"Turn on all layers"))&&m(i,"title",a),(!W||N&16)&&X(i,"active",F[4]),(!W||N&2)&&d!==(d=F[1].filter(Rt).length+"")&&he(c,d),(!W||N&2)&&b!==(b=F[1].length+"")&&he(E,b),F[3]?k?k.p(F,N):(k=It(F),k.c(),k.m(e,S)):k&&(k.d(1),k=null),(!W||N&32)&&X(L,"active",F[5].randomizerEnabled),(!W||N&32)&&X($,"active",F[5].randomizerTogglesLayers),N&422&&(q=Ye(F[1]),ze(),O=Zt(O,N,te,1,F,q,Y,U,jt,Pt,null,Mt),Pe())},i(F){if(!W){for(let N=0;N<q.length;N+=1)G(O[N]);W=!0}},o(F){for(let N=0;N<O.length;N+=1)j(O[N]);W=!1},d(F){F&&v(e),k&&k.d();for(let N=0;N<O.length;N+=1)O[N].d();Z=!1,Ae(H)}}}function It(t){let e,n,i,s="How It Works",a,r,o="",l,f,u='<div class="help-section svelte-ncxsyn"><div class="help-title svelte-ncxsyn">Layer Controls</div> <div class="help-item svelte-ncxsyn"><span class="help-icon dot green svelte-ncxsyn"></span> <span>Turn layer on/off</span></div> <div class="help-item svelte-ncxsyn"><span class="help-icon box svelte-ncxsyn">+</span> <span>Show more settings</span></div></div> <div class="help-section svelte-ncxsyn"><div class="help-title svelte-ncxsyn">Auto Effects</div> <div class="help-item svelte-ncxsyn"><span class="help-icon box purple svelte-ncxsyn">R</span> <span>Auto-change colors &amp; style on beat</span></div> <div class="help-item svelte-ncxsyn"><span class="help-icon box pink svelte-ncxsyn">S</span> <span>Flash on/off with music</span></div></div> <div class="help-section svelte-ncxsyn"><div class="help-title svelte-ncxsyn">Master Switches</div> <div class="help-item svelte-ncxsyn"><span class="help-badge svelte-ncxsyn">RANDOM</span> <span>Enable/disable all R buttons</span></div> <div class="help-item svelte-ncxsyn"><span class="help-badge pink svelte-ncxsyn">STROBE</span> <span>Enable/disable all S buttons</span></div></div> <div class="help-tip svelte-ncxsyn">Dashed border = ready when master is ON</div>',d,c;return{c(){e=_("div"),n=_("div"),i=_("span"),i.textContent=s,a=R(),r=_("button"),r.textContent=o,l=R(),f=_("div"),f.innerHTML=u,this.h()},l(g){e=y(g,"DIV",{class:!0});var b=I(e);n=y(b,"DIV",{class:!0});var E=I(n);i=y(E,"SPAN",{"data-svelte-h":!0}),ue(i)!=="svelte-72lls3"&&(i.textContent=s),a=P(E),r=y(E,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),ue(r)!=="svelte-1eac6wf"&&(r.textContent=o),E.forEach(v),l=P(b),f=y(b,"DIV",{class:!0,"data-svelte-h":!0}),ue(f)!=="svelte-37j6hi"&&(f.innerHTML=u),b.forEach(v),this.h()},h(){m(r,"class","help-close svelte-ncxsyn"),m(r,"type","button"),m(n,"class","help-header svelte-ncxsyn"),m(f,"class","help-content svelte-ncxsyn"),m(e,"class","help-popup svelte-ncxsyn")},m(g,b){V(g,e,b),h(e,n),h(n,i),h(n,a),h(n,r),h(e,l),h(e,f),d||(c=Q(r,"click",t[11]),d=!0)},p:ve,d(g){g&&v(e),d=!1,c()}}}function Bt(t){let e,n,i,s,a,r,o,l,f;function u(){return t[14](t[19])}function d(){return t[15](t[19])}return{c(){e=_("button"),n=ee("R"),s=R(),a=_("button"),r=ee("S"),this.h()},l(c){e=y(c,"BUTTON",{class:!0,title:!0,type:!0});var g=I(e);n=J(g,"R"),g.forEach(v),s=P(c),a=y(c,"BUTTON",{class:!0,title:!0,type:!0});var b=I(a);r=J(b,"S"),b.forEach(v),this.h()},h(){m(e,"class","quick-btn random-btn svelte-ncxsyn"),m(e,"title",i=t[20].includeInRandomizer?t[5].randomizerEnabled?"Included in randomizer - click to exclude":"Will be included when global RANDOM is enabled":"Include in randomizer - properties will change automatically"),m(e,"type","button"),X(e,"active",t[20].includeInRandomizer&&t[5].randomizerEnabled),X(e,"pending",t[20].includeInRandomizer&&!t[5].randomizerEnabled),m(a,"class","quick-btn strobe-btn svelte-ncxsyn"),m(a,"title",o=t[20].includeInStrobe?t[5].randomizerTogglesLayers?"Included in strobe - click to exclude":"Will be included when global STROBE is enabled":"Include in strobe - layer can flash on/off with the beat"),m(a,"type","button"),X(a,"active",t[20].includeInStrobe&&t[5].randomizerTogglesLayers),X(a,"pending",t[20].includeInStrobe&&!t[5].randomizerTogglesLayers)},m(c,g){V(c,e,g),h(e,n),V(c,s,g),V(c,a,g),h(a,r),l||(f=[Q(e,"click",u),Q(a,"click",d)],l=!0)},p(c,g){t=c,g&34&&i!==(i=t[20].includeInRandomizer?t[5].randomizerEnabled?"Included in randomizer - click to exclude":"Will be included when global RANDOM is enabled":"Include in randomizer - properties will change automatically")&&m(e,"title",i),g&34&&X(e,"active",t[20].includeInRandomizer&&t[5].randomizerEnabled),g&34&&X(e,"pending",t[20].includeInRandomizer&&!t[5].randomizerEnabled),g&34&&o!==(o=t[20].includeInStrobe?t[5].randomizerTogglesLayers?"Included in strobe - click to exclude":"Will be included when global STROBE is enabled":"Include in strobe - layer can flash on/off with the beat")&&m(a,"title",o),g&34&&X(a,"active",t[20].includeInStrobe&&t[5].randomizerTogglesLayers),g&34&&X(a,"pending",t[20].includeInStrobe&&!t[5].randomizerTogglesLayers)},d(c){c&&(v(e),v(s),v(a)),l=!1,Ae(f)}}}function Dt(t){let e,n=[],i=new Map,s,a=Ye(t[19].properties);const r=o=>o[23].id;for(let o=0;o<a.length;o+=1){let l=St(t,a,o),f=r(l);i.set(f,n[o]=zt(f,l))}return{c(){e=_("div");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=y(o,"DIV",{class:!0});var l=I(e);for(let f=0;f<n.length;f+=1)n[f].l(l);l.forEach(v),this.h()},h(){m(e,"class","layer-controls svelte-ncxsyn")},m(o,l){V(o,e,l);for(let f=0;f<n.length;f+=1)n[f]&&n[f].m(e,null);s=!0},p(o,l){l&130&&(a=Ye(o[19].properties),ze(),n=Zt(n,l,r,1,o,a,i,e,jt,zt,null,St),Pe())},i(o){if(!s){for(let l=0;l<a.length;l+=1)G(n[l]);s=!0}},o(o){for(let l=0;l<n.length;l+=1)j(n[l]);s=!1},d(o){o&&v(e);for(let l=0;l<n.length;l+=1)n[l].d()}}}function an(t){let e,n,i,s;function a(...r){return t[18](t[19],t[23],...r)}return n=new ti({props:{label:"Thm",value:t[20].properties[t[23].id]??t[23].default,options:t[7]}}),n.$on("change",a),{c(){e=_("div"),le(n.$$.fragment),i=R(),this.h()},l(r){e=y(r,"DIV",{title:!0});var o=I(e);se(n.$$.fragment,o),i=P(o),o.forEach(v),this.h()},h(){m(e,"title","Color scheme for this visual effect")},m(r,o){V(r,e,o),ae(n,e,null),h(e,i),s=!0},p(r,o){t=r;const l={};o&2&&(l.value=t[20].properties[t[23].id]??t[23].default),n.$set(l)},i(r){s||(G(n.$$.fragment,r),s=!0)},o(r){j(n.$$.fragment,r),s=!1},d(r){r&&v(e),ne(n)}}}function sn(t){let e,n,i,s,a;function r(...o){return t[17](t[19],t[23],...o)}return n=new Me({props:{label:t[23].label.slice(0,4),value:t[20].properties[t[23].id]??t[23].default,min:t[23].min??0,max:t[23].max??1,step:t[23].step??.01}}),n.$on("input",r),{c(){e=_("div"),le(n.$$.fragment),i=R(),this.h()},l(o){e=y(o,"DIV",{title:!0});var l=I(e);se(n.$$.fragment,l),i=P(l),l.forEach(v),this.h()},h(){m(e,"title",s=t[23].id==="intensity"?"How visible/strong this effect is":t[23].id==="zoom"?"Scale/size of the effect pattern":t[23].id==="sensitivity"?"How much this layer reacts to audio":t[23].label)},m(o,l){V(o,e,l),ae(n,e,null),h(e,i),a=!0},p(o,l){t=o;const f={};l&2&&(f.label=t[23].label.slice(0,4)),l&2&&(f.value=t[20].properties[t[23].id]??t[23].default),l&2&&(f.min=t[23].min??0),l&2&&(f.max=t[23].max??1),l&2&&(f.step=t[23].step??.01),n.$set(f),(!a||l&2&&s!==(s=t[23].id==="intensity"?"How visible/strong this effect is":t[23].id==="zoom"?"Scale/size of the effect pattern":t[23].id==="sensitivity"?"How much this layer reacts to audio":t[23].label))&&m(e,"title",s)},i(o){a||(G(n.$$.fragment,o),a=!0)},o(o){j(n.$$.fragment,o),a=!1},d(o){o&&v(e),ne(n)}}}function zt(t,e){let n,i,s,a,r;const o=[sn,an],l=[];function f(u,d){return u[23].type==="range"?0:u[23].type==="select"&&u[23].id==="theme"?1:-1}return~(i=f(e))&&(s=l[i]=o[i](e)),{key:t,first:null,c(){n=pe(),s&&s.c(),a=pe(),this.h()},l(u){n=pe(),s&&s.l(u),a=pe(),this.h()},h(){this.first=n},m(u,d){V(u,n,d),~i&&l[i].m(u,d),V(u,a,d),r=!0},p(u,d){e=u;let c=i;i=f(e),i===c?~i&&l[i].p(e,d):(s&&(ze(),j(l[c],1,1,()=>{l[c]=null}),Pe()),~i?(s=l[i],s?s.p(e,d):(s=l[i]=o[i](e),s.c()),G(s,1),s.m(a.parentNode,a)):s=null)},i(u){r||(G(s),r=!0)},o(u){j(s),r=!1},d(u){u&&(v(n),v(a)),~i&&l[i].d(u)}}}function Pt(t,e){let n,i,s,a,r,o,l=e[19].label+"",f,u,d,c,g,b,E=e[2]===e[19].id?"":"+",M,D,C,p,S,w;function L(){return e[12](e[19])}function A(){return e[13](e[19])}let T=e[19].randomizable!==!1&&Bt(e);function $(){return e[16](e[19])}let z=e[2]===e[19].id&&Dt(e);return{key:t,first:null,c(){n=_("div"),i=_("div"),s=_("button"),a=_("span"),r=R(),o=_("button"),f=ee(l),d=R(),c=_("div"),T&&T.c(),g=R(),b=_("button"),M=ee(E),D=R(),z&&z.c(),C=R(),this.h()},l(x){n=y(x,"DIV",{class:!0});var U=I(n);i=y(U,"DIV",{class:!0});var O=I(i);s=y(O,"BUTTON",{class:!0,type:!0,title:!0});var Y=I(s);a=y(Y,"SPAN",{class:!0}),I(a).forEach(v),Y.forEach(v),r=P(O),o=y(O,"BUTTON",{class:!0,type:!0,title:!0});var W=I(o);f=J(W,l),W.forEach(v),d=P(O),c=y(O,"DIV",{class:!0});var Z=I(c);T&&T.l(Z),g=P(Z),b=y(Z,"BUTTON",{class:!0,type:!0,title:!0});var H=I(b);M=J(H,E),H.forEach(v),Z.forEach(v),O.forEach(v),D=P(U),z&&z.l(U),C=P(U),U.forEach(v),this.h()},h(){m(a,"class","indicator svelte-ncxsyn"),X(a,"active",e[20].enabled),m(s,"class","layer-toggle svelte-ncxsyn"),m(s,"type","button"),m(s,"title","Turn this visual effect on or off"),m(o,"class","layer-name svelte-ncxsyn"),m(o,"type","button"),m(o,"title",u=e[19].description+" - click to adjust settings"),m(b,"class","quick-btn expand-btn svelte-ncxsyn"),m(b,"type","button"),m(b,"title","Expand to see detailed controls for this layer"),m(c,"class","layer-quick svelte-ncxsyn"),m(i,"class","layer-row svelte-ncxsyn"),m(n,"class","layer-item svelte-ncxsyn"),X(n,"disabled",!e[20].enabled),X(n,"expanded",e[2]===e[19].id),this.first=n},m(x,U){V(x,n,U),h(n,i),h(i,s),h(s,a),h(i,r),h(i,o),h(o,f),h(i,d),h(i,c),T&&T.m(c,null),h(c,g),h(c,b),h(b,M),h(n,D),z&&z.m(n,null),h(n,C),p=!0,S||(w=[Q(s,"click",L),Q(o,"click",A),Q(b,"click",$)],S=!0)},p(x,U){e=x,(!p||U&2)&&X(a,"active",e[20].enabled),(!p||U&2)&&l!==(l=e[19].label+"")&&he(f,l),(!p||U&2&&u!==(u=e[19].description+" - click to adjust settings"))&&m(o,"title",u),e[19].randomizable!==!1?T?T.p(e,U):(T=Bt(e),T.c(),T.m(c,g)):T&&(T.d(1),T=null),(!p||U&6)&&E!==(E=e[2]===e[19].id?"":"+")&&he(M,E),e[2]===e[19].id?z?(z.p(e,U),U&6&&G(z,1)):(z=Dt(e),z.c(),G(z,1),z.m(n,C)):z&&(ze(),j(z,1,1,()=>{z=null}),Pe()),(!p||U&2)&&X(n,"disabled",!e[20].enabled),(!p||U&6)&&X(n,"expanded",e[2]===e[19].id)},i(x){p||(G(z),p=!0)},o(x){j(z),p=!1},d(x){x&&v(n),T&&T.d(),z&&z.d(),S=!1,Ae(w)}}}function ln(t){let e,n,i=t[0]&&Lt(t);return{c(){i&&i.c(),e=pe()},l(s){i&&i.l(s),e=pe()},m(s,a){i&&i.m(s,a),V(s,e,a),n=!0},p(s,[a]){s[0]?i?(i.p(s,a),a&1&&G(i,1)):(i=Lt(s),i.c(),G(i,1),i.m(e.parentNode,e)):i&&(ze(),j(i,1,1,()=>{i=null}),Pe())},i(s){n||(G(i),n=!0)},o(s){j(i),n=!1},d(s){s&&v(e),i&&i.d(s)}}}const Rt=t=>t.state.enabled;function rn(t,e,n){let i,s,a,r;ke(t,Ce,L=>n(9,a=L)),ke(t,me,L=>n(5,r=L));let{visible:o=!0}=e,l=null,f=!1;function u(){pi(!s)}const d=ot.map(L=>({value:L.id,label:L.label,preview:L.preview}));function c(L){n(2,l=l===L?null:L)}const g=()=>n(3,f=!f),b=()=>n(3,f=!1),E=L=>ci(L.id),M=L=>c(L.id),D=L=>mi(L.id),C=L=>hi(L.id),p=L=>c(L.id),S=(L,A,T)=>pt(L.id,A.id,T.detail),w=(L,A,T)=>pt(L.id,A.id,T.detail);return t.$$set=L=>{"visible"in L&&n(0,o=L.visible)},t.$$.update=()=>{t.$$.dirty&512&&n(1,i=He.map(L=>({definition:L,state:a.get(L.id)})).filter(L=>L.state)),t.$$.dirty&2&&n(4,s=i.some(L=>L.state.enabled))},[o,i,l,f,s,r,u,d,c,a,g,b,E,M,D,C,p,S,w]}class on extends Ie{constructor(e){super(),Be(this,e,rn,ln,Le,{visible:0})}}function Ct(t){let e,n,i='<span class="panel-title svelte-9wroah">LEVELS</span>',s,a,r,o,l,f,u,d,c,g,b,E,M,D,C,p,S,w,L,A;return o=new je({props:{label:"HI",value:t[1].raw.highs}}),u=new je({props:{label:"MD",value:t[1].raw.mids}}),g=new je({props:{label:"LO",value:t[1].raw.lows}}),M=new je({props:{label:"TR",value:t[1].raw.treble}}),p=new je({props:{label:"BS",value:t[1].raw.bass}}),L=new je({props:{label:"BT",value:t[1].raw.beat}}),{c(){e=_("div"),n=_("div"),n.innerHTML=i,s=R(),a=_("div"),r=_("div"),le(o.$$.fragment),l=R(),f=_("div"),le(u.$$.fragment),d=R(),c=_("div"),le(g.$$.fragment),b=R(),E=_("div"),le(M.$$.fragment),D=R(),C=_("div"),le(p.$$.fragment),S=R(),w=_("div"),le(L.$$.fragment),this.h()},l(T){e=y(T,"DIV",{class:!0});var $=I(e);n=y($,"DIV",{class:!0,title:!0,"data-svelte-h":!0}),ue(n)!=="svelte-1qdq6z0"&&(n.innerHTML=i),s=P($),a=y($,"DIV",{class:!0});var z=I(a);r=y(z,"DIV",{title:!0});var x=I(r);se(o.$$.fragment,x),x.forEach(v),l=P(z),f=y(z,"DIV",{title:!0});var U=I(f);se(u.$$.fragment,U),U.forEach(v),d=P(z),c=y(z,"DIV",{title:!0});var O=I(c);se(g.$$.fragment,O),O.forEach(v),b=P(z),E=y(z,"DIV",{title:!0});var Y=I(E);se(M.$$.fragment,Y),Y.forEach(v),D=P(z),C=y(z,"DIV",{title:!0});var W=I(C);se(p.$$.fragment,W),W.forEach(v),S=P(z),w=y(z,"DIV",{title:!0});var Z=I(w);se(L.$$.fragment,Z),Z.forEach(v),z.forEach(v),$.forEach(v),this.h()},h(){m(n,"class","panel-header svelte-9wroah"),m(n,"title","Real-time audio levels from your microphone"),m(r,"title","High frequencies - cymbals, hi-hats, bright sounds"),m(f,"title","Mid frequencies - vocals, guitars, main melody"),m(c,"title","Low frequencies - bass, kick drum, rumble"),m(E,"title","Treble - combined high-pitched sounds"),m(C,"title","Bass - combined low-pitched sounds"),m(w,"title","Beat detection - pulses when drums or strong beats hit"),m(a,"class","levels-grid svelte-9wroah"),m(e,"class","panel levels-panel svelte-9wroah")},m(T,$){V(T,e,$),h(e,n),h(e,s),h(e,a),h(a,r),ae(o,r,null),h(a,l),h(a,f),ae(u,f,null),h(a,d),h(a,c),ae(g,c,null),h(a,b),h(a,E),ae(M,E,null),h(a,D),h(a,C),ae(p,C,null),h(a,S),h(a,w),ae(L,w,null),A=!0},p(T,$){const z={};$&2&&(z.value=T[1].raw.highs),o.$set(z);const x={};$&2&&(x.value=T[1].raw.mids),u.$set(x);const U={};$&2&&(U.value=T[1].raw.lows),g.$set(U);const O={};$&2&&(O.value=T[1].raw.treble),M.$set(O);const Y={};$&2&&(Y.value=T[1].raw.bass),p.$set(Y);const W={};$&2&&(W.value=T[1].raw.beat),L.$set(W)},i(T){A||(G(o.$$.fragment,T),G(u.$$.fragment,T),G(g.$$.fragment,T),G(M.$$.fragment,T),G(p.$$.fragment,T),G(L.$$.fragment,T),A=!0)},o(T){j(o.$$.fragment,T),j(u.$$.fragment,T),j(g.$$.fragment,T),j(M.$$.fragment,T),j(p.$$.fragment,T),j(L.$$.fragment,T),A=!1},d(T){T&&v(e),ne(o),ne(u),ne(g),ne(M),ne(p),ne(L)}}}function un(t){let e,n,i=t[0]&&Ct(t);return{c(){i&&i.c(),e=pe()},l(s){i&&i.l(s),e=pe()},m(s,a){i&&i.m(s,a),V(s,e,a),n=!0},p(s,[a]){s[0]?i?(i.p(s,a),a&1&&G(i,1)):(i=Ct(s),i.c(),G(i,1),i.m(e.parentNode,e)):i&&(ze(),j(i,1,1,()=>{i=null}),Pe())},i(s){n||(G(i),n=!0)},o(s){j(i),n=!1},d(s){s&&v(e),i&&i.d(s)}}}function fn(t,e,n){let i;ke(t,rt,a=>n(1,i=a));let{visible:s=!0}=e;return t.$$set=a=>{"visible"in a&&n(0,s=a.visible)},[s,i]}class dn extends Ie{constructor(e){super(),Be(this,e,fn,un,Le,{visible:0})}}function At(t){let e,n,i,s="TUNING",a,r,o=t[1]?"":"+",l,f,u,d,c,g,b,E,M,D,C,p,S,w,L,A,T,$;function z(H){t[5](H)}let x={label:"Sens",min:0,max:2,formatValue:t[3]};t[2].sensitivity!==void 0&&(x.value=t[2].sensitivity),c=new Me({props:x}),be.push(()=>Te(c,"value",z));function U(H){t[6](H)}let O={label:"Beat",min:0,max:2,formatValue:t[3]};t[2].beatBoost!==void 0&&(O.value=t[2].beatBoost),M=new Me({props:O}),be.push(()=>Te(M,"value",U));function Y(H){t[7](H)}let W={label:"Gate",min:0,max:1,formatValue:t[3]};t[2].beatGate!==void 0&&(W.value=t[2].beatGate),S=new Me({props:W}),be.push(()=>Te(S,"value",Y));let Z=t[1]&&Ft(t);return{c(){e=_("div"),n=_("div"),i=_("span"),i.textContent=s,a=R(),r=_("button"),l=ee(o),f=R(),u=_("div"),d=_("div"),le(c.$$.fragment),b=R(),E=_("div"),le(M.$$.fragment),C=R(),p=_("div"),le(S.$$.fragment),L=R(),Z&&Z.c(),this.h()},l(H){e=y(H,"DIV",{class:!0});var k=I(e);n=y(k,"DIV",{class:!0});var q=I(n);i=y(q,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),ue(i)!=="svelte-hff578"&&(i.textContent=s),a=P(q),r=y(q,"BUTTON",{class:!0,title:!0});var te=I(r);l=J(te,o),te.forEach(v),q.forEach(v),f=P(k),u=y(k,"DIV",{class:!0});var F=I(u);d=y(F,"DIV",{title:!0});var N=I(d);se(c.$$.fragment,N),N.forEach(v),b=P(F),E=y(F,"DIV",{title:!0});var ie=I(E);se(M.$$.fragment,ie),ie.forEach(v),C=P(F),p=y(F,"DIV",{title:!0});var ye=I(p);se(S.$$.fragment,ye),ye.forEach(v),L=P(F),Z&&Z.l(F),F.forEach(v),k.forEach(v),this.h()},h(){m(i,"class","panel-title svelte-1rkomi4"),m(i,"title","Adjust how visuals respond to audio"),m(r,"class","toggle-advanced svelte-1rkomi4"),m(r,"title","Show more advanced audio controls"),m(n,"class","panel-header svelte-1rkomi4"),m(d,"title","Overall sensitivity - how much visuals react to sound"),m(E,"title","Beat boost - make beat reactions stronger or weaker"),m(p,"title","Beat gate - ignore quiet sounds, only react to loud beats"),m(u,"class","tuning-grid svelte-1rkomi4"),m(e,"class","panel tuning-panel svelte-1rkomi4")},m(H,k){V(H,e,k),h(e,n),h(n,i),h(n,a),h(n,r),h(r,l),h(e,f),h(e,u),h(u,d),ae(c,d,null),h(u,b),h(u,E),ae(M,E,null),h(u,C),h(u,p),ae(S,p,null),h(u,L),Z&&Z.m(u,null),A=!0,T||($=Q(r,"click",t[4]),T=!0)},p(H,k){(!A||k&2)&&o!==(o=H[1]?"":"+")&&he(l,o);const q={};!g&&k&4&&(g=!0,q.value=H[2].sensitivity,_e(()=>g=!1)),c.$set(q);const te={};!D&&k&4&&(D=!0,te.value=H[2].beatBoost,_e(()=>D=!1)),M.$set(te);const F={};!w&&k&4&&(w=!0,F.value=H[2].beatGate,_e(()=>w=!1)),S.$set(F),H[1]?Z?(Z.p(H,k),k&2&&G(Z,1)):(Z=Ft(H),Z.c(),G(Z,1),Z.m(u,null)):Z&&(ze(),j(Z,1,1,()=>{Z=null}),Pe())},i(H){A||(G(c.$$.fragment,H),G(M.$$.fragment,H),G(S.$$.fragment,H),G(Z),A=!0)},o(H){j(c.$$.fragment,H),j(M.$$.fragment,H),j(S.$$.fragment,H),j(Z),A=!1},d(H){H&&v(e),ne(c),ne(M),ne(S),Z&&Z.d(),T=!1,$()}}}function Ft(t){let e,n,i,s,a,r,o,l,f,u,d,c,g,b,E,M,D,C,p,S,w,L,A,T,$,z,x,U,O,Y,W,Z,H,k;function q(B){t[8](B)}let te={label:"Hi+",min:0,max:2,formatValue:t[3]};t[2].highsBoost!==void 0&&(te.value=t[2].highsBoost),s=new Me({props:te}),be.push(()=>Te(s,"value",q));function F(B){t[9](B)}let N={label:"Mid+",min:0,max:2,formatValue:t[3]};t[2].midsBoost!==void 0&&(N.value=t[2].midsBoost),l=new Me({props:N}),be.push(()=>Te(l,"value",F));function ie(B){t[10](B)}let ye={label:"Low+",min:0,max:2,formatValue:t[3]};t[2].lowsBoost!==void 0&&(ye.value=t[2].lowsBoost),c=new Me({props:ye}),be.push(()=>Te(c,"value",ie));function fe(B){t[11](B)}let oe={label:"Trbl",min:0,max:2,formatValue:t[3]};t[2].trebleBoost!==void 0&&(oe.value=t[2].trebleBoost),M=new Me({props:oe}),be.push(()=>Te(M,"value",fe));function qe(B){t[12](B)}let De={label:"Bass",min:0,max:2,formatValue:t[3]};t[2].bassBoost!==void 0&&(De.value=t[2].bassBoost),S=new Me({props:De}),be.push(()=>Te(S,"value",qe));function we(B){t[13](B)}let re={label:"Min",min:0,max:.1,step:.005,formatValue:t[3]};t[2].minMotion!==void 0&&(re.value=t[2].minMotion),T=new Me({props:re}),be.push(()=>Te(T,"value",we));function de(B){t[14](B)}let Ge={label:"Auto Suggest"};t[2].autoEnabled!==void 0&&(Ge.checked=t[2].autoEnabled),Y=new ei({props:Ge}),be.push(()=>Te(Y,"checked",de));let ce=t[2].autoEnabled&&Ut(t);return{c(){e=_("div"),n=R(),i=_("div"),le(s.$$.fragment),r=R(),o=_("div"),le(l.$$.fragment),u=R(),d=_("div"),le(c.$$.fragment),b=R(),E=_("div"),le(M.$$.fragment),C=R(),p=_("div"),le(S.$$.fragment),L=R(),A=_("div"),le(T.$$.fragment),z=R(),x=_("div"),U=R(),O=_("div"),le(Y.$$.fragment),Z=R(),ce&&ce.c(),H=pe(),this.h()},l(B){e=y(B,"DIV",{class:!0}),I(e).forEach(v),n=P(B),i=y(B,"DIV",{title:!0});var K=I(i);se(s.$$.fragment,K),K.forEach(v),r=P(B),o=y(B,"DIV",{title:!0});var Ue=I(o);se(l.$$.fragment,Ue),Ue.forEach(v),u=P(B),d=y(B,"DIV",{title:!0});var Re=I(d);se(c.$$.fragment,Re),Re.forEach(v),b=P(B),E=y(B,"DIV",{title:!0});var Se=I(E);se(M.$$.fragment,Se),Se.forEach(v),C=P(B),p=y(B,"DIV",{title:!0});var Ve=I(p);se(S.$$.fragment,Ve),Ve.forEach(v),L=P(B),A=y(B,"DIV",{title:!0});var Ne=I(A);se(T.$$.fragment,Ne),Ne.forEach(v),z=P(B),x=y(B,"DIV",{class:!0}),I(x).forEach(v),U=P(B),O=y(B,"DIV",{title:!0});var Oe=I(O);se(Y.$$.fragment,Oe),Oe.forEach(v),Z=P(B),ce&&ce.l(B),H=pe(),this.h()},h(){m(e,"class","divider svelte-1rkomi4"),m(i,"title","Boost high frequency response (cymbals, hi-hats)"),m(o,"title","Boost mid frequency response (vocals, guitars)"),m(d,"title","Boost low frequency response (bass, kick drums)"),m(E,"title","Boost treble (bright, high-pitched sounds)"),m(p,"title","Boost bass (deep, low-pitched sounds)"),m(A,"title","Minimum motion - keep some movement even in silence"),m(x,"class","divider svelte-1rkomi4"),m(O,"title","Automatically adjust settings based on audio levels")},m(B,K){V(B,e,K),V(B,n,K),V(B,i,K),ae(s,i,null),V(B,r,K),V(B,o,K),ae(l,o,null),V(B,u,K),V(B,d,K),ae(c,d,null),V(B,b,K),V(B,E,K),ae(M,E,null),V(B,C,K),V(B,p,K),ae(S,p,null),V(B,L,K),V(B,A,K),ae(T,A,null),V(B,z,K),V(B,x,K),V(B,U,K),V(B,O,K),ae(Y,O,null),V(B,Z,K),ce&&ce.m(B,K),V(B,H,K),k=!0},p(B,K){const Ue={};!a&&K&4&&(a=!0,Ue.value=B[2].highsBoost,_e(()=>a=!1)),s.$set(Ue);const Re={};!f&&K&4&&(f=!0,Re.value=B[2].midsBoost,_e(()=>f=!1)),l.$set(Re);const Se={};!g&&K&4&&(g=!0,Se.value=B[2].lowsBoost,_e(()=>g=!1)),c.$set(Se);const Ve={};!D&&K&4&&(D=!0,Ve.value=B[2].trebleBoost,_e(()=>D=!1)),M.$set(Ve);const Ne={};!w&&K&4&&(w=!0,Ne.value=B[2].bassBoost,_e(()=>w=!1)),S.$set(Ne);const Oe={};!$&&K&4&&($=!0,Oe.value=B[2].minMotion,_e(()=>$=!1)),T.$set(Oe);const ut={};!W&&K&4&&(W=!0,ut.checked=B[2].autoEnabled,_e(()=>W=!1)),Y.$set(ut),B[2].autoEnabled?ce?(ce.p(B,K),K&4&&G(ce,1)):(ce=Ut(B),ce.c(),G(ce,1),ce.m(H.parentNode,H)):ce&&(ze(),j(ce,1,1,()=>{ce=null}),Pe())},i(B){k||(G(s.$$.fragment,B),G(l.$$.fragment,B),G(c.$$.fragment,B),G(M.$$.fragment,B),G(S.$$.fragment,B),G(T.$$.fragment,B),G(Y.$$.fragment,B),G(ce),k=!0)},o(B){j(s.$$.fragment,B),j(l.$$.fragment,B),j(c.$$.fragment,B),j(M.$$.fragment,B),j(S.$$.fragment,B),j(T.$$.fragment,B),j(Y.$$.fragment,B),j(ce),k=!1},d(B){B&&(v(e),v(n),v(i),v(r),v(o),v(u),v(d),v(b),v(E),v(C),v(p),v(L),v(A),v(z),v(x),v(U),v(O),v(Z),v(H)),ne(s),ne(l),ne(c),ne(M),ne(S),ne(T),ne(Y),ce&&ce.d(B)}}}function Ut(t){let e,n,i,s,a,r,o,l,f,u,d,c;function g(p){t[15](p)}let b={label:"Str",min:0,max:1,formatValue:t[3]};t[2].autoStrength!==void 0&&(b.value=t[2].autoStrength),n=new Me({props:b}),be.push(()=>Te(n,"value",g));function E(p){t[16](p)}let M={label:"Dec",min:0,max:1,formatValue:t[3]};t[2].autoDecay!==void 0&&(M.value=t[2].autoDecay),r=new Me({props:M}),be.push(()=>Te(r,"value",E));function D(p){t[17](p)}let C={label:"Tgt",options:[{value:"all",label:"All"},{value:"energy",label:"Energy"},{value:"treble",label:"Treble"},{value:"beat",label:"Beat"}]};return t[2].autoTarget!==void 0&&(C.value=t[2].autoTarget),u=new ti({props:C}),be.push(()=>Te(u,"value",D)),{c(){e=_("div"),le(n.$$.fragment),s=R(),a=_("div"),le(r.$$.fragment),l=R(),f=_("div"),le(u.$$.fragment),this.h()},l(p){e=y(p,"DIV",{title:!0});var S=I(e);se(n.$$.fragment,S),S.forEach(v),s=P(p),a=y(p,"DIV",{title:!0});var w=I(a);se(r.$$.fragment,w),w.forEach(v),l=P(p),f=y(p,"DIV",{title:!0});var L=I(f);se(u.$$.fragment,L),L.forEach(v),this.h()},h(){m(e,"title","How strongly auto-adjust affects the visuals"),m(a,"title","How quickly auto-adjustments fade back to normal"),m(f,"title","Which audio metric to use for auto-adjustment")},m(p,S){V(p,e,S),ae(n,e,null),V(p,s,S),V(p,a,S),ae(r,a,null),V(p,l,S),V(p,f,S),ae(u,f,null),c=!0},p(p,S){const w={};!i&&S&4&&(i=!0,w.value=p[2].autoStrength,_e(()=>i=!1)),n.$set(w);const L={};!o&&S&4&&(o=!0,L.value=p[2].autoDecay,_e(()=>o=!1)),r.$set(L);const A={};!d&&S&4&&(d=!0,A.value=p[2].autoTarget,_e(()=>d=!1)),u.$set(A)},i(p){c||(G(n.$$.fragment,p),G(r.$$.fragment,p),G(u.$$.fragment,p),c=!0)},o(p){j(n.$$.fragment,p),j(r.$$.fragment,p),j(u.$$.fragment,p),c=!1},d(p){p&&(v(e),v(s),v(a),v(l),v(f)),ne(n),ne(r),ne(u)}}}function cn(t){let e,n,i=t[0]&&At(t);return{c(){i&&i.c(),e=pe()},l(s){i&&i.l(s),e=pe()},m(s,a){i&&i.m(s,a),V(s,e,a),n=!0},p(s,[a]){s[0]?i?(i.p(s,a),a&1&&G(i,1)):(i=At(s),i.c(),G(i,1),i.m(e.parentNode,e)):i&&(ze(),j(i,1,1,()=>{i=null}),Pe())},i(s){n||(G(i),n=!0)},o(s){j(i),n=!1},d(s){s&&v(e),i&&i.d(s)}}}function mn(t,e,n){let i;ke(t,ge,w=>n(2,i=w));let{visible:s=!0}=e,a=!1;const r=w=>`${Math.round(w*100)}%`,o=()=>n(1,a=!a);function l(w){t.$$.not_equal(i.sensitivity,w)&&(i.sensitivity=w,ge.set(i))}function f(w){t.$$.not_equal(i.beatBoost,w)&&(i.beatBoost=w,ge.set(i))}function u(w){t.$$.not_equal(i.beatGate,w)&&(i.beatGate=w,ge.set(i))}function d(w){t.$$.not_equal(i.highsBoost,w)&&(i.highsBoost=w,ge.set(i))}function c(w){t.$$.not_equal(i.midsBoost,w)&&(i.midsBoost=w,ge.set(i))}function g(w){t.$$.not_equal(i.lowsBoost,w)&&(i.lowsBoost=w,ge.set(i))}function b(w){t.$$.not_equal(i.trebleBoost,w)&&(i.trebleBoost=w,ge.set(i))}function E(w){t.$$.not_equal(i.bassBoost,w)&&(i.bassBoost=w,ge.set(i))}function M(w){t.$$.not_equal(i.minMotion,w)&&(i.minMotion=w,ge.set(i))}function D(w){t.$$.not_equal(i.autoEnabled,w)&&(i.autoEnabled=w,ge.set(i))}function C(w){t.$$.not_equal(i.autoStrength,w)&&(i.autoStrength=w,ge.set(i))}function p(w){t.$$.not_equal(i.autoDecay,w)&&(i.autoDecay=w,ge.set(i))}function S(w){t.$$.not_equal(i.autoTarget,w)&&(i.autoTarget=w,ge.set(i))}return t.$$set=w=>{"visible"in w&&n(0,s=w.visible)},[s,a,i,r,o,l,f,u,d,c,g,b,E,M,D,C,p,S]}class hn extends Ie{constructor(e){super(),Be(this,e,mn,cn,Le,{visible:0})}}function Vt(t){let e,n,i,s="PERFORMANCE",a,r,o=t[4]?"":"+",l,f,u,d,c,g="FPS",b,E,M=t[2].fps+"",D,C,p,S,w,L,A,T,$="Frame",z,x,U=t[2].frameTime.toFixed(1)+"",O,Y,W,Z="ms",H,k,q,te,F,N,ie,ye,fe=t[7]&&t[5]>0&&Nt(t),oe=t[4]&&Ot(t);function qe(re,de){return re[7]?vn:pn}let De=qe(t),we=De(t);return{c(){e=_("div"),n=_("div"),i=_("span"),i.textContent=s,a=R(),r=_("button"),l=ee(o),f=R(),u=_("div"),d=_("div"),c=_("span"),c.textContent=g,b=R(),E=_("span"),D=ee(M),C=R(),p=_("span"),S=ee("/ "),w=ee(t[1]),L=R(),A=_("div"),T=_("span"),T.textContent=$,z=R(),x=_("span"),O=ee(U),Y=R(),W=_("span"),W.textContent=Z,H=R(),fe&&fe.c(),k=R(),oe&&oe.c(),q=R(),te=_("div"),F=_("span"),we.c(),this.h()},l(re){e=y(re,"DIV",{class:!0});var de=I(e);n=y(de,"DIV",{class:!0});var Ge=I(n);i=y(Ge,"SPAN",{class:!0,"data-svelte-h":!0}),ue(i)!=="svelte-18fq72a"&&(i.textContent=s),a=P(Ge),r=y(Ge,"BUTTON",{class:!0,title:!0});var ce=I(r);l=J(ce,o),ce.forEach(v),Ge.forEach(v),f=P(de),u=y(de,"DIV",{class:!0});var B=I(u);d=y(B,"DIV",{class:!0});var K=I(d);c=y(K,"SPAN",{class:!0,"data-svelte-h":!0}),ue(c)!=="svelte-1bu4eeu"&&(c.textContent=g),b=P(K),E=y(K,"SPAN",{class:!0,style:!0});var Ue=I(E);D=J(Ue,M),Ue.forEach(v),C=P(K),p=y(K,"SPAN",{class:!0});var Re=I(p);S=J(Re,"/ "),w=J(Re,t[1]),Re.forEach(v),K.forEach(v),L=P(B),A=y(B,"DIV",{class:!0});var Se=I(A);T=y(Se,"SPAN",{class:!0,"data-svelte-h":!0}),ue(T)!=="svelte-1ikbzr0"&&(T.textContent=$),z=P(Se),x=y(Se,"SPAN",{class:!0});var Ve=I(x);O=J(Ve,U),Ve.forEach(v),Y=P(Se),W=y(Se,"SPAN",{class:!0,"data-svelte-h":!0}),ue(W)!=="svelte-13w5gq7"&&(W.textContent=Z),Se.forEach(v),H=P(B),fe&&fe.l(B),B.forEach(v),k=P(de),oe&&oe.l(de),q=P(de),te=y(de,"DIV",{class:!0});var Ne=I(te);F=y(Ne,"SPAN",{class:!0});var Oe=I(F);we.l(Oe),Oe.forEach(v),Ne.forEach(v),de.forEach(v),this.h()},h(){m(i,"class","panel-title svelte-yn9y4g"),m(r,"class","toggle-controls svelte-yn9y4g"),m(r,"title","Show performance controls"),m(n,"class","panel-header svelte-yn9y4g"),m(c,"class","label svelte-yn9y4g"),m(E,"class","value svelte-yn9y4g"),Ze(E,"color",t[6]),m(p,"class","target svelte-yn9y4g"),m(d,"class","stat svelte-yn9y4g"),m(T,"class","label svelte-yn9y4g"),m(x,"class","value svelte-yn9y4g"),m(W,"class","unit svelte-yn9y4g"),m(A,"class","stat svelte-yn9y4g"),m(u,"class","stats-grid svelte-yn9y4g"),m(F,"class","hint svelte-yn9y4g"),m(te,"class","panel-footer svelte-yn9y4g"),m(e,"class","panel perf-panel svelte-yn9y4g"),X(e,"power-saver",t[7])},m(re,de){V(re,e,de),h(e,n),h(n,i),h(n,a),h(n,r),h(r,l),h(e,f),h(e,u),h(u,d),h(d,c),h(d,b),h(d,E),h(E,D),h(d,C),h(d,p),h(p,S),h(p,w),h(u,L),h(u,A),h(A,T),h(A,z),h(A,x),h(x,O),h(A,Y),h(A,W),h(u,H),fe&&fe.m(u,null),h(e,k),oe&&oe.m(e,null),h(e,q),h(e,te),h(te,F),we.m(F,null),N=!0,ie||(ye=Q(r,"click",t[10]),ie=!0)},p(re,de){(!N||de&16)&&o!==(o=re[4]?"":"+")&&he(l,o),(!N||de&4)&&M!==(M=re[2].fps+"")&&he(D,M),(!N||de&64)&&Ze(E,"color",re[6]),(!N||de&2)&&he(w,re[1]),(!N||de&4)&&U!==(U=re[2].frameTime.toFixed(1)+"")&&he(O,U),re[7]&&re[5]>0?fe?fe.p(re,de):(fe=Nt(re),fe.c(),fe.m(u,null)):fe&&(fe.d(1),fe=null),re[4]?oe?(oe.p(re,de),de&16&&G(oe,1)):(oe=Ot(re),oe.c(),G(oe,1),oe.m(e,q)):oe&&(ze(),j(oe,1,1,()=>{oe=null}),Pe()),De===(De=qe(re))&&we?we.p(re,de):(we.d(1),we=De(re),we&&(we.c(),we.m(F,null))),(!N||de&128)&&X(e,"power-saver",re[7])},i(re){N||(G(oe),N=!0)},o(re){j(oe),N=!1},d(re){re&&v(e),fe&&fe.d(),oe&&oe.d(),we.d(),ie=!1,ye()}}}function Nt(t){let e,n,i="Saved",s,a,r,o,l;return{c(){e=_("div"),n=_("span"),n.textContent=i,s=R(),a=_("span"),r=ee("~"),o=ee(t[5]),l=ee("%"),this.h()},l(f){e=y(f,"DIV",{class:!0});var u=I(e);n=y(u,"SPAN",{class:!0,"data-svelte-h":!0}),ue(n)!=="svelte-dz9cv6"&&(n.textContent=i),s=P(u),a=y(u,"SPAN",{class:!0});var d=I(a);r=J(d,"~"),o=J(d,t[5]),l=J(d,"%"),d.forEach(v),u.forEach(v),this.h()},h(){m(n,"class","label svelte-yn9y4g"),m(a,"class","value success svelte-yn9y4g"),m(e,"class","stat savings svelte-yn9y4g")},m(f,u){V(f,e,u),h(e,n),h(e,s),h(e,a),h(a,r),h(a,o),h(a,l)},p(f,u){u&32&&he(o,f[5])},d(f){f&&v(e)}}}function Ot(t){let e,n,i,s,a,r,o,l,f,u,d,c,g,b,E,M="Quick:",D,C,p="Mobile",S,w,L="Laptop",A,T,$="Desktop",z,x,U;function O(k){t[11](k)}let Y={label:"Power Saver"};t[3].powerSaverEnabled!==void 0&&(Y.checked=t[3].powerSaverEnabled),a=new ei({props:Y}),be.push(()=>Te(a,"checked",O));function W(k){t[12](k)}let Z={label:"Target",min:15,max:60,step:5,formatValue:t[8]};t[3].targetFps!==void 0&&(Z.value=t[3].targetFps),f=new Me({props:Z}),be.push(()=>Te(f,"value",W));let H=!t[7]&&$t();return{c(){e=_("div"),n=R(),i=_("div"),s=_("div"),le(a.$$.fragment),o=R(),l=_("div"),le(f.$$.fragment),d=R(),H&&H.c(),g=R(),b=_("div"),E=_("span"),E.textContent=M,D=R(),C=_("button"),C.textContent=p,S=R(),w=_("button"),w.textContent=L,A=R(),T=_("button"),T.textContent=$,this.h()},l(k){e=y(k,"DIV",{class:!0}),I(e).forEach(v),n=P(k),i=y(k,"DIV",{class:!0});var q=I(i);s=y(q,"DIV",{title:!0});var te=I(s);se(a.$$.fragment,te),te.forEach(v),o=P(q),l=y(q,"DIV",{class:!0,title:!0});var F=I(l);se(f.$$.fragment,F),d=P(F),H&&H.l(F),F.forEach(v),g=P(q),b=y(q,"DIV",{class:!0});var N=I(b);E=y(N,"SPAN",{class:!0,"data-svelte-h":!0}),ue(E)!=="svelte-9ap1jd"&&(E.textContent=M),D=P(N),C=y(N,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),ue(C)!=="svelte-211gfj"&&(C.textContent=p),S=P(N),w=y(N,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),ue(w)!=="svelte-mfdn79"&&(w.textContent=L),A=P(N),T=y(N,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),ue(T)!=="svelte-13c6eed"&&(T.textContent=$),N.forEach(v),q.forEach(v),this.h()},h(){m(e,"class","divider svelte-yn9y4g"),m(s,"title","Enable power saving mode to limit frame rate"),m(l,"class","fps-slider-wrapper svelte-yn9y4g"),m(l,"title",c=t[7]?"Target frames per second - lower values save more battery":"Enable Power Saver to limit frame rate"),X(l,"disabled",!t[7]),m(E,"class","presets-label svelte-yn9y4g"),m(C,"class","preset-btn svelte-yn9y4g"),m(C,"title","24fps - Best for phones and old devices"),X(C,"active",t[1]<=24),m(w,"class","preset-btn svelte-yn9y4g"),m(w,"title","30fps - Good for laptops on battery"),X(w,"active",t[1]===30),m(T,"class","preset-btn svelte-yn9y4g"),m(T,"title","60fps - Full quality for desktops"),X(T,"active",t[1]>=60&&!t[7]),m(b,"class","presets svelte-yn9y4g"),m(i,"class","controls-grid svelte-yn9y4g")},m(k,q){V(k,e,q),V(k,n,q),V(k,i,q),h(i,s),ae(a,s,null),h(i,o),h(i,l),ae(f,l,null),h(l,d),H&&H.m(l,null),h(i,g),h(i,b),h(b,E),h(b,D),h(b,C),h(b,S),h(b,w),h(b,A),h(b,T),z=!0,x||(U=[Q(C,"click",t[13]),Q(w,"click",t[14]),Q(T,"click",t[15])],x=!0)},p(k,q){const te={};!r&&q&8&&(r=!0,te.checked=k[3].powerSaverEnabled,_e(()=>r=!1)),a.$set(te);const F={};!u&&q&8&&(u=!0,F.value=k[3].targetFps,_e(()=>u=!1)),f.$set(F),k[7]?H&&(H.d(1),H=null):H||(H=$t(),H.c(),H.m(l,null)),(!z||q&128&&c!==(c=k[7]?"Target frames per second - lower values save more battery":"Enable Power Saver to limit frame rate"))&&m(l,"title",c),(!z||q&128)&&X(l,"disabled",!k[7]),(!z||q&2)&&X(C,"active",k[1]<=24),(!z||q&2)&&X(w,"active",k[1]===30),(!z||q&130)&&X(T,"active",k[1]>=60&&!k[7])},i(k){z||(G(a.$$.fragment,k),G(f.$$.fragment,k),z=!0)},o(k){j(a.$$.fragment,k),j(f.$$.fragment,k),z=!1},d(k){k&&(v(e),v(n),v(i)),ne(a),ne(f),H&&H.d(),x=!1,Ae(U)}}}function $t(t){let e,n="Enable Power Saver to apply";return{c(){e=_("span"),e.textContent=n,this.h()},l(i){e=y(i,"SPAN",{class:!0,"data-svelte-h":!0}),ue(e)!=="svelte-18yqm2c"&&(e.textContent=n),this.h()},h(){m(e,"class","slider-hint svelte-yn9y4g")},m(i,s){V(i,e,s)},d(i){i&&v(e)}}}function pn(t){let e;return{c(){e=ee("Running at display refresh rate")},l(n){e=J(n,"Running at display refresh rate")},m(n,i){V(n,e,i)},p:ve,d(n){n&&v(e)}}}function vn(t){let e,n,i,s,a;return{c(){e=ee("Limiting to "),n=ee(t[1]),i=ee("fps ("),s=ee(t[5]),a=ee("% less GPU)")},l(r){e=J(r,"Limiting to "),n=J(r,t[1]),i=J(r,"fps ("),s=J(r,t[5]),a=J(r,"% less GPU)")},m(r,o){V(r,e,o),V(r,n,o),V(r,i,o),V(r,s,o),V(r,a,o)},p(r,o){o&2&&he(n,r[1]),o&32&&he(s,r[5])},d(r){r&&(v(e),v(n),v(i),v(s),v(a))}}}function bn(t){let e,n,i=t[0]&&Vt(t);return{c(){i&&i.c(),e=pe()},l(s){i&&i.l(s),e=pe()},m(s,a){i&&i.m(s,a),V(s,e,a),n=!0},p(s,[a]){s[0]?i?(i.p(s,a),a&1&&G(i,1)):(i=Vt(s),i.c(),G(i,1),i.m(e.parentNode,e)):i&&(ze(),j(i,1,1,()=>{i=null}),Pe())},i(s){n||(G(i),n=!0)},o(s){j(i),n=!1},d(s){s&&v(e),i&&i.d(s)}}}function gn(t,e,n){let i,s,a,r,o,l;ke(t,Jt,p=>n(2,o=p)),ke(t,me,p=>n(3,l=p));let{visible:f=!0}=e,u=!1;const d=p=>`${Math.round(p)}`;function c(p){me.update(S=>{switch(p){case"mobile":return{...S,powerSaverEnabled:!0,targetFps:24};case"laptop":return{...S,powerSaverEnabled:!0,targetFps:30};case"desktop":return{...S,powerSaverEnabled:!1,targetFps:60};default:return S}})}const g=()=>n(4,u=!u);function b(p){t.$$.not_equal(l.powerSaverEnabled,p)&&(l.powerSaverEnabled=p,me.set(l))}function E(p){t.$$.not_equal(l.targetFps,p)&&(l.targetFps=p,me.set(l))}const M=()=>c("mobile"),D=()=>c("laptop"),C=()=>c("desktop");return t.$$set=p=>{"visible"in p&&n(0,f=p.visible)},t.$$.update=()=>{t.$$.dirty&8&&n(7,i=l.powerSaverEnabled),t.$$.dirty&8&&n(1,s=l.targetFps),t.$$.dirty&6&&n(6,a=o.fps>=s*.9?"var(--color-success)":o.fps>=s*.5?"var(--color-warning, #f59e0b)":"var(--color-error, #ef4444)"),t.$$.dirty&2&&n(5,r=Math.round((1-s/60)*100))},[f,s,o,l,u,r,a,i,d,c,g,b,E,M,D,C]}class yn extends Ie{constructor(e){super(),Be(this,e,gn,bn,Le,{visible:0})}}function Ht(t){let e,n,i,s="",a,r,o='<h1 id="info-title" class="svelte-199k3h4">SOUNDART</h1> <p class="tagline svelte-199k3h4">Audio-reactive WebGL visualizer that transforms sound into mesmerizing visuals in real-time.</p>',l,f,u='<section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Getting Started</h2> <ol class="svelte-199k3h4"><li class="svelte-199k3h4">Click <strong class="svelte-199k3h4">MIC ON</strong> to enable microphone</li> <li class="svelte-199k3h4">Play music or make sounds</li> <li class="svelte-199k3h4">Watch the visuals react!</li></ol></section> <section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Keyboard Shortcuts</h2> <div class="shortcuts svelte-199k3h4"><div class="shortcut svelte-199k3h4"><kbd class="svelte-199k3h4">C</kbd><span>Toggle control panels</span></div> <div class="shortcut svelte-199k3h4"><kbd class="svelte-199k3h4">F</kbd><span>Toggle fullscreen</span></div> <div class="shortcut svelte-199k3h4"><kbd class="svelte-199k3h4">?</kbd><span>Show/hide this help</span></div></div></section> <section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Touch Controls</h2> <div class="shortcuts svelte-199k3h4"><div class="shortcut svelte-199k3h4"><span class="gesture svelte-199k3h4">Single tap</span><span>Toggle panels</span></div> <div class="shortcut svelte-199k3h4"><span class="gesture svelte-199k3h4">Double tap</span><span>Toggle fullscreen</span></div></div></section> <section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Layers</h2> <ul class="svelte-199k3h4"><li class="svelte-199k3h4">Toggle layers on/off with the indicator dot</li> <li class="svelte-199k3h4">Click <strong class="svelte-199k3h4">+</strong> to expand and adjust settings</li> <li class="svelte-199k3h4">Adjust <strong class="svelte-199k3h4">intensity</strong>, <strong class="svelte-199k3h4">zoom</strong>, <strong class="svelte-199k3h4">theme</strong>, and <strong class="svelte-199k3h4">sensitivity</strong></li></ul> <h3 class="svelte-199k3h4">Global Controls</h3> <ul class="svelte-199k3h4"><li class="svelte-199k3h4"><strong class="svelte-199k3h4">RANDOM</strong> - Enable automatic parameter changes on beats</li> <li class="svelte-199k3h4"><strong class="svelte-199k3h4">STROBE</strong> - Enable layers flashing on/off with beats</li></ul> <h3 class="svelte-199k3h4">Per-Layer Buttons</h3> <div class="button-legend svelte-199k3h4"><div class="legend-item svelte-199k3h4"><span class="legend-btn r svelte-199k3h4">R</span><span>Include in randomizer (theme/intensity/zoom)</span></div> <div class="legend-item svelte-199k3h4"><span class="legend-btn s svelte-199k3h4">S</span><span>Include in strobe (flash on/off)</span></div></div></section> <section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Audio Tuning</h2> <ul class="svelte-199k3h4"><li class="svelte-199k3h4"><strong class="svelte-199k3h4">Global sensitivity</strong>: overall audio reactivity</li> <li class="svelte-199k3h4"><strong class="svelte-199k3h4">Frequency boosts</strong>: enhance specific ranges</li> <li class="svelte-199k3h4"><strong class="svelte-199k3h4">Beat gate</strong>: threshold for beat detection</li> <li class="svelte-199k3h4"><strong class="svelte-199k3h4">Auto-suggest</strong>: automatic sensitivity adjustment</li></ul></section> <section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Tips</h2> <ul class="svelte-199k3h4"><li class="svelte-199k3h4">Use <strong class="svelte-199k3h4">fullscreen</strong> for best experience</li> <li class="svelte-199k3h4">Try different <strong class="svelte-199k3h4">themes</strong> on each layer</li> <li class="svelte-199k3h4">Adjust <strong class="svelte-199k3h4">sensitivity</strong> if visuals are too subtle or intense</li> <li class="svelte-199k3h4">Enable <strong class="svelte-199k3h4">Power Saver</strong> on laptops to save battery</li></ul></section>',d,c,g='<span>Press <kbd class="svelte-199k3h4">?</kbd> or tap the help button to reopen</span>',b,E;return{c(){e=_("div"),n=_("div"),i=_("button"),i.textContent=s,a=R(),r=_("header"),r.innerHTML=o,l=R(),f=_("div"),f.innerHTML=u,d=R(),c=_("footer"),c.innerHTML=g,this.h()},l(M){e=y(M,"DIV",{class:!0});var D=I(e);n=y(D,"DIV",{class:!0,role:!0,"aria-modal":!0,"aria-labelledby":!0});var C=I(n);i=y(C,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),ue(i)!=="svelte-h7on2u"&&(i.textContent=s),a=P(C),r=y(C,"HEADER",{class:!0,"data-svelte-h":!0}),ue(r)!=="svelte-1jvg3xd"&&(r.innerHTML=o),l=P(C),f=y(C,"DIV",{class:!0,"data-svelte-h":!0}),ue(f)!=="svelte-1k0sc2q"&&(f.innerHTML=u),d=P(C),c=y(C,"FOOTER",{class:!0,"data-svelte-h":!0}),ue(c)!=="svelte-5jo3kb"&&(c.innerHTML=g),C.forEach(v),D.forEach(v),this.h()},h(){m(i,"class","close-btn svelte-199k3h4"),m(i,"aria-label","Close"),m(r,"class","info-header svelte-199k3h4"),m(f,"class","info-content svelte-199k3h4"),m(c,"class","info-footer svelte-199k3h4"),m(n,"class","info-panel svelte-199k3h4"),m(n,"role","dialog"),m(n,"aria-modal","true"),m(n,"aria-labelledby","info-title"),m(e,"class","overlay svelte-199k3h4")},m(M,D){V(M,e,D),h(e,n),h(n,i),h(n,a),h(n,r),h(n,l),h(n,f),h(n,d),h(n,c),b||(E=[Q(i,"click",t[1]),Q(e,"click",t[3])],b=!0)},p:ve,d(M){M&&v(e),b=!1,Ae(E)}}}function _n(t){let e,n,i,s=t[0]&&Ht(t);return{c(){s&&s.c(),e=pe()},l(a){s&&s.l(a),e=pe()},m(a,r){s&&s.m(a,r),V(a,e,r),n||(i=Q(window,"keydown",t[2]),n=!0)},p(a,[r]){a[0]?s?s.p(a,r):(s=Ht(a),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null)},i:ve,o:ve,d(a){a&&v(e),s&&s.d(a),n=!1,i()}}}const qt="soundart-seen-info";function Tn(t,e,n){let{visible:i=!1}=e,{onClose:s}=e;function a(){return!localStorage.getItem(qt)}function r(){localStorage.setItem(qt,"true")}function o(){r(),s()}function l(u){u.key==="Escape"&&i&&o()}function f(u){u.target===u.currentTarget&&o()}return t.$$set=u=>{"visible"in u&&n(0,i=u.visible),"onClose"in u&&n(4,s=u.onClose)},[i,o,l,f,s,a]}class kn extends Ie{constructor(e){super(),Be(this,e,Tn,_n,Le,{visible:0,onClose:4,shouldShowOnFirstVisit:5})}get shouldShowOnFirstVisit(){return this.$$.ctx[5]}}function wn(t){let e,n,i,s,a,r,o,l,f,u,d,c,g,b,E,M,D,C={};return n=new Hi({props:C}),t[10](n),s=new nn({props:{onEnableMic:t[4],onDisableMic:t[5],onShowInfo:t[6],visible:t[3].panelsVisible}}),r=new on({props:{visible:t[3].panelsVisible}}),l=new dn({props:{visible:t[3].panelsVisible}}),u=new hn({props:{visible:t[3].panelsVisible}}),c=new yn({props:{visible:t[3].panelsVisible}}),b=new kn({props:{visible:t[1],onClose:t[7]}}),{c(){e=_("main"),le(n.$$.fragment),i=R(),le(s.$$.fragment),a=R(),le(r.$$.fragment),o=R(),le(l.$$.fragment),f=R(),le(u.$$.fragment),d=R(),le(c.$$.fragment),g=R(),le(b.$$.fragment),this.h()},l(p){e=y(p,"MAIN",{class:!0});var S=I(e);se(n.$$.fragment,S),i=P(S),se(s.$$.fragment,S),a=P(S),se(r.$$.fragment,S),o=P(S),se(l.$$.fragment,S),f=P(S),se(u.$$.fragment,S),d=P(S),se(c.$$.fragment,S),g=P(S),se(b.$$.fragment,S),S.forEach(v),this.h()},h(){m(e,"class","app svelte-oysh0a"),X(e,"cursor-hidden",t[2])},m(p,S){V(p,e,S),ae(n,e,null),h(e,i),ae(s,e,null),h(e,a),ae(r,e,null),h(e,o),ae(l,e,null),h(e,f),ae(u,e,null),h(e,d),ae(c,e,null),h(e,g),ae(b,e,null),E=!0,M||(D=[Q(window,"keydown",t[8]),Q(window,"mousemove",t[9])],M=!0)},p(p,[S]){const w={};n.$set(w);const L={};S&8&&(L.visible=p[3].panelsVisible),s.$set(L);const A={};S&8&&(A.visible=p[3].panelsVisible),r.$set(A);const T={};S&8&&(T.visible=p[3].panelsVisible),l.$set(T);const $={};S&8&&($.visible=p[3].panelsVisible),u.$set($);const z={};S&8&&(z.visible=p[3].panelsVisible),c.$set(z);const x={};S&2&&(x.visible=p[1]),b.$set(x),(!E||S&4)&&X(e,"cursor-hidden",p[2])},i(p){E||(G(n.$$.fragment,p),G(s.$$.fragment,p),G(r.$$.fragment,p),G(l.$$.fragment,p),G(u.$$.fragment,p),G(c.$$.fragment,p),G(b.$$.fragment,p),E=!0)},o(p){j(n.$$.fragment,p),j(s.$$.fragment,p),j(r.$$.fragment,p),j(l.$$.fragment,p),j(u.$$.fragment,p),j(c.$$.fragment,p),j(b.$$.fragment,p),E=!1},d(p){p&&v(e),t[10](null),ne(n),ne(s),ne(r),ne(l),ne(u),ne(c),ne(b),M=!1,Ae(D)}}}const nt="soundart-seen-info",En=3e3;function Mn(t,e,n){let i;ke(t,me,p=>n(3,i=p));let s,a=!1,r=!1,o=null;async function l(){return s?await s.enableMicrophone():!1}function f(){s&&s.disableMicrophone()}function u(){n(1,a=!0)}function d(){n(1,a=!1),localStorage.setItem(nt,"true")}function c(){a?d():u()}function g(p){if(!(p.target instanceof HTMLInputElement||p.target instanceof HTMLTextAreaElement))switch(p.key){case"?":c();break;case"c":case"C":a||gi();break;case"f":case"F":a||b();break}}async function b(){document.fullscreenElement?(await document.exitFullscreen(),me.update(p=>({...p,fullscreen:!1}))):(await document.documentElement.requestFullscreen(),me.update(p=>({...p,fullscreen:!0})))}function E(){me.update(p=>({...p,fullscreen:!!document.fullscreenElement}))}function M(){r&&n(2,r=!1),o&&clearTimeout(o),o=setTimeout(()=>{n(2,r=!0)},En)}function D(){M()}Gt(()=>{document.addEventListener("fullscreenchange",E),M(),localStorage.getItem(nt)||setTimeout(()=>{n(1,a=!0)},800);const p=localStorage.getItem(nt)?500:1500;return setTimeout(()=>{l()},p),()=>{document.removeEventListener("fullscreenchange",E),o&&clearTimeout(o)}});function C(p){be[p?"unshift":"push"](()=>{s=p,n(0,s)})}return[s,a,r,i,l,f,u,d,g,D,C]}class Bn extends Ie{constructor(e){super(),Be(this,e,Mn,wn,Le,{})}}export{Bn as component};
