import{r as $e,P as xe,s as Le,n as ge,d as p,i as V,Q as ne,A as m,c as _,e as I,h as y,k as we,x as qt,R as ti,C as ve,a as me,S as Y,b as h,f as se,g as R,t as ae,j as A,T as Ht,U as ii,V as ft,W as ct,B as Ze,v as he,m as ni,X as re,Y as _e}from"../chunks/D6DlaX6_.js";import{a as O,t as G,S as Be,i as Ie,g as Pe,c as De,d as x,m as ee,e as te,b as ie,f as ye}from"../chunks/COUIFFA3.js";import{b as Gt,d as lt,w as Ae}from"../chunks/BT1N22IJ.js";function Ye(i){return i?.length!==void 0?i:Array.from(i)}function Xt(i,e){G(i,1,1,()=>{e.delete(i.key)})}function jt(i,e,n,t,s,a,r,o,l,c,u,f){let g=i.length,w=a.length,v=g;const M={};for(;v--;)M[i[v].key]=v;const S=[],C=new Map,P=new Map,d=[];for(v=w;v--;){const F=f(s,a,v),T=n(F);let z=r.get(T);z?d.push(()=>z.p(F,e)):(z=c(T,F),z.c()),C.set(T,S[v]=z),T in M&&P.set(T,Math.abs(v-M[T]))}const E=new Set,b=new Set;function X(F){O(F,1),F.m(o,u),r.set(F.key,F),u=F.first,w--}for(;g&&w;){const F=S[w-1],T=i[g-1],z=F.key,D=T.key;F===T?(u=F.first,g--,w--):C.has(D)?!r.has(z)||E.has(z)?X(F):b.has(D)?g--:P.get(z)>P.get(D)?(b.add(z),X(F)):(E.add(D),g--):(l(T,r),g--)}for(;g--;){const F=i[g];C.has(F.key)||l(F,r)}for(;w;)X(S[w-1]);return $e(d),S}const et=new Map;async function Zt(i){if(et.has(i))return et.get(i);const e=await fetch(i);if(!e.ok)throw new Error(`Failed to load shader: ${i}`);const n=await e.text();return et.set(i,n),n}async function Yt(i,e,n=new Set){const t=/#include\s+"([^"]+)"/g;let s=i,a;const r=[];for(;(a=t.exec(i))!==null;)r.push({full:a[0],path:a[1]});for(const{full:o,path:l}of r){const c=e+l;if(n.has(c)){console.warn(`Circular include detected: ${c}`),s=s.replace(o,"");continue}n.add(c);try{let u=await Zt(c);u=await Yt(u,e,n),s=s.replace(o,u)}catch(u){console.error(`Failed to include shader: ${c}`,u),s=s.replace(o,`// Failed to include: ${l}`)}}return s}async function dt(i,e=`${Gt}/shaders/`){const n=await Zt(e+i);return Yt(n,e)}function mt(i,e,n){const t=i.createShader(e);if(!t)return console.error("Failed to create shader"),null;if(i.shaderSource(t,n),i.compileShader(t),!i.getShaderParameter(t,i.COMPILE_STATUS)){const s=i.getShaderInfoLog(t);console.error("Shader compilation error:",s);const r=n.split(`
`).map((o,l)=>`${l+1}: ${o}`);return console.error(`Shader source:
`+r.join(`
`)),i.deleteShader(t),null}return t}function si(i,e,n){const t=mt(i,i.VERTEX_SHADER,e),s=mt(i,i.FRAGMENT_SHADER,n);if(!t||!s)return null;const a=i.createProgram();if(!a)return console.error("Failed to create program"),null;if(i.attachShader(a,t),i.attachShader(a,s),i.linkProgram(a),!i.getProgramParameter(a,i.LINK_STATUS)){const r=i.getProgramInfoLog(a);return console.error("Program linking error:",r),i.deleteProgram(a),null}return i.deleteShader(t),i.deleteShader(s),a}async function ht(i,e,n,t=`${Gt}/shaders/`){const[s,a]=await Promise.all([dt(e,t),dt(n,t)]);return si(i,s,a)}const He=[{id:"glow",label:"Center Glow",description:"Pulsing core with arcs",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerGlow"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerGlowZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerGlowTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerGlowSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerGlowMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/glow.glsl",randomizable:!0},{id:"turbulence",label:"Turbulence",description:"Audio-reactive turbulence",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerTurbulence"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerTurbulenceZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerTurbulenceTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerTurbulenceSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerTurbulenceMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.3,transform:"linear"}],shaderPath:"layers/turbulence.glsl",randomizable:!0},{id:"displacement",label:"Displacement",description:"Cellular displacement waves",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerDisplacement"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerDisplacementZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerDisplacementTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerDisplacementSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerDisplacementMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.3,transform:"linear"}],shaderPath:"layers/displacement.glsl",randomizable:!0},{id:"starfield",label:"Starfield",description:"Warp tunnel streaks",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerStarfield"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerStarfieldZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerStarfieldTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerStarfieldSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerStarfieldMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"}],shaderPath:"layers/starfield.glsl",randomizable:!0},{id:"cubescape",label:"Cubescape",description:"3D cube lattice",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerCubescape"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerCubescapeZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerCubescapeTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerCubescapeSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerCubescapeMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/cubescape.glsl",randomizable:!0},{id:"spires",label:"Spires",description:"Cathedral-like pillars",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerSpires"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerSpiresZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerSpiresTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerSpiresSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerSpiresMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.3,transform:"linear"}],shaderPath:"layers/spires.glsl",randomizable:!0},{id:"mandala",label:"Mandala",description:"Radial symmetries",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerMandala"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerMandalaZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerMandalaTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerMandalaSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerMandalaMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/mandala.glsl",randomizable:!0},{id:"kaleidoscope",label:"Kaleidoscope",description:"Sacred geometry mirroring",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerKaleidoscope"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerKaleidoscopeZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerKaleidoscopeTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerKaleidoscopeSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerKaleidoscopeMouseSens"}],audioBindings:[{audioMetric:"treble",targetProperty:"intensity",sensitivity:1,transform:"linear"}],shaderPath:"layers/kaleidoscope.glsl",randomizable:!0},{id:"lissajous",label:"Lissajous",description:"Flowing curves",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerLissajous"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerLissajousZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerLissajousTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerLissajousSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerLissajousMouseSens"}],audioBindings:[{audioMetric:"energy",targetProperty:"intensity",sensitivity:1,transform:"linear"}],shaderPath:"layers/lissajous.glsl",randomizable:!0},{id:"flower",label:"Flower of Life",description:"Sacred circles",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerFlower"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerFlowerZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerFlowerTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerFlowerSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerFlowerMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"}],shaderPath:"layers/flower.glsl",randomizable:!0},{id:"fibonacci",label:"Fibonacci",description:"Golden spiral",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerFibonacci"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerFibonacciZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerFibonacciTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerFibonacciSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerFibonacciMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"}],shaderPath:"layers/fibonacci.glsl",randomizable:!0},{id:"hopalong",label:"Hopalong Orbits",description:"Barry Martin attractor",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerHopalong"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerHopalongZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerHopalongTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerHopalongSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerHopalongMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/hopalong.glsl",randomizable:!0}];class ai{canvas;gl=null;program=null;uniformLocations={};mouseUniformLocations={};layerUniformLocations=new Map;reactionProgram=null;reactionUniforms={input:null,texel:null,time:null,treble:null};reactionSeeded=!1;feedbackTexture=null;feedbackReady=!1;reactionBuffer=null;positionBuffer=null;initialized=!1;currentTime=0;constructor(e){this.canvas=e}async init(){if(this.gl=this.canvas.getContext("webgl",{antialias:!1,preserveDrawingBuffer:!0}),!this.gl)return console.error("WebGL not supported"),!1;const e=this.gl;try{if(this.program=await ht(e,"quad.vert","composite.frag"),!this.program)return console.error("Failed to create shader program"),!1;if(this.reactionProgram=await ht(e,"quad.vert","reaction_diffusion.frag"),!this.reactionProgram)return console.error("Failed to create reaction-diffusion program"),!1;this.reactionUniforms={input:e.getUniformLocation(this.reactionProgram,"uInput"),texel:e.getUniformLocation(this.reactionProgram,"uTexel"),time:e.getUniformLocation(this.reactionProgram,"uTime"),treble:e.getUniformLocation(this.reactionProgram,"uTreble")}}catch(r){return console.error("Failed to load shaders:",r),!1}this.uniformLocations={time:e.getUniformLocation(this.program,"uTime"),resolution:e.getUniformLocation(this.program,"uResolution"),beat:e.getUniformLocation(this.program,"uBeat"),energy:e.getUniformLocation(this.program,"uEnergy"),treble:e.getUniformLocation(this.program,"uTreble"),feedbackTexture:e.getUniformLocation(this.program,"uFeedbackTex"),feedbackReady:e.getUniformLocation(this.program,"uFeedbackReady"),reactionTexture:e.getUniformLocation(this.program,"uReactionTex")},this.mouseUniformLocations={position:e.getUniformLocation(this.program,"uMouse"),velocity:e.getUniformLocation(this.program,"uMouseVelocity"),speed:e.getUniformLocation(this.program,"uMouseSpeed"),down:e.getUniformLocation(this.program,"uMouseDown"),click:e.getUniformLocation(this.program,"uMouseClick")};for(const r of He)for(const o of r.properties){const l=e.getUniformLocation(this.program,o.uniform);this.layerUniformLocations.set(o.uniform,l)}this.positionBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.positionBuffer);const n=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]);e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW);const t=e.getAttribLocation(this.program,"aPosition");e.enableVertexAttribArray(t),e.vertexAttribPointer(t,2,e.FLOAT,!1,0,0),this.feedbackTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.feedbackTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.canvas.width,this.canvas.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);const s=Math.max(1,this.canvas.width),a=Math.max(1,this.canvas.height);return this.reactionBuffer=this.createPingPongBuffer(s,a),this.initialized=!0,!0}resize(){if(!this.gl||!this.canvas)return;const e=this.gl,n=window.devicePixelRatio||1,t=Math.floor(this.canvas.clientWidth*n),s=Math.floor(this.canvas.clientHeight*n);(this.canvas.width!==t||this.canvas.height!==s)&&(this.canvas.width=t,this.canvas.height=s,e.viewport(0,0,t,s),this.feedbackTexture&&(e.bindTexture(e.TEXTURE_2D,this.feedbackTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,s,0,e.RGBA,e.UNSIGNED_BYTE,null)),this.reactionBuffer&&(this.resizePingPongBuffer(this.reactionBuffer,t,s),this.reactionSeeded=!1),this.feedbackReady=!1)}render(e,n,t,s){if(!this.gl||!this.program||!this.initialized)return;const a=this.gl;this.currentTime=e,this.resize(),this.renderReactionDiffusion(8,n.treble),a.clearColor(0,0,0,1),a.clear(a.COLOR_BUFFER_BIT),a.useProgram(this.program);const r=a.getAttribLocation(this.program,"aPosition");a.bindBuffer(a.ARRAY_BUFFER,this.positionBuffer),a.enableVertexAttribArray(r),a.vertexAttribPointer(r,2,a.FLOAT,!1,0,0),a.uniform1f(this.uniformLocations.time,e),a.uniform2f(this.uniformLocations.resolution,this.canvas.width,this.canvas.height),a.uniform1f(this.uniformLocations.beat,n.beat),a.uniform1f(this.uniformLocations.energy,n.energy),a.uniform1f(this.uniformLocations.treble,n.treble),a.uniform2f(this.mouseUniformLocations.position,t.x,t.y),a.uniform2f(this.mouseUniformLocations.velocity,t.velocityX,t.velocityY),a.uniform1f(this.mouseUniformLocations.speed,t.speed),a.uniform1f(this.mouseUniformLocations.down,t.down),a.uniform2f(this.mouseUniformLocations.click,t.clickX,t.clickY);for(const[o,l]of Object.entries(s)){const c=this.layerUniformLocations.get(o);c&&a.uniform1f(c,l)}a.activeTexture(a.TEXTURE0),this.feedbackTexture&&this.feedbackReady?a.bindTexture(a.TEXTURE_2D,this.feedbackTexture):a.bindTexture(a.TEXTURE_2D,null),a.uniform1i(this.uniformLocations.feedbackTexture,0),a.uniform1f(this.uniformLocations.feedbackReady,this.feedbackReady?1:0),a.activeTexture(a.TEXTURE1),this.reactionBuffer&&this.reactionBuffer.textures[this.reactionBuffer.index]?a.bindTexture(a.TEXTURE_2D,this.reactionBuffer.textures[this.reactionBuffer.index]):a.bindTexture(a.TEXTURE_2D,null),a.uniform1i(this.uniformLocations.reactionTexture,1),a.drawArrays(a.TRIANGLES,0,6),this.canvas.width>0&&this.canvas.height>0&&this.feedbackTexture&&(a.bindTexture(a.TEXTURE_2D,this.feedbackTexture),a.copyTexSubImage2D(a.TEXTURE_2D,0,0,0,0,0,this.canvas.width,this.canvas.height),this.feedbackReady=!0),a.activeTexture(a.TEXTURE0)}dispose(){if(!this.gl)return;const e=this.gl;this.program&&(e.deleteProgram(this.program),this.program=null),this.reactionProgram&&(e.deleteProgram(this.reactionProgram),this.reactionProgram=null),this.positionBuffer&&(e.deleteBuffer(this.positionBuffer),this.positionBuffer=null),this.feedbackTexture&&(e.deleteTexture(this.feedbackTexture),this.feedbackTexture=null),this.reactionBuffer&&(this.disposePingPongBuffer(this.reactionBuffer),this.reactionBuffer=null),this.reactionSeeded=!1,this.initialized=!1}isInitialized(){return this.initialized}getCanvas(){return this.canvas}createPingPongBuffer(e,n){if(!this.gl)return null;const t=this.gl,s={textures:[null,null],framebuffers:[null,null],index:0,width:e,height:n};for(let a=0;a<2;a++){const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,n,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),s.textures[a]=r;const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const l=t.checkFramebufferStatus(t.FRAMEBUFFER);l!==t.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer not complete:",l),s.framebuffers[a]=o}return t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),s}swapPingPong(e){e.index=1-e.index}resizePingPongBuffer(e,n,t){if(!this.gl||e.width===n&&e.height===t)return;const s=this.gl;e.width=n,e.height=t;for(let a=0;a<2;a++)e.textures[a]&&(s.bindTexture(s.TEXTURE_2D,e.textures[a]),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,n,t,0,s.RGBA,s.UNSIGNED_BYTE,null));s.bindTexture(s.TEXTURE_2D,null)}disposePingPongBuffer(e){if(!this.gl)return;const n=this.gl;for(let t=0;t<2;t++)e.textures[t]&&(n.deleteTexture(e.textures[t]),e.textures[t]=null),e.framebuffers[t]&&(n.deleteFramebuffer(e.framebuffers[t]),e.framebuffers[t]=null)}seedReactionBuffer(){if(!this.gl||!this.reactionBuffer)return;const e=this.gl,n=this.reactionBuffer.width,t=this.reactionBuffer.height,s=new Uint8Array(n*t*4);for(let a=0;a<t;a++)for(let r=0;r<n;r++){const o=(a*n+r)*4;s[o]=255;const l=r-n/2,c=a-t/2,u=Math.sqrt(l*l+c*c),f=Math.min(n,t)*.3;u<f&&Math.random()<.15?s[o+1]=255:s[o+1]=0,s[o+2]=0,s[o+3]=255}for(let a=0;a<2;a++)e.bindTexture(e.TEXTURE_2D,this.reactionBuffer.textures[a]),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n,t,0,e.RGBA,e.UNSIGNED_BYTE,s);e.bindTexture(e.TEXTURE_2D,null),this.reactionSeeded=!0}renderReactionDiffusion(e,n){if(!this.gl||!this.reactionProgram||!this.reactionBuffer||!this.positionBuffer)return;const t=this.gl;this.reactionSeeded||this.seedReactionBuffer(),t.useProgram(this.reactionProgram);const s=t.getAttribLocation(this.reactionProgram,"aPosition");t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.enableVertexAttribArray(s),t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.uniform2f(this.reactionUniforms.texel,1/this.reactionBuffer.width,1/this.reactionBuffer.height),t.uniform1f(this.reactionUniforms.time,this.currentTime),t.uniform1f(this.reactionUniforms.treble,n);for(let a=0;a<e;a++){const r=this.reactionBuffer.index,o=1-r;t.bindFramebuffer(t.FRAMEBUFFER,this.reactionBuffer.framebuffers[o]),t.viewport(0,0,this.reactionBuffer.width,this.reactionBuffer.height),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.reactionBuffer.textures[r]),t.uniform1i(this.reactionUniforms.input,0),t.drawArrays(t.TRIANGLES,0,6),this.swapPingPong(this.reactionBuffer)}t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,this.canvas.width,this.canvas.height)}}function Ge(i,e,n){return i+(e-i)*n}function li(i,e,n){return Math.min(Math.max(i,e),n)}class ri{context=null;analyser=null;source=null;freqData=null;stream=null;energy=0;treble=0;highs=0;mids=0;lows=0;bass=0;beatValue=0;beatCutoff=0;beatHold=0;smoothing=.3;beatFalloff=2.4;beatMin=.15;beatDecay=.98;beatHoldTime=.08;async init(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});const e=window.AudioContext||window.webkitAudioContext;return this.context=new e,this.source=this.context.createMediaStreamSource(this.stream),this.analyser=this.context.createAnalyser(),this.analyser.fftSize=2048,this.analyser.smoothingTimeConstant=.8,this.source.connect(this.analyser),this.freqData=new Uint8Array(this.analyser.frequencyBinCount),!0}catch(e){return console.error("Failed to initialize audio:",e),!1}}dispose(){this.source&&(this.source.disconnect(),this.source=null),this.context&&(this.context.close(),this.context=null),this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null),this.analyser=null,this.freqData=null}update(e){if(!this.analyser||!this.freqData)return this.getEmptyMetrics();this.analyser.getByteFrequencyData(this.freqData);const n=this.freqData.length,s=(this.context?.sampleRate||44100)/this.analyser.fftSize,a=120,r=200,o=2e3,l=6e3,c=Math.max(2,Math.floor(a/s)),u=Math.max(c+1,Math.floor(r/s)),f=Math.max(u+1,Math.floor(o/s)),g=Math.max(f+1,Math.floor(l/s)),w=Math.min(n-1,u),v=Math.min(n-1,f),M=Math.min(n-1,g);let S=0,C=0,P=0,d=0,E=0,b=0;for(let H=0;H<n;H++){const Z=this.freqData[H];S+=Z,H<c&&(C+=Z),H<w?P+=Z:H<v?d+=Z:H<M?E+=Z:b+=Z}const X=S/(n*255),F=C/(Math.max(1,c)*255),T=P/(Math.max(1,w)*255),z=d/(Math.max(1,v-w)*255),D=E/(Math.max(1,M-v)*255),$=b/(Math.max(1,n-M)*255);this.energy=Ge(this.energy,X,this.smoothing),this.treble=Ge(this.treble,$,this.smoothing),this.highs=Ge(this.highs,D,this.smoothing),this.mids=Ge(this.mids,z,this.smoothing),this.lows=Ge(this.lows,T,this.smoothing),this.bass=Ge(this.bass,F,this.smoothing);const N=Math.max(0,e);return this.beatValue=Math.max(0,this.beatValue-N*this.beatFalloff),T>this.beatCutoff&&T>this.beatMin&&(this.beatValue=li(T*1.5,0,1),this.beatCutoff=T*1.1,this.beatHold=this.beatHoldTime),this.beatHold>0?this.beatHold-=N:this.beatCutoff=Math.max(this.beatMin,this.beatCutoff-N*this.beatDecay),{energy:this.energy,treble:this.treble,highs:this.highs,mids:this.mids,lows:this.lows,bass:this.bass,beat:this.beatValue}}getEmptyMetrics(){return{energy:0,treble:0,highs:0,mids:0,lows:0,bass:0,beat:0}}isInitialized(){return this.analyser!==null}}const oi={energy:0,treble:0,bass:0,mids:0,highs:0,lows:0,beat:0},ui={sensitivity:1,highsBoost:1,midsBoost:1,lowsBoost:1,trebleBoost:1,bassBoost:1,beatBoost:1,minMotion:.02,beatGate:.35,autoEnabled:!1,autoStrength:.4,autoDecay:.6,autoTarget:"all"},Wt=Ae(oi),be=Ae(ui),at=Ae(!1),Kt=Ae(0);function ke(i,e,n){return Math.min(Math.max(i,e),n)}const rt=lt([Wt,be,Kt],([i,e,n])=>{const t=ke(e.sensitivity,0,2);let s=ke(i.energy*t,0,2),a=ke(i.treble*t*e.trebleBoost,0,2),r=ke(i.beat*t*e.beatBoost*e.bassBoost,0,2);const o=(e.highsBoost+e.midsBoost+e.lowsBoost)/3;if(s*=o,s=Math.max(s,e.minMotion),a=Math.max(a,e.minMotion),r=Math.max(r,e.minMotion),e.autoEnabled&&n>0){const l=n*e.autoStrength;switch(e.autoTarget){case"energy":s+=l;break;case"treble":a+=l;break;case"beat":r+=l;break;default:s+=l,a+=l,r+=l}}return{energy:ke(s,0,2),treble:ke(a,0,2),beat:ke(r,0,2),raw:{highs:ke(i.highs*t,0,2),mids:ke(i.mids*t,0,2),lows:ke(i.lows*t,0,2),treble:ke(i.treble*t,0,2),bass:ke(i.bass*t,0,2),beat:ke(i.beat*t,0,2)}}});function fi(){const i=new Map;for(const e of He){const n={};for(const t of e.properties)n[t.id]=t.default;i.set(e.id,{id:e.id,enabled:!1,properties:n,includeInRandomizer:e.randomizable!==!1,includeInStrobe:e.randomizable!==!1})}return i}const Re=Ae(fi());function pt(i,e,n){Re.update(t=>{const s=t.get(i);return s&&(s.properties[e]=n),t})}function ci(i){Re.update(e=>{const n=e.get(i);if(n&&(n.enabled=!n.enabled,n.enabled)){const s=He.find(a=>a.id===i)?.properties.find(a=>a.id==="intensity");s&&(n.properties.intensity=s.default)}return e})}function di(i){Re.update(e=>{const n=e.get(i);return n&&(n.includeInRandomizer=!n.includeInRandomizer),e})}function mi(i){Re.update(e=>{const n=e.get(i);return n&&(n.includeInStrobe=!n.includeInStrobe),e})}function hi(i){Re.update(e=>{for(const n of e.values())if(n.enabled=i,i){const s=He.find(a=>a.id===n.id)?.properties.find(a=>a.id==="intensity");s&&(n.properties.intensity=s.default)}return e})}const pi=lt([Re,rt],([i,e])=>{const n={};for(const t of He){const s=i.get(t.id);if(s){for(const a of t.properties){let r=s.properties[a.id]??a.default;a.id==="intensity"&&!s.enabled&&(r=0),n[a.uniform]=r}for(const a of t.audioBindings)if(e[a.audioMetric],t.properties.find(o=>o.id===a.targetProperty)){const o=t.properties.find(l=>l.id==="sensitivity");o&&(n[o.uniform]=s.properties.sensitivity??1)}}}return n}),vi={panelsVisible:!0,fullscreen:!1,pipEnabled:!1,powerSaverEnabled:!1,targetFps:60,randomizerEnabled:!0,randomizerCooldown:2,randomizerTogglesLayers:!0,randomizerToggleChance:.3},de=Ae(vi);function gi(){de.update(i=>({...i,panelsVisible:!i.panelsVisible}))}function bi(){de.update(i=>({...i,powerSaverEnabled:!i.powerSaverEnabled}))}function _i(){de.update(i=>({...i,randomizerEnabled:!i.randomizerEnabled}))}function yi(){de.update(i=>({...i,randomizerTogglesLayers:!i.randomizerTogglesLayers}))}const ot=[{id:0,label:"LSD (Rainbow)",preview:"linear-gradient(90deg, #ff0000, #ff8800, #ffff00, #00ff00, #00ffff, #0088ff, #8800ff, #ff00ff)",brightness:"bright",temperature:"neutral",saturation:"high",family:"spectrum"},{id:1,label:"Sunset",preview:"linear-gradient(90deg, #ff2e1f, #ff8c1f, #ffd940)",brightness:"bright",temperature:"warm",saturation:"high",family:"fire"},{id:2,label:"Aurora",preview:"linear-gradient(90deg, #0dd9b3, #1a59ff, #8ce6ff)",brightness:"medium",temperature:"cool",saturation:"high",family:"ocean"},{id:3,label:"Ultraviolet",preview:"linear-gradient(90deg, #8c26ff, #ff33bf, #3366ff)",brightness:"medium",temperature:"cool",saturation:"high",family:"cosmic"},{id:4,label:"Neon",preview:"linear-gradient(90deg, #1aff73, #ff1ad9)",brightness:"bright",temperature:"neutral",saturation:"high",family:"neon"},{id:5,label:"Split Complement",preview:"linear-gradient(90deg, #14d1ff, #ff7333, #cc33ff)",brightness:"bright",temperature:"neutral",saturation:"high",family:"spectrum"},{id:6,label:"Analogous Cool",preview:"linear-gradient(90deg, #14e6bf, #268cff, #6640ff)",brightness:"medium",temperature:"cool",saturation:"high",family:"ocean"},{id:7,label:"Tetradic",preview:"linear-gradient(90deg, #ff4d59, #33e699, #4073ff, #ffd933)",brightness:"bright",temperature:"neutral",saturation:"high",family:"spectrum"},{id:8,label:"Pastel Triad",preview:"linear-gradient(90deg, #e6a3a3, #a3e6b8, #a3b8e6)",brightness:"medium",temperature:"neutral",saturation:"low",family:"twilight"},{id:9,label:"Bioluminescent",preview:"linear-gradient(90deg, #001426, #00a3cc, #4dff99, #004066)",brightness:"dark",temperature:"cool",saturation:"medium",family:"ocean"},{id:10,label:"Iridescent",preview:"linear-gradient(90deg, #1a004d, #0080a6, #e6338c, #ffcc33, #33e666)",brightness:"medium",temperature:"neutral",saturation:"medium",family:"twilight"},{id:11,label:"Chromatic",preview:"linear-gradient(90deg, #ff0066, #00ff88, #0066ff, #ff0066)",brightness:"bright",temperature:"neutral",saturation:"high",family:"neon"},{id:12,label:"Golden Liminal",preview:"linear-gradient(90deg, #ffbf4d, #d9738c, #664db3, #261a59)",brightness:"medium",temperature:"warm",saturation:"medium",family:"twilight"},{id:13,label:"OK Rainbow",preview:"linear-gradient(90deg, #ff6b8a, #e6a040, #8fbf40, #40bfbf, #6b8aff, #bf40bf)",brightness:"medium",temperature:"neutral",saturation:"medium",family:"spectrum"},{id:14,label:"Synesthetic",preview:"linear-gradient(90deg, #7733ff, #cc33cc, #ff33aa, #ff66cc)",brightness:"medium",temperature:"cool",saturation:"high",family:"cosmic"},{id:15,label:"Entropy",preview:"linear-gradient(90deg, #00ffff, #1a0033, #ff4d00, #00cc33)",brightness:"medium",temperature:"neutral",saturation:"high",family:"neon"},{id:16,label:"Velvet Depths",preview:"linear-gradient(90deg, #1f142e, #8c59a6, #e6d9f2, #402659)",brightness:"dark",temperature:"cool",saturation:"low",family:"cosmic"},{id:17,label:"Solar Flare",preview:"linear-gradient(90deg, #1a0000, #cc1a00, #ff9900, #ffffb3)",brightness:"bright",temperature:"warm",saturation:"high",family:"fire"},{id:18,label:"Void Pulse",preview:"linear-gradient(90deg, #000000, #660019, #cc3366, #000000)",brightness:"dark",temperature:"warm",saturation:"low",family:"cosmic"},{id:19,label:"Starless Night",preview:"linear-gradient(90deg, #050a14, #1a3a66, #050a14)",brightness:"dark",temperature:"cool",saturation:"low",family:"ocean"},{id:20,label:"Event Horizon",preview:"linear-gradient(90deg, #000000, #000000, #ff6619, #99ccff, #000000)",brightness:"dark",temperature:"neutral",saturation:"medium",family:"cosmic"}],wi={spectrum:[0,5,7,13],fire:[1,12,17,18],ocean:[2,6,9,19],cosmic:[3,14,16,18,20],neon:[4,11,15],twilight:[8,10,12]};function Je(i){return ot.find(e=>e.id===i)}const Ti={dark:.2,medium:.5,bright:1},vt=Ae({lastChangeTime:0,cooldown:2}),gt=2.5;function tt(i,e){return i+Math.random()*(e-i)}function Qt(i,e){return Math.floor(Math.random()*(e-i+1))+i}function it(i){if(i.length===0)throw new Error("randomChoice called with empty array");return i[Qt(0,i.length-1)]}function ki(i,e){let n=0;for(const[t,s]of i)if(s.enabled&&t!==e){const a=Je(s.properties.theme);a&&(n+=Ti[a.brightness])}return n}function Ei(i){return ot.filter(e=>i.includes(e.brightness))}function Si(i,e){const n={};for(const[a,r]of i)if(r.enabled&&a!==e){const o=Je(r.properties.theme);o&&(n[o.family]=(n[o.family]||0)+1)}let t=0,s=null;for(const[a,r]of Object.entries(n))r>t&&(t=r,s=a);return s}function Mi(i,e){const n=ki(i,e),t=Si(i,e);let s;n>=gt?s=["dark"]:n>=gt-.5?s=["dark","medium"]:s=["dark","medium","bright"];const a=Ei(s);if(a.length===0)return 0;if(t&&Math.random()<.5){const r=wi[t],o=a.filter(l=>r.includes(l.id));if(o.length>0)return it(o).id}if(Math.random()<.3){const r=new Set;for(const[o,l]of i)if(l.enabled&&o!==e){const c=Je(l.properties.theme);c&&r.add(c.temperature)}if(r.size===1){const o=[...r][0];let l=null;if(o==="warm"?l="cool":o==="cool"&&(l="warm"),l){const c=a.filter(u=>u.temperature===l);if(c.length>0)return it(c).id}}}return it(a).id}function Li(i){const e=Je(i);if(!e)return{min:.3,max:.7};switch(e.brightness){case"dark":return{min:.5,max:.9};case"medium":return{min:.3,max:.7};case"bright":return{min:.2,max:.5}}}function Bi(i){const e=xe(de);if(!e.randomizerEnabled)return;const n=xe(vt),t=performance.now()/1e3;if(t-n.lastChangeTime<e.randomizerCooldown||i<.6)return;const s=xe(Re),a=He.filter(l=>{const c=s.get(l.id);return l.randomizable!==!1&&(c?.includeInRandomizer||c?.includeInStrobe)});if(a.length===0)return;const r=a[Qt(0,a.length-1)];s.get(r.id)&&(Re.update(l=>{const c=l.get(r.id);if(!c)return l;if(e.randomizerTogglesLayers&&c.includeInStrobe&&Math.random()<e.randomizerToggleChance&&(c.enabled=!c.enabled),c.enabled&&c.includeInRandomizer){const u=Mi(l,r.id);c.properties.theme=u;const f=Li(u);c.properties.intensity=tt(f.min,f.max),c.properties.zoom=tt(.7,2.5),c.properties.sensitivity=tt(.5,1.5)}return l}),vt.update(l=>({...l,lastChangeTime:t})))}const Ii={position:{x:.5,y:.5},velocity:{x:0,y:0},speed:0,isDown:!1,clickPosition:{x:.5,y:.5},isInside:!1},We=Ae(Ii),bt=.15,Pi=.1;let Xe={x:0,y:0},nt=0;function Ne(i,e,n){return Math.min(Math.max(i,e),n)}const Di=lt(We,i=>(Xe.x+=(i.velocity.x-Xe.x)*bt,Xe.y+=(i.velocity.y-Xe.y)*bt,nt+=(i.speed-nt)*Pi,{x:i.position.x,y:i.position.y,velocityX:Ne(Xe.x,-1,1),velocityY:Ne(Xe.y,-1,1),speed:Ne(nt,0,1),down:i.isDown?1:0,clickX:i.clickPosition.x,clickY:i.clickPosition.y,inside:i.isInside?1:0}));function Ci(i,e,n,t){We.update(s=>{const a=Ne((i-n.left)/n.width,0,1),r=Ne((e-n.top)/n.height,0,1),o=Math.max(t,1),l=(a-s.position.x)/o*16.67,c=(r-s.position.y)/o*16.67,u=Math.sqrt(l*l+c*c);return{...s,position:{x:a,y:r},velocity:{x:l,y:c},speed:Ne(u*10,0,1),isInside:!0}})}function Ri(i,e,n){We.update(t=>{const s=Ne((i-n.left)/n.width,0,1),a=Ne((e-n.top)/n.height,0,1);return{...t,isDown:!0,clickPosition:{x:s,y:a}}})}function Ai(){We.update(i=>({...i,isDown:!1}))}function Fi(){We.update(i=>({...i,isInside:!1,velocity:{x:0,y:0},speed:0}))}const Ui={fps:0,frameTime:0,targetFps:60,cpuSavings:0,mode:"normal"},Jt=Ae(Ui);function Vi(i){let e,n,t;return{c(){e=y("canvas"),this.h()},l(s){e=_(s,"CANVAS",{class:!0,"aria-label":!0}),I(e).forEach(p),this.h()},h(){m(e,"class","visualizer-canvas svelte-1nin8xa"),m(e,"aria-label","Audio reactive canvas")},m(s,a){V(s,e,a),i[9](e),n||(t=[ne(e,"click",i[1]),ne(e,"touchend",i[2]),ne(e,"mousemove",i[3]),ne(e,"mousedown",i[4]),ne(e,"mouseup",i[5]),ne(e,"mouseleave",i[6])],n=!0)},p:ge,i:ge,o:ge,d(s){s&&p(e),i[9](null),n=!1,$e(t)}}}const zi=500,Ni=100,Qe=32;function $i(i,e,n){let t,s,a,r,o;we(i,de,k=>n(22,t=k)),we(i,pi,k=>n(23,s=k)),we(i,Di,k=>n(24,a=k)),we(i,rt,k=>n(25,r=k)),we(i,be,k=>n(26,o=k));let l,c=null,u=null,f,g=0,w=0,v=0,M=0,S=0,C=null,P=null,d=null;function E(){C=document.createElement("canvas"),C.width=Qe,C.height=Qe,P=C.getContext("2d"),d=document.querySelector('link[rel="icon"]'),d||(d=document.createElement("link"),d.rel="icon",d.type="image/png",document.head.appendChild(d))}function b(k){if(!C||!P||!d||!l||k-v<Ni)return;v=k;const q=Math.min(l.width,l.height),Q=(l.width-q)/2,j=(l.height-q)/2;P.drawImage(l,Q,j,q,q,0,0,Qe,Qe);try{d.href=C.toDataURL("image/png")}catch{}}async function X(){u||(u=new ri);const k=await u.init();return at.set(k),k}function F(){u&&(u.dispose(),u=null),at.set(!1)}function T(k){const q=1e3/t.targetFps;if(t.powerSaverEnabled){const j=k-g;if(j<q){f=window.setTimeout(()=>requestAnimationFrame(T),q-j);return}}t.powerSaverEnabled?f=window.setTimeout(()=>requestAnimationFrame(T),q):f=requestAnimationFrame(T);const Q=(k-g)/1e3;if(g=k,u?.isInitialized()){const j=u.update(Q);Wt.set(j);const J=o.beatGate,pe=j.beat>J;Kt.update(Se=>{if(o.autoEnabled){if(pe)return 1;const ce=.5+o.autoDecay*3.5;return Math.max(0,Se-Q*ce)}return 0}),Bi(j.beat)}if(c?.isInitialized()&&(c.render(k/1e3,r,a,s),b(k)),M++,k-S>=zi){const j=(k-S)/1e3,J=Math.round(M/j),pe=t.targetFps,Se=j*1e3/M,ce=t.powerSaverEnabled?Math.round((1-pe/60)*100):0;Jt.set({fps:J,frameTime:Se,targetFps:pe,cpuSavings:Math.max(0,ce),mode:t.powerSaverEnabled?"power-saver":"normal"}),M=0,S=k}}qt(async()=>{if(c=new ai(l),await c.init()){const q=performance.now();g=q,S=q,E(),f=requestAnimationFrame(T)}}),ti(()=>{f&&(cancelAnimationFrame(f),clearTimeout(f)),c&&c.dispose(),u&&u.dispose()});function z(){de.update(k=>({...k,panelsVisible:!k.panelsVisible}))}let D=0;function $(k){const q=Date.now();q-D<300&&N(),D=q}async function N(){document.fullscreenElement?(await document.exitFullscreen(),de.update(k=>({...k,fullscreen:!1}))):(await document.documentElement.requestFullscreen(),de.update(k=>({...k,fullscreen:!0})))}function H(k){if(!l)return;const q=performance.now(),Q=q-w;w=q;const j=l.getBoundingClientRect();Ci(k.clientX,k.clientY,j,Q)}function Z(k){if(!l)return;const q=l.getBoundingClientRect();Ri(k.clientX,k.clientY,q)}function K(){Ai()}function U(){Fi()}function L(k){ve[k?"unshift":"push"](()=>{l=k,n(0,l)})}return[l,z,$,H,Z,K,U,X,F,L]}class Oi extends Be{constructor(e){super(),Ie(this,e,$i,Vi,Le,{enableMicrophone:7,disableMicrophone:8})}get enableMicrophone(){return this.$$.ctx[7]}get disableMicrophone(){return this.$$.ctx[8]}}function _t(i){let e,n=i[6](i[0])+"",t;return{c(){e=y("span"),t=ae(n),this.h()},l(s){e=_(s,"SPAN",{class:!0});var a=I(e);t=se(a,n),a.forEach(p),this.h()},h(){m(e,"class","slider-value svelte-13dvwfr")},m(s,a){V(s,e,a),h(e,t)},p(s,a){a&65&&n!==(n=s[6](s[0])+"")&&me(t,n)},d(s){s&&p(e)}}}function qi(i){let e,n,t,s,a,r,o,l,c,u=i[5]&&_t(i);return{c(){e=y("div"),n=y("div"),t=y("span"),s=ae(i[1]),a=A(),u&&u.c(),r=A(),o=y("input"),this.h()},l(f){e=_(f,"DIV",{class:!0});var g=I(e);n=_(g,"DIV",{class:!0});var w=I(n);t=_(w,"SPAN",{class:!0});var v=I(t);s=se(v,i[1]),v.forEach(p),a=R(w),u&&u.l(w),w.forEach(p),r=R(g),o=_(g,"INPUT",{type:!0,min:!0,max:!0,step:!0,"aria-label":!0,class:!0}),g.forEach(p),this.h()},h(){m(t,"class","slider-label svelte-13dvwfr"),m(n,"class","slider-header svelte-13dvwfr"),m(o,"type","range"),m(o,"min",i[2]),m(o,"max",i[3]),m(o,"step",i[4]),o.value=i[0],m(o,"aria-label",i[1]),m(o,"class","svelte-13dvwfr"),m(e,"class","slider svelte-13dvwfr"),Y(e,"compact",i[7])},m(f,g){V(f,e,g),h(e,n),h(n,t),h(t,s),h(n,a),u&&u.m(n,null),h(e,r),h(e,o),l||(c=ne(o,"input",i[8]),l=!0)},p(f,[g]){g&2&&me(s,f[1]),f[5]?u?u.p(f,g):(u=_t(f),u.c(),u.m(n,null)):u&&(u.d(1),u=null),g&4&&m(o,"min",f[2]),g&8&&m(o,"max",f[3]),g&16&&m(o,"step",f[4]),g&1&&(o.value=f[0]),g&2&&m(o,"aria-label",f[1]),g&128&&Y(e,"compact",f[7])},i:ge,o:ge,d(f){f&&p(e),u&&u.d(),l=!1,c()}}}function Hi(i,e,n){let{label:t}=e,{value:s}=e,{min:a=0}=e,{max:r=1}=e,{step:o=.01}=e,{showValue:l=!0}=e,{formatValue:c=w=>w.toFixed(2)}=e,{compact:u=!0}=e;const f=Ht();function g(w){const v=w.target;n(0,s=parseFloat(v.value)),f("input",s)}return i.$$set=w=>{"label"in w&&n(1,t=w.label),"value"in w&&n(0,s=w.value),"min"in w&&n(2,a=w.min),"max"in w&&n(3,r=w.max),"step"in w&&n(4,o=w.step),"showValue"in w&&n(5,l=w.showValue),"formatValue"in w&&n(6,c=w.formatValue),"compact"in w&&n(7,u=w.compact)},[s,t,a,r,o,l,c,u,g]}class Ee extends Be{constructor(e){super(),Ie(this,e,Hi,qi,Le,{label:1,value:0,min:2,max:3,step:4,showValue:5,formatValue:6,compact:7})}}function Gi(i){let e,n,t,s,a,r,o;return{c(){e=y("button"),n=y("span"),t=A(),s=y("span"),a=ae(i[1]),this.h()},l(l){e=_(l,"BUTTON",{class:!0,"aria-pressed":!0,type:!0});var c=I(e);n=_(c,"SPAN",{class:!0}),I(n).forEach(p),t=R(c),s=_(c,"SPAN",{class:!0});var u=I(s);a=se(u,i[1]),u.forEach(p),c.forEach(p),this.h()},h(){m(n,"class","toggle-indicator svelte-1qxicao"),m(s,"class","toggle-label svelte-1qxicao"),m(e,"class","toggle svelte-1qxicao"),m(e,"aria-pressed",i[0]),e.disabled=i[2],m(e,"type","button"),Y(e,"checked",i[0]),Y(e,"disabled",i[2]),Y(e,"compact",i[3])},m(l,c){V(l,e,c),h(e,n),h(e,t),h(e,s),h(s,a),r||(o=ne(e,"click",i[4]),r=!0)},p(l,[c]){c&2&&me(a,l[1]),c&1&&m(e,"aria-pressed",l[0]),c&4&&(e.disabled=l[2]),c&1&&Y(e,"checked",l[0]),c&4&&Y(e,"disabled",l[2]),c&8&&Y(e,"compact",l[3])},i:ge,o:ge,d(l){l&&p(e),r=!1,o()}}}function Xi(i,e,n){let{label:t}=e,{checked:s=!1}=e,{disabled:a=!1}=e,{compact:r=!0}=e;function o(){a||n(0,s=!s)}return i.$$set=l=>{"label"in l&&n(1,t=l.label),"checked"in l&&n(0,s=l.checked),"disabled"in l&&n(2,a=l.disabled),"compact"in l&&n(3,r=l.compact)},[s,t,a,r,o]}class xt extends Be{constructor(e){super(),Ie(this,e,Xi,Gi,Le,{label:1,checked:0,disabled:2,compact:3})}}function yt(i,e,n){const t=i.slice();return t[8]=e[n],t}function wt(i){let e;return{c(){e=y("span"),this.h()},l(n){e=_(n,"SPAN",{class:!0,style:!0}),I(e).forEach(p),this.h()},h(){m(e,"class","select-preview svelte-1weciec"),Ze(e,"background",i[2].find(i[6])?.preview)},m(n,t){V(n,e,t)},p(n,t){t&5&&Ze(e,"background",n[2].find(n[6])?.preview)},d(n){n&&p(e)}}}function Tt(i){let e,n=i[8].label+"",t,s;return{c(){e=y("option"),t=ae(n),this.h()},l(a){e=_(a,"OPTION",{});var r=I(e);t=se(r,n),r.forEach(p),this.h()},h(){e.__value=s=i[8].value,ct(e,e.__value)},m(a,r){V(a,e,r),h(e,t)},p(a,r){r&4&&n!==(n=a[8].label+"")&&me(t,n),r&4&&s!==(s=a[8].value)&&(e.__value=s,ct(e,e.__value))},d(a){a&&p(e)}}}function ji(i){let e,n,t,s,a,r=i[2].find(i[5])?.preview,o,l,c,u,f=r&&wt(i),g=Ye(i[2]),w=[];for(let v=0;v<g.length;v+=1)w[v]=Tt(yt(i,g,v));return{c(){e=y("div"),n=y("span"),t=ae(i[1]),s=A(),a=y("div"),f&&f.c(),o=A(),l=y("select");for(let v=0;v<w.length;v+=1)w[v].c();this.h()},l(v){e=_(v,"DIV",{class:!0});var M=I(e);n=_(M,"SPAN",{class:!0});var S=I(n);t=se(S,i[1]),S.forEach(p),s=R(M),a=_(M,"DIV",{class:!0});var C=I(a);f&&f.l(C),o=R(C),l=_(C,"SELECT",{"aria-label":!0,class:!0});var P=I(l);for(let d=0;d<w.length;d+=1)w[d].l(P);P.forEach(p),C.forEach(p),M.forEach(p),this.h()},h(){m(n,"class","select-label svelte-1weciec"),m(l,"aria-label",i[1]),m(l,"class","svelte-1weciec"),m(a,"class","select-container svelte-1weciec"),m(e,"class","select-wrapper svelte-1weciec"),Y(e,"compact",i[3])},m(v,M){V(v,e,M),h(e,n),h(n,t),h(e,s),h(e,a),f&&f.m(a,null),h(a,o),h(a,l);for(let S=0;S<w.length;S+=1)w[S]&&w[S].m(l,null);ft(l,i[0]),c||(u=ne(l,"change",i[4]),c=!0)},p(v,[M]){if(M&2&&me(t,v[1]),M&5&&(r=v[2].find(v[5])?.preview),r?f?f.p(v,M):(f=wt(v),f.c(),f.m(a,o)):f&&(f.d(1),f=null),M&4){g=Ye(v[2]);let S;for(S=0;S<g.length;S+=1){const C=yt(v,g,S);w[S]?w[S].p(C,M):(w[S]=Tt(C),w[S].c(),w[S].m(l,null))}for(;S<w.length;S+=1)w[S].d(1);w.length=g.length}M&5&&ft(l,v[0]),M&2&&m(l,"aria-label",v[1]),M&8&&Y(e,"compact",v[3])},i:ge,o:ge,d(v){v&&p(e),f&&f.d(),ii(w,v),c=!1,u()}}}function Zi(i,e,n){let{label:t}=e,{value:s}=e,{options:a=[]}=e,{compact:r=!0}=e;const o=Ht();function l(f){const g=f.target;n(0,s=isNaN(Number(g.value))?g.value:Number(g.value)),o("change",s)}const c=f=>f.value===s,u=f=>f.value===s;return i.$$set=f=>{"label"in f&&n(1,t=f.label),"value"in f&&n(0,s=f.value),"options"in f&&n(2,a=f.options),"compact"in f&&n(3,r=f.compact)},[s,t,a,r,l,c,u]}class ei extends Be{constructor(e){super(),Ie(this,e,Zi,ji,Le,{label:1,value:0,options:2,compact:3})}}function Yi(i){let e,n,t,s,a,r,o,l,c;return{c(){e=y("div"),n=y("span"),t=ae(i[0]),s=A(),a=y("div"),r=y("div"),o=A(),l=y("span"),c=ae(i[1]),this.h()},l(u){e=_(u,"DIV",{class:!0});var f=I(e);n=_(f,"SPAN",{class:!0});var g=I(n);t=se(g,i[0]),g.forEach(p),s=R(f),a=_(f,"DIV",{class:!0});var w=I(a);r=_(w,"DIV",{class:!0,style:!0}),I(r).forEach(p),w.forEach(p),o=R(f),l=_(f,"SPAN",{class:!0});var v=I(l);c=se(v,i[1]),v.forEach(p),f.forEach(p),this.h()},h(){m(n,"class","level-label svelte-2vktfp"),m(r,"class","level-fill svelte-2vktfp"),Ze(r,"width",i[2]+"%"),m(a,"class","level-bar svelte-2vktfp"),m(l,"class","level-value svelte-2vktfp"),m(e,"class","level-meter svelte-2vktfp")},m(u,f){V(u,e,f),h(e,n),h(n,t),h(e,s),h(e,a),h(a,r),h(e,o),h(e,l),h(l,c)},p(u,[f]){f&1&&me(t,u[0]),f&4&&Ze(r,"width",u[2]+"%"),f&2&&me(c,u[1])},i:ge,o:ge,d(u){u&&p(e)}}}function Wi(i,e,n){let t,s,{label:a}=e,{value:r=0}=e,{max:o=1}=e;return i.$$set=l=>{"label"in l&&n(0,a=l.label),"value"in l&&n(3,r=l.value),"max"in l&&n(4,o=l.max)},i.$$.update=()=>{i.$$.dirty&24&&n(2,t=Math.min(100,r/o*100)),i.$$.dirty&8&&n(1,s=r.toFixed(2))},[a,s,t,r,o]}class je extends Be{constructor(e){super(),Ie(this,e,Wi,Yi,Le,{label:0,value:3,max:4})}}function kt(i){let e,n,t='<span class="panel-title svelte-60ik2m">CONTROLS</span>',s,a,r,o,l,c,u,f,g='<span class="label">FULLSCR</span>',w,v,M='<span class="label">PWR SAV</span>',S,C,P='<span class="label">README</span>',d,E,b='<kbd class="svelte-60ik2m">C</kbd> panels <kbd class="svelte-60ik2m">F</kbd> fullscreen <kbd class="svelte-60ik2m">?</kbd> help',X,F;function T($,N){return $[2]?Ji:$[3]?Qi:Ki}let z=T(i),D=z(i);return{c(){e=y("div"),n=y("div"),n.innerHTML=t,s=A(),a=y("div"),r=y("button"),o=y("span"),l=A(),c=y("span"),D.c(),u=A(),f=y("button"),f.innerHTML=g,w=A(),v=y("button"),v.innerHTML=M,S=A(),C=y("button"),C.innerHTML=P,d=A(),E=y("div"),E.innerHTML=b,this.h()},l($){e=_($,"DIV",{class:!0});var N=I(e);n=_(N,"DIV",{class:!0,"data-svelte-h":!0}),re(n)!=="svelte-i65zl2"&&(n.innerHTML=t),s=R(N),a=_(N,"DIV",{class:!0});var H=I(a);r=_(H,"BUTTON",{class:!0,title:!0});var Z=I(r);o=_(Z,"SPAN",{class:!0}),I(o).forEach(p),l=R(Z),c=_(Z,"SPAN",{class:!0});var K=I(c);D.l(K),K.forEach(p),Z.forEach(p),u=R(H),f=_(H,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),re(f)!=="svelte-1xg66l0"&&(f.innerHTML=g),w=R(H),v=_(H,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),re(v)!=="svelte-e1kxas"&&(v.innerHTML=M),S=R(H),C=_(H,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),re(C)!=="svelte-c7hw7k"&&(C.innerHTML=P),H.forEach(p),d=R(N),E=_(N,"DIV",{class:!0,title:!0,"data-svelte-h":!0}),re(E)!=="svelte-1ll3wf0"&&(E.innerHTML=b),N.forEach(p),this.h()},h(){m(n,"class","panel-header svelte-60ik2m"),m(o,"class","indicator svelte-60ik2m"),Y(o,"on",i[3]),m(c,"class","label"),m(r,"class","ctrl-btn mic svelte-60ik2m"),r.disabled=i[2],m(r,"title","Enable microphone to let visuals react to music and sounds around you"),Y(r,"active",i[3]),Y(r,"loading",i[2]),m(f,"class","ctrl-btn svelte-60ik2m"),m(f,"title","Enter or exit fullscreen mode for an immersive experience"),Y(f,"active",i[4].fullscreen),m(v,"class","ctrl-btn svelte-60ik2m"),m(v,"title","Reduce frame rate to save battery and CPU on laptops"),Y(v,"active",i[4].powerSaverEnabled),m(C,"class","ctrl-btn svelte-60ik2m"),m(C,"title","Show help and information (press ?)"),m(a,"class","controls-grid svelte-60ik2m"),m(E,"class","panel-footer svelte-60ik2m"),m(E,"title","Keyboard shortcuts for quick access"),m(e,"class","panel controls-panel svelte-60ik2m")},m($,N){V($,e,N),h(e,n),h(e,s),h(e,a),h(a,r),h(r,o),h(r,l),h(r,c),D.m(c,null),h(a,u),h(a,f),h(a,w),h(a,v),h(a,S),h(a,C),h(e,d),h(e,E),X||(F=[ne(r,"click",i[5]),ne(f,"click",i[6]),ne(v,"click",bi),ne(C,"click",function(){ni(i[0])&&i[0].apply(this,arguments)})],X=!0)},p($,N){i=$,N&8&&Y(o,"on",i[3]),z!==(z=T(i))&&(D.d(1),D=z(i),D&&(D.c(),D.m(c,null))),N&4&&(r.disabled=i[2]),N&8&&Y(r,"active",i[3]),N&4&&Y(r,"loading",i[2]),N&16&&Y(f,"active",i[4].fullscreen),N&16&&Y(v,"active",i[4].powerSaverEnabled)},d($){$&&p(e),D.d(),X=!1,$e(F)}}}function Ki(i){let e;return{c(){e=ae("MIC OFF")},l(n){e=se(n,"MIC OFF")},m(n,t){V(n,e,t)},d(n){n&&p(e)}}}function Qi(i){let e;return{c(){e=ae("MIC ON")},l(n){e=se(n,"MIC ON")},m(n,t){V(n,e,t)},d(n){n&&p(e)}}}function Ji(i){let e;return{c(){e=ae("...")},l(n){e=se(n,"...")},m(n,t){V(n,e,t)},d(n){n&&p(e)}}}function xi(i){let e,n=i[1]&&kt(i);return{c(){n&&n.c(),e=he()},l(t){n&&n.l(t),e=he()},m(t,s){n&&n.m(t,s),V(t,e,s)},p(t,[s]){t[1]?n?n.p(t,s):(n=kt(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:ge,o:ge,d(t){t&&p(e),n&&n.d(t)}}}function en(i,e,n){let t,s;we(i,at,f=>n(3,t=f)),we(i,de,f=>n(4,s=f));let{onEnableMic:a}=e,{onShowInfo:r}=e,{visible:o=!0}=e,l=!1;async function c(){t||(n(2,l=!0),await a(),n(2,l=!1))}async function u(){document.fullscreenElement?(await document.exitFullscreen(),de.update(f=>({...f,fullscreen:!1}))):(await document.documentElement.requestFullscreen(),de.update(f=>({...f,fullscreen:!0})))}return i.$$set=f=>{"onEnableMic"in f&&n(7,a=f.onEnableMic),"onShowInfo"in f&&n(0,r=f.onShowInfo),"visible"in f&&n(1,o=f.visible)},[r,o,l,t,s,c,u,a]}class tn extends Be{constructor(e){super(),Ie(this,e,en,xi,Le,{onEnableMic:7,onShowInfo:0,visible:1})}}function Et(i,e,n){const t=i.slice();return t[16]=e[n].definition,t[17]=e[n].state,t}function St(i,e,n){const t=i.slice();return t[20]=e[n],t}function Mt(i){let e,n,t,s,a,r,o,l="LAYERS",c,u,f=i[1].filter(Dt).length+"",g,w,v=i[1].length+"",M,S,C,P,d="RANDOM",E,b,X="STROBE",F,T,z=[],D=new Map,$,N,H,Z=Ye(i[1]);const K=U=>U[16].id;for(let U=0;U<Z.length;U+=1){let L=Et(i,Z,U),k=K(L);D.set(k,z[U]=Pt(k,L))}return{c(){e=y("div"),n=y("div"),t=y("button"),s=y("span"),r=A(),o=y("span"),o.textContent=l,c=A(),u=y("span"),g=ae(f),w=ae("/"),M=ae(v),S=A(),C=y("div"),P=y("button"),P.textContent=d,E=A(),b=y("button"),b.textContent=X,F=A(),T=y("div");for(let U=0;U<z.length;U+=1)z[U].c();this.h()},l(U){e=_(U,"DIV",{class:!0});var L=I(e);n=_(L,"DIV",{class:!0});var k=I(n);t=_(k,"BUTTON",{class:!0,title:!0,type:!0});var q=I(t);s=_(q,"SPAN",{class:!0}),I(s).forEach(p),q.forEach(p),r=R(k),o=_(k,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),re(o)!=="svelte-1k3t9ew"&&(o.textContent=l),c=R(k),u=_(k,"SPAN",{class:!0,title:!0});var Q=I(u);g=se(Q,f),w=se(Q,"/"),M=se(Q,v),Q.forEach(p),k.forEach(p),S=R(L),C=_(L,"DIV",{class:!0});var j=I(C);P=_(j,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),re(P)!=="svelte-oljq6x"&&(P.textContent=d),E=R(j),b=_(j,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),re(b)!=="svelte-1j3wa1w"&&(b.textContent=X),j.forEach(p),F=R(L),T=_(L,"DIV",{class:!0});var J=I(T);for(let pe=0;pe<z.length;pe+=1)z[pe].l(J);J.forEach(p),L.forEach(p),this.h()},h(){m(s,"class","master-indicator svelte-19n2guw"),m(t,"class","master-toggle svelte-19n2guw"),m(t,"title",a=i[3]?"Turn off all layers":"Turn on all layers"),m(t,"type","button"),Y(t,"active",i[3]),m(o,"class","panel-title svelte-19n2guw"),m(o,"title","Visual effect layers - toggle and customize each one"),m(u,"class","panel-count svelte-19n2guw"),m(u,"title","Number of active layers"),m(n,"class","panel-header svelte-19n2guw"),m(P,"class","global-btn svelte-19n2guw"),m(P,"title","Automatically change visual settings on every beat for variety"),m(P,"type","button"),Y(P,"active",i[4].randomizerEnabled),m(b,"class","global-btn strobe svelte-19n2guw"),m(b,"title","Flash layers on/off with the beat for a strobe-like effect"),m(b,"type","button"),Y(b,"active",i[4].randomizerTogglesLayers),m(C,"class","global-controls svelte-19n2guw"),m(T,"class","layer-list svelte-19n2guw"),m(e,"class","panel layers-panel svelte-19n2guw")},m(U,L){V(U,e,L),h(e,n),h(n,t),h(t,s),h(n,r),h(n,o),h(n,c),h(n,u),h(u,g),h(u,w),h(u,M),h(e,S),h(e,C),h(C,P),h(C,E),h(C,b),h(e,F),h(e,T);for(let k=0;k<z.length;k+=1)z[k]&&z[k].m(T,null);$=!0,N||(H=[ne(t,"click",i[5]),ne(P,"click",_i),ne(b,"click",yi)],N=!0)},p(U,L){(!$||L&8&&a!==(a=U[3]?"Turn off all layers":"Turn on all layers"))&&m(t,"title",a),(!$||L&8)&&Y(t,"active",U[3]),(!$||L&2)&&f!==(f=U[1].filter(Dt).length+"")&&me(g,f),(!$||L&2)&&v!==(v=U[1].length+"")&&me(M,v),(!$||L&16)&&Y(P,"active",U[4].randomizerEnabled),(!$||L&16)&&Y(b,"active",U[4].randomizerTogglesLayers),L&198&&(Z=Ye(U[1]),Pe(),z=jt(z,L,K,1,U,Z,D,T,Xt,Pt,null,Et),De())},i(U){if(!$){for(let L=0;L<Z.length;L+=1)O(z[L]);$=!0}},o(U){for(let L=0;L<z.length;L+=1)G(z[L]);$=!1},d(U){U&&p(e);for(let L=0;L<z.length;L+=1)z[L].d();N=!1,$e(H)}}}function Lt(i){let e,n="R",t,s,a="S",r,o;function l(){return i[11](i[16])}function c(){return i[12](i[16])}return{c(){e=y("button"),e.textContent=n,t=A(),s=y("button"),s.textContent=a,this.h()},l(u){e=_(u,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),re(e)!=="svelte-mwgvpg"&&(e.textContent=n),t=R(u),s=_(u,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),re(s)!=="svelte-v7hsdo"&&(s.textContent=a),this.h()},h(){m(e,"class","quick-btn svelte-19n2guw"),m(e,"title","Include in randomizer - properties (theme, intensity, zoom) will change automatically"),m(e,"type","button"),Y(e,"active",i[17].includeInRandomizer),m(s,"class","quick-btn strobe-btn svelte-19n2guw"),m(s,"title","Include in strobe - layer can flash on/off with the beat"),m(s,"type","button"),Y(s,"active",i[17].includeInStrobe)},m(u,f){V(u,e,f),V(u,t,f),V(u,s,f),r||(o=[ne(e,"click",l),ne(s,"click",c)],r=!0)},p(u,f){i=u,f&2&&Y(e,"active",i[17].includeInRandomizer),f&2&&Y(s,"active",i[17].includeInStrobe)},d(u){u&&(p(e),p(t),p(s)),r=!1,$e(o)}}}function Bt(i){let e,n=[],t=new Map,s,a=Ye(i[16].properties);const r=o=>o[20].id;for(let o=0;o<a.length;o+=1){let l=St(i,a,o),c=r(l);t.set(c,n[o]=It(c,l))}return{c(){e=y("div");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=_(o,"DIV",{class:!0});var l=I(e);for(let c=0;c<n.length;c+=1)n[c].l(l);l.forEach(p),this.h()},h(){m(e,"class","layer-controls svelte-19n2guw")},m(o,l){V(o,e,l);for(let c=0;c<n.length;c+=1)n[c]&&n[c].m(e,null);s=!0},p(o,l){l&66&&(a=Ye(o[16].properties),Pe(),n=jt(n,l,r,1,o,a,t,e,Xt,It,null,St),De())},i(o){if(!s){for(let l=0;l<a.length;l+=1)O(n[l]);s=!0}},o(o){for(let l=0;l<n.length;l+=1)G(n[l]);s=!1},d(o){o&&p(e);for(let l=0;l<n.length;l+=1)n[l].d()}}}function nn(i){let e,n,t,s;function a(...r){return i[15](i[16],i[20],...r)}return n=new ei({props:{label:"Thm",value:i[17].properties[i[20].id]??i[20].default,options:i[6]}}),n.$on("change",a),{c(){e=y("div"),ie(n.$$.fragment),t=A(),this.h()},l(r){e=_(r,"DIV",{title:!0});var o=I(e);te(n.$$.fragment,o),t=R(o),o.forEach(p),this.h()},h(){m(e,"title","Color scheme for this visual effect")},m(r,o){V(r,e,o),ee(n,e,null),h(e,t),s=!0},p(r,o){i=r;const l={};o&2&&(l.value=i[17].properties[i[20].id]??i[20].default),n.$set(l)},i(r){s||(O(n.$$.fragment,r),s=!0)},o(r){G(n.$$.fragment,r),s=!1},d(r){r&&p(e),x(n)}}}function sn(i){let e,n,t,s,a;function r(...o){return i[14](i[16],i[20],...o)}return n=new Ee({props:{label:i[20].label.slice(0,4),value:i[17].properties[i[20].id]??i[20].default,min:i[20].min??0,max:i[20].max??1,step:i[20].step??.01}}),n.$on("input",r),{c(){e=y("div"),ie(n.$$.fragment),t=A(),this.h()},l(o){e=_(o,"DIV",{title:!0});var l=I(e);te(n.$$.fragment,l),t=R(l),l.forEach(p),this.h()},h(){m(e,"title",s=i[20].id==="intensity"?"How visible/strong this effect is":i[20].id==="zoom"?"Scale/size of the effect pattern":i[20].id==="sensitivity"?"How much this layer reacts to audio":i[20].label)},m(o,l){V(o,e,l),ee(n,e,null),h(e,t),a=!0},p(o,l){i=o;const c={};l&2&&(c.label=i[20].label.slice(0,4)),l&2&&(c.value=i[17].properties[i[20].id]??i[20].default),l&2&&(c.min=i[20].min??0),l&2&&(c.max=i[20].max??1),l&2&&(c.step=i[20].step??.01),n.$set(c),(!a||l&2&&s!==(s=i[20].id==="intensity"?"How visible/strong this effect is":i[20].id==="zoom"?"Scale/size of the effect pattern":i[20].id==="sensitivity"?"How much this layer reacts to audio":i[20].label))&&m(e,"title",s)},i(o){a||(O(n.$$.fragment,o),a=!0)},o(o){G(n.$$.fragment,o),a=!1},d(o){o&&p(e),x(n)}}}function It(i,e){let n,t,s,a,r;const o=[sn,nn],l=[];function c(u,f){return u[20].type==="range"?0:u[20].type==="select"&&u[20].id==="theme"?1:-1}return~(t=c(e))&&(s=l[t]=o[t](e)),{key:i,first:null,c(){n=he(),s&&s.c(),a=he(),this.h()},l(u){n=he(),s&&s.l(u),a=he(),this.h()},h(){this.first=n},m(u,f){V(u,n,f),~t&&l[t].m(u,f),V(u,a,f),r=!0},p(u,f){e=u;let g=t;t=c(e),t===g?~t&&l[t].p(e,f):(s&&(Pe(),G(l[g],1,1,()=>{l[g]=null}),De()),~t?(s=l[t],s?s.p(e,f):(s=l[t]=o[t](e),s.c()),O(s,1),s.m(a.parentNode,a)):s=null)},i(u){r||(O(s),r=!0)},o(u){G(s),r=!1},d(u){u&&(p(n),p(a)),~t&&l[t].d(u)}}}function Pt(i,e){let n,t,s,a,r,o,l=e[16].label+"",c,u,f,g,w,v,M=e[2]===e[16].id?"":"+",S,C,P,d,E,b;function X(){return e[9](e[16])}function F(){return e[10](e[16])}let T=e[16].randomizable!==!1&&Lt(e);function z(){return e[13](e[16])}let D=e[2]===e[16].id&&Bt(e);return{key:i,first:null,c(){n=y("div"),t=y("div"),s=y("button"),a=y("span"),r=A(),o=y("button"),c=ae(l),f=A(),g=y("div"),T&&T.c(),w=A(),v=y("button"),S=ae(M),C=A(),D&&D.c(),P=A(),this.h()},l($){n=_($,"DIV",{class:!0});var N=I(n);t=_(N,"DIV",{class:!0});var H=I(t);s=_(H,"BUTTON",{class:!0,type:!0,title:!0});var Z=I(s);a=_(Z,"SPAN",{class:!0}),I(a).forEach(p),Z.forEach(p),r=R(H),o=_(H,"BUTTON",{class:!0,type:!0,title:!0});var K=I(o);c=se(K,l),K.forEach(p),f=R(H),g=_(H,"DIV",{class:!0});var U=I(g);T&&T.l(U),w=R(U),v=_(U,"BUTTON",{class:!0,type:!0,title:!0});var L=I(v);S=se(L,M),L.forEach(p),U.forEach(p),H.forEach(p),C=R(N),D&&D.l(N),P=R(N),N.forEach(p),this.h()},h(){m(a,"class","indicator svelte-19n2guw"),Y(a,"active",e[17].enabled),m(s,"class","layer-toggle svelte-19n2guw"),m(s,"type","button"),m(s,"title","Turn this visual effect on or off"),m(o,"class","layer-name svelte-19n2guw"),m(o,"type","button"),m(o,"title",u=e[16].description+" - click to adjust settings"),m(v,"class","quick-btn expand-btn svelte-19n2guw"),m(v,"type","button"),m(v,"title","Expand to see detailed controls for this layer"),m(g,"class","layer-quick svelte-19n2guw"),m(t,"class","layer-row svelte-19n2guw"),m(n,"class","layer-item svelte-19n2guw"),Y(n,"disabled",!e[17].enabled),Y(n,"expanded",e[2]===e[16].id),this.first=n},m($,N){V($,n,N),h(n,t),h(t,s),h(s,a),h(t,r),h(t,o),h(o,c),h(t,f),h(t,g),T&&T.m(g,null),h(g,w),h(g,v),h(v,S),h(n,C),D&&D.m(n,null),h(n,P),d=!0,E||(b=[ne(s,"click",X),ne(o,"click",F),ne(v,"click",z)],E=!0)},p($,N){e=$,(!d||N&2)&&Y(a,"active",e[17].enabled),(!d||N&2)&&l!==(l=e[16].label+"")&&me(c,l),(!d||N&2&&u!==(u=e[16].description+" - click to adjust settings"))&&m(o,"title",u),e[16].randomizable!==!1?T?T.p(e,N):(T=Lt(e),T.c(),T.m(g,w)):T&&(T.d(1),T=null),(!d||N&6)&&M!==(M=e[2]===e[16].id?"":"+")&&me(S,M),e[2]===e[16].id?D?(D.p(e,N),N&6&&O(D,1)):(D=Bt(e),D.c(),O(D,1),D.m(n,P)):D&&(Pe(),G(D,1,1,()=>{D=null}),De()),(!d||N&2)&&Y(n,"disabled",!e[17].enabled),(!d||N&6)&&Y(n,"expanded",e[2]===e[16].id)},i($){d||(O(D),d=!0)},o($){G(D),d=!1},d($){$&&p(n),T&&T.d(),D&&D.d(),E=!1,$e(b)}}}function an(i){let e,n,t=i[0]&&Mt(i);return{c(){t&&t.c(),e=he()},l(s){t&&t.l(s),e=he()},m(s,a){t&&t.m(s,a),V(s,e,a),n=!0},p(s,[a]){s[0]?t?(t.p(s,a),a&1&&O(t,1)):(t=Mt(s),t.c(),O(t,1),t.m(e.parentNode,e)):t&&(Pe(),G(t,1,1,()=>{t=null}),De())},i(s){n||(O(t),n=!0)},o(s){G(t),n=!1},d(s){s&&p(e),t&&t.d(s)}}}const Dt=i=>i.state.enabled;function ln(i,e,n){let t,s,a,r;we(i,Re,d=>n(8,a=d)),we(i,de,d=>n(4,r=d));let{visible:o=!0}=e,l=null;function c(){hi(!s)}const u=ot.map(d=>({value:d.id,label:d.label,preview:d.preview}));function f(d){n(2,l=l===d?null:d)}const g=d=>ci(d.id),w=d=>f(d.id),v=d=>di(d.id),M=d=>mi(d.id),S=d=>f(d.id),C=(d,E,b)=>pt(d.id,E.id,b.detail),P=(d,E,b)=>pt(d.id,E.id,b.detail);return i.$$set=d=>{"visible"in d&&n(0,o=d.visible)},i.$$.update=()=>{i.$$.dirty&256&&n(1,t=He.map(d=>({definition:d,state:a.get(d.id)})).filter(d=>d.state)),i.$$.dirty&2&&n(3,s=t.some(d=>d.state.enabled))},[o,t,l,s,r,c,u,f,a,g,w,v,M,S,C,P]}class rn extends Be{constructor(e){super(),Ie(this,e,ln,an,Le,{visible:0})}}function Ct(i){let e,n,t='<span class="panel-title svelte-9wroah">LEVELS</span>',s,a,r,o,l,c,u,f,g,w,v,M,S,C,P,d,E,b,X,F;return o=new je({props:{label:"HI",value:i[1].raw.highs}}),u=new je({props:{label:"MD",value:i[1].raw.mids}}),w=new je({props:{label:"LO",value:i[1].raw.lows}}),S=new je({props:{label:"TR",value:i[1].raw.treble}}),d=new je({props:{label:"BS",value:i[1].raw.bass}}),X=new je({props:{label:"BT",value:i[1].raw.beat}}),{c(){e=y("div"),n=y("div"),n.innerHTML=t,s=A(),a=y("div"),r=y("div"),ie(o.$$.fragment),l=A(),c=y("div"),ie(u.$$.fragment),f=A(),g=y("div"),ie(w.$$.fragment),v=A(),M=y("div"),ie(S.$$.fragment),C=A(),P=y("div"),ie(d.$$.fragment),E=A(),b=y("div"),ie(X.$$.fragment),this.h()},l(T){e=_(T,"DIV",{class:!0});var z=I(e);n=_(z,"DIV",{class:!0,title:!0,"data-svelte-h":!0}),re(n)!=="svelte-1qdq6z0"&&(n.innerHTML=t),s=R(z),a=_(z,"DIV",{class:!0});var D=I(a);r=_(D,"DIV",{title:!0});var $=I(r);te(o.$$.fragment,$),$.forEach(p),l=R(D),c=_(D,"DIV",{title:!0});var N=I(c);te(u.$$.fragment,N),N.forEach(p),f=R(D),g=_(D,"DIV",{title:!0});var H=I(g);te(w.$$.fragment,H),H.forEach(p),v=R(D),M=_(D,"DIV",{title:!0});var Z=I(M);te(S.$$.fragment,Z),Z.forEach(p),C=R(D),P=_(D,"DIV",{title:!0});var K=I(P);te(d.$$.fragment,K),K.forEach(p),E=R(D),b=_(D,"DIV",{title:!0});var U=I(b);te(X.$$.fragment,U),U.forEach(p),D.forEach(p),z.forEach(p),this.h()},h(){m(n,"class","panel-header svelte-9wroah"),m(n,"title","Real-time audio levels from your microphone"),m(r,"title","High frequencies - cymbals, hi-hats, bright sounds"),m(c,"title","Mid frequencies - vocals, guitars, main melody"),m(g,"title","Low frequencies - bass, kick drum, rumble"),m(M,"title","Treble - combined high-pitched sounds"),m(P,"title","Bass - combined low-pitched sounds"),m(b,"title","Beat detection - pulses when drums or strong beats hit"),m(a,"class","levels-grid svelte-9wroah"),m(e,"class","panel levels-panel svelte-9wroah")},m(T,z){V(T,e,z),h(e,n),h(e,s),h(e,a),h(a,r),ee(o,r,null),h(a,l),h(a,c),ee(u,c,null),h(a,f),h(a,g),ee(w,g,null),h(a,v),h(a,M),ee(S,M,null),h(a,C),h(a,P),ee(d,P,null),h(a,E),h(a,b),ee(X,b,null),F=!0},p(T,z){const D={};z&2&&(D.value=T[1].raw.highs),o.$set(D);const $={};z&2&&($.value=T[1].raw.mids),u.$set($);const N={};z&2&&(N.value=T[1].raw.lows),w.$set(N);const H={};z&2&&(H.value=T[1].raw.treble),S.$set(H);const Z={};z&2&&(Z.value=T[1].raw.bass),d.$set(Z);const K={};z&2&&(K.value=T[1].raw.beat),X.$set(K)},i(T){F||(O(o.$$.fragment,T),O(u.$$.fragment,T),O(w.$$.fragment,T),O(S.$$.fragment,T),O(d.$$.fragment,T),O(X.$$.fragment,T),F=!0)},o(T){G(o.$$.fragment,T),G(u.$$.fragment,T),G(w.$$.fragment,T),G(S.$$.fragment,T),G(d.$$.fragment,T),G(X.$$.fragment,T),F=!1},d(T){T&&p(e),x(o),x(u),x(w),x(S),x(d),x(X)}}}function on(i){let e,n,t=i[0]&&Ct(i);return{c(){t&&t.c(),e=he()},l(s){t&&t.l(s),e=he()},m(s,a){t&&t.m(s,a),V(s,e,a),n=!0},p(s,[a]){s[0]?t?(t.p(s,a),a&1&&O(t,1)):(t=Ct(s),t.c(),O(t,1),t.m(e.parentNode,e)):t&&(Pe(),G(t,1,1,()=>{t=null}),De())},i(s){n||(O(t),n=!0)},o(s){G(t),n=!1},d(s){s&&p(e),t&&t.d(s)}}}function un(i,e,n){let t;we(i,rt,a=>n(1,t=a));let{visible:s=!0}=e;return i.$$set=a=>{"visible"in a&&n(0,s=a.visible)},[s,t]}class fn extends Be{constructor(e){super(),Ie(this,e,un,on,Le,{visible:0})}}function Rt(i){let e,n,t,s="TUNING",a,r,o=i[1]?"":"+",l,c,u,f,g,w,v,M,S,C,P,d,E,b,X,F,T,z;function D(L){i[5](L)}let $={label:"Sens",min:0,max:2,formatValue:i[3]};i[2].sensitivity!==void 0&&($.value=i[2].sensitivity),g=new Ee({props:$}),ve.push(()=>ye(g,"value",D));function N(L){i[6](L)}let H={label:"Beat",min:0,max:2,formatValue:i[3]};i[2].beatBoost!==void 0&&(H.value=i[2].beatBoost),S=new Ee({props:H}),ve.push(()=>ye(S,"value",N));function Z(L){i[7](L)}let K={label:"Gate",min:0,max:1,formatValue:i[3]};i[2].beatGate!==void 0&&(K.value=i[2].beatGate),E=new Ee({props:K}),ve.push(()=>ye(E,"value",Z));let U=i[1]&&At(i);return{c(){e=y("div"),n=y("div"),t=y("span"),t.textContent=s,a=A(),r=y("button"),l=ae(o),c=A(),u=y("div"),f=y("div"),ie(g.$$.fragment),v=A(),M=y("div"),ie(S.$$.fragment),P=A(),d=y("div"),ie(E.$$.fragment),X=A(),U&&U.c(),this.h()},l(L){e=_(L,"DIV",{class:!0});var k=I(e);n=_(k,"DIV",{class:!0});var q=I(n);t=_(q,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),re(t)!=="svelte-hff578"&&(t.textContent=s),a=R(q),r=_(q,"BUTTON",{class:!0,title:!0});var Q=I(r);l=se(Q,o),Q.forEach(p),q.forEach(p),c=R(k),u=_(k,"DIV",{class:!0});var j=I(u);f=_(j,"DIV",{title:!0});var J=I(f);te(g.$$.fragment,J),J.forEach(p),v=R(j),M=_(j,"DIV",{title:!0});var pe=I(M);te(S.$$.fragment,pe),pe.forEach(p),P=R(j),d=_(j,"DIV",{title:!0});var Se=I(d);te(E.$$.fragment,Se),Se.forEach(p),X=R(j),U&&U.l(j),j.forEach(p),k.forEach(p),this.h()},h(){m(t,"class","panel-title svelte-1rkomi4"),m(t,"title","Adjust how visuals respond to audio"),m(r,"class","toggle-advanced svelte-1rkomi4"),m(r,"title","Show more advanced audio controls"),m(n,"class","panel-header svelte-1rkomi4"),m(f,"title","Overall sensitivity - how much visuals react to sound"),m(M,"title","Beat boost - make beat reactions stronger or weaker"),m(d,"title","Beat gate - ignore quiet sounds, only react to loud beats"),m(u,"class","tuning-grid svelte-1rkomi4"),m(e,"class","panel tuning-panel svelte-1rkomi4")},m(L,k){V(L,e,k),h(e,n),h(n,t),h(n,a),h(n,r),h(r,l),h(e,c),h(e,u),h(u,f),ee(g,f,null),h(u,v),h(u,M),ee(S,M,null),h(u,P),h(u,d),ee(E,d,null),h(u,X),U&&U.m(u,null),F=!0,T||(z=ne(r,"click",i[4]),T=!0)},p(L,k){(!F||k&2)&&o!==(o=L[1]?"":"+")&&me(l,o);const q={};!w&&k&4&&(w=!0,q.value=L[2].sensitivity,_e(()=>w=!1)),g.$set(q);const Q={};!C&&k&4&&(C=!0,Q.value=L[2].beatBoost,_e(()=>C=!1)),S.$set(Q);const j={};!b&&k&4&&(b=!0,j.value=L[2].beatGate,_e(()=>b=!1)),E.$set(j),L[1]?U?(U.p(L,k),k&2&&O(U,1)):(U=At(L),U.c(),O(U,1),U.m(u,null)):U&&(Pe(),G(U,1,1,()=>{U=null}),De())},i(L){F||(O(g.$$.fragment,L),O(S.$$.fragment,L),O(E.$$.fragment,L),O(U),F=!0)},o(L){G(g.$$.fragment,L),G(S.$$.fragment,L),G(E.$$.fragment,L),G(U),F=!1},d(L){L&&p(e),x(g),x(S),x(E),U&&U.d(),T=!1,z()}}}function At(i){let e,n,t,s,a,r,o,l,c,u,f,g,w,v,M,S,C,P,d,E,b,X,F,T,z,D,$,N,H,Z,K,U,L,k;function q(B){i[8](B)}let Q={label:"Hi+",min:0,max:2,formatValue:i[3]};i[2].highsBoost!==void 0&&(Q.value=i[2].highsBoost),s=new Ee({props:Q}),ve.push(()=>ye(s,"value",q));function j(B){i[9](B)}let J={label:"Mid+",min:0,max:2,formatValue:i[3]};i[2].midsBoost!==void 0&&(J.value=i[2].midsBoost),l=new Ee({props:J}),ve.push(()=>ye(l,"value",j));function pe(B){i[10](B)}let Se={label:"Low+",min:0,max:2,formatValue:i[3]};i[2].lowsBoost!==void 0&&(Se.value=i[2].lowsBoost),g=new Ee({props:Se}),ve.push(()=>ye(g,"value",pe));function ce(B){i[11](B)}let ue={label:"Trbl",min:0,max:2,formatValue:i[3]};i[2].trebleBoost!==void 0&&(ue.value=i[2].trebleBoost),S=new Ee({props:ue}),ve.push(()=>ye(S,"value",ce));function Ke(B){i[12](B)}let Oe={label:"Bass",min:0,max:2,formatValue:i[3]};i[2].bassBoost!==void 0&&(Oe.value=i[2].bassBoost),E=new Ee({props:Oe}),ve.push(()=>ye(E,"value",Ke));function Te(B){i[13](B)}let le={label:"Min",min:0,max:.1,step:.005,formatValue:i[3]};i[2].minMotion!==void 0&&(le.value=i[2].minMotion),T=new Ee({props:le}),ve.push(()=>ye(T,"value",Te));function oe(B){i[14](B)}let qe={label:"Auto Suggest"};i[2].autoEnabled!==void 0&&(qe.checked=i[2].autoEnabled),Z=new xt({props:qe}),ve.push(()=>ye(Z,"checked",oe));let fe=i[2].autoEnabled&&Ft(i);return{c(){e=y("div"),n=A(),t=y("div"),ie(s.$$.fragment),r=A(),o=y("div"),ie(l.$$.fragment),u=A(),f=y("div"),ie(g.$$.fragment),v=A(),M=y("div"),ie(S.$$.fragment),P=A(),d=y("div"),ie(E.$$.fragment),X=A(),F=y("div"),ie(T.$$.fragment),D=A(),$=y("div"),N=A(),H=y("div"),ie(Z.$$.fragment),U=A(),fe&&fe.c(),L=he(),this.h()},l(B){e=_(B,"DIV",{class:!0}),I(e).forEach(p),n=R(B),t=_(B,"DIV",{title:!0});var W=I(t);te(s.$$.fragment,W),W.forEach(p),r=R(B),o=_(B,"DIV",{title:!0});var Fe=I(o);te(l.$$.fragment,Fe),Fe.forEach(p),u=R(B),f=_(B,"DIV",{title:!0});var Ce=I(f);te(g.$$.fragment,Ce),Ce.forEach(p),v=R(B),M=_(B,"DIV",{title:!0});var Me=I(M);te(S.$$.fragment,Me),Me.forEach(p),P=R(B),d=_(B,"DIV",{title:!0});var Ue=I(d);te(E.$$.fragment,Ue),Ue.forEach(p),X=R(B),F=_(B,"DIV",{title:!0});var Ve=I(F);te(T.$$.fragment,Ve),Ve.forEach(p),D=R(B),$=_(B,"DIV",{class:!0}),I($).forEach(p),N=R(B),H=_(B,"DIV",{title:!0});var ze=I(H);te(Z.$$.fragment,ze),ze.forEach(p),U=R(B),fe&&fe.l(B),L=he(),this.h()},h(){m(e,"class","divider svelte-1rkomi4"),m(t,"title","Boost high frequency response (cymbals, hi-hats)"),m(o,"title","Boost mid frequency response (vocals, guitars)"),m(f,"title","Boost low frequency response (bass, kick drums)"),m(M,"title","Boost treble (bright, high-pitched sounds)"),m(d,"title","Boost bass (deep, low-pitched sounds)"),m(F,"title","Minimum motion - keep some movement even in silence"),m($,"class","divider svelte-1rkomi4"),m(H,"title","Automatically adjust settings based on audio levels")},m(B,W){V(B,e,W),V(B,n,W),V(B,t,W),ee(s,t,null),V(B,r,W),V(B,o,W),ee(l,o,null),V(B,u,W),V(B,f,W),ee(g,f,null),V(B,v,W),V(B,M,W),ee(S,M,null),V(B,P,W),V(B,d,W),ee(E,d,null),V(B,X,W),V(B,F,W),ee(T,F,null),V(B,D,W),V(B,$,W),V(B,N,W),V(B,H,W),ee(Z,H,null),V(B,U,W),fe&&fe.m(B,W),V(B,L,W),k=!0},p(B,W){const Fe={};!a&&W&4&&(a=!0,Fe.value=B[2].highsBoost,_e(()=>a=!1)),s.$set(Fe);const Ce={};!c&&W&4&&(c=!0,Ce.value=B[2].midsBoost,_e(()=>c=!1)),l.$set(Ce);const Me={};!w&&W&4&&(w=!0,Me.value=B[2].lowsBoost,_e(()=>w=!1)),g.$set(Me);const Ue={};!C&&W&4&&(C=!0,Ue.value=B[2].trebleBoost,_e(()=>C=!1)),S.$set(Ue);const Ve={};!b&&W&4&&(b=!0,Ve.value=B[2].bassBoost,_e(()=>b=!1)),E.$set(Ve);const ze={};!z&&W&4&&(z=!0,ze.value=B[2].minMotion,_e(()=>z=!1)),T.$set(ze);const ut={};!K&&W&4&&(K=!0,ut.checked=B[2].autoEnabled,_e(()=>K=!1)),Z.$set(ut),B[2].autoEnabled?fe?(fe.p(B,W),W&4&&O(fe,1)):(fe=Ft(B),fe.c(),O(fe,1),fe.m(L.parentNode,L)):fe&&(Pe(),G(fe,1,1,()=>{fe=null}),De())},i(B){k||(O(s.$$.fragment,B),O(l.$$.fragment,B),O(g.$$.fragment,B),O(S.$$.fragment,B),O(E.$$.fragment,B),O(T.$$.fragment,B),O(Z.$$.fragment,B),O(fe),k=!0)},o(B){G(s.$$.fragment,B),G(l.$$.fragment,B),G(g.$$.fragment,B),G(S.$$.fragment,B),G(E.$$.fragment,B),G(T.$$.fragment,B),G(Z.$$.fragment,B),G(fe),k=!1},d(B){B&&(p(e),p(n),p(t),p(r),p(o),p(u),p(f),p(v),p(M),p(P),p(d),p(X),p(F),p(D),p($),p(N),p(H),p(U),p(L)),x(s),x(l),x(g),x(S),x(E),x(T),x(Z),fe&&fe.d(B)}}}function Ft(i){let e,n,t,s,a,r,o,l,c,u,f,g;function w(d){i[15](d)}let v={label:"Str",min:0,max:1,formatValue:i[3]};i[2].autoStrength!==void 0&&(v.value=i[2].autoStrength),n=new Ee({props:v}),ve.push(()=>ye(n,"value",w));function M(d){i[16](d)}let S={label:"Dec",min:0,max:1,formatValue:i[3]};i[2].autoDecay!==void 0&&(S.value=i[2].autoDecay),r=new Ee({props:S}),ve.push(()=>ye(r,"value",M));function C(d){i[17](d)}let P={label:"Tgt",options:[{value:"all",label:"All"},{value:"energy",label:"Energy"},{value:"treble",label:"Treble"},{value:"beat",label:"Beat"}]};return i[2].autoTarget!==void 0&&(P.value=i[2].autoTarget),u=new ei({props:P}),ve.push(()=>ye(u,"value",C)),{c(){e=y("div"),ie(n.$$.fragment),s=A(),a=y("div"),ie(r.$$.fragment),l=A(),c=y("div"),ie(u.$$.fragment),this.h()},l(d){e=_(d,"DIV",{title:!0});var E=I(e);te(n.$$.fragment,E),E.forEach(p),s=R(d),a=_(d,"DIV",{title:!0});var b=I(a);te(r.$$.fragment,b),b.forEach(p),l=R(d),c=_(d,"DIV",{title:!0});var X=I(c);te(u.$$.fragment,X),X.forEach(p),this.h()},h(){m(e,"title","How strongly auto-adjust affects the visuals"),m(a,"title","How quickly auto-adjustments fade back to normal"),m(c,"title","Which audio metric to use for auto-adjustment")},m(d,E){V(d,e,E),ee(n,e,null),V(d,s,E),V(d,a,E),ee(r,a,null),V(d,l,E),V(d,c,E),ee(u,c,null),g=!0},p(d,E){const b={};!t&&E&4&&(t=!0,b.value=d[2].autoStrength,_e(()=>t=!1)),n.$set(b);const X={};!o&&E&4&&(o=!0,X.value=d[2].autoDecay,_e(()=>o=!1)),r.$set(X);const F={};!f&&E&4&&(f=!0,F.value=d[2].autoTarget,_e(()=>f=!1)),u.$set(F)},i(d){g||(O(n.$$.fragment,d),O(r.$$.fragment,d),O(u.$$.fragment,d),g=!0)},o(d){G(n.$$.fragment,d),G(r.$$.fragment,d),G(u.$$.fragment,d),g=!1},d(d){d&&(p(e),p(s),p(a),p(l),p(c)),x(n),x(r),x(u)}}}function cn(i){let e,n,t=i[0]&&Rt(i);return{c(){t&&t.c(),e=he()},l(s){t&&t.l(s),e=he()},m(s,a){t&&t.m(s,a),V(s,e,a),n=!0},p(s,[a]){s[0]?t?(t.p(s,a),a&1&&O(t,1)):(t=Rt(s),t.c(),O(t,1),t.m(e.parentNode,e)):t&&(Pe(),G(t,1,1,()=>{t=null}),De())},i(s){n||(O(t),n=!0)},o(s){G(t),n=!1},d(s){s&&p(e),t&&t.d(s)}}}function dn(i,e,n){let t;we(i,be,b=>n(2,t=b));let{visible:s=!0}=e,a=!1;const r=b=>`${Math.round(b*100)}%`,o=()=>n(1,a=!a);function l(b){i.$$.not_equal(t.sensitivity,b)&&(t.sensitivity=b,be.set(t))}function c(b){i.$$.not_equal(t.beatBoost,b)&&(t.beatBoost=b,be.set(t))}function u(b){i.$$.not_equal(t.beatGate,b)&&(t.beatGate=b,be.set(t))}function f(b){i.$$.not_equal(t.highsBoost,b)&&(t.highsBoost=b,be.set(t))}function g(b){i.$$.not_equal(t.midsBoost,b)&&(t.midsBoost=b,be.set(t))}function w(b){i.$$.not_equal(t.lowsBoost,b)&&(t.lowsBoost=b,be.set(t))}function v(b){i.$$.not_equal(t.trebleBoost,b)&&(t.trebleBoost=b,be.set(t))}function M(b){i.$$.not_equal(t.bassBoost,b)&&(t.bassBoost=b,be.set(t))}function S(b){i.$$.not_equal(t.minMotion,b)&&(t.minMotion=b,be.set(t))}function C(b){i.$$.not_equal(t.autoEnabled,b)&&(t.autoEnabled=b,be.set(t))}function P(b){i.$$.not_equal(t.autoStrength,b)&&(t.autoStrength=b,be.set(t))}function d(b){i.$$.not_equal(t.autoDecay,b)&&(t.autoDecay=b,be.set(t))}function E(b){i.$$.not_equal(t.autoTarget,b)&&(t.autoTarget=b,be.set(t))}return i.$$set=b=>{"visible"in b&&n(0,s=b.visible)},[s,a,t,r,o,l,c,u,f,g,w,v,M,S,C,P,d,E]}class mn extends Be{constructor(e){super(),Ie(this,e,dn,cn,Le,{visible:0})}}function Ut(i){let e,n,t,s="PERFORMANCE",a,r,o=i[4]?"":"+",l,c,u,f,g,w="FPS",v,M,S=i[2].fps+"",C,P,d,E,b,X,F,T,z="Frame",D,$,N=i[2].frameTime.toFixed(1)+"",H,Z,K,U="ms",L,k,q,Q,j,J,pe,Se,ce=i[7]&&i[5]>0&&Vt(i),ue=i[4]&&zt(i);function Ke(le,oe){return le[7]?pn:hn}let Oe=Ke(i),Te=Oe(i);return{c(){e=y("div"),n=y("div"),t=y("span"),t.textContent=s,a=A(),r=y("button"),l=ae(o),c=A(),u=y("div"),f=y("div"),g=y("span"),g.textContent=w,v=A(),M=y("span"),C=ae(S),P=A(),d=y("span"),E=ae("/ "),b=ae(i[1]),X=A(),F=y("div"),T=y("span"),T.textContent=z,D=A(),$=y("span"),H=ae(N),Z=A(),K=y("span"),K.textContent=U,L=A(),ce&&ce.c(),k=A(),ue&&ue.c(),q=A(),Q=y("div"),j=y("span"),Te.c(),this.h()},l(le){e=_(le,"DIV",{class:!0});var oe=I(e);n=_(oe,"DIV",{class:!0});var qe=I(n);t=_(qe,"SPAN",{class:!0,"data-svelte-h":!0}),re(t)!=="svelte-18fq72a"&&(t.textContent=s),a=R(qe),r=_(qe,"BUTTON",{class:!0,title:!0});var fe=I(r);l=se(fe,o),fe.forEach(p),qe.forEach(p),c=R(oe),u=_(oe,"DIV",{class:!0});var B=I(u);f=_(B,"DIV",{class:!0});var W=I(f);g=_(W,"SPAN",{class:!0,"data-svelte-h":!0}),re(g)!=="svelte-1bu4eeu"&&(g.textContent=w),v=R(W),M=_(W,"SPAN",{class:!0,style:!0});var Fe=I(M);C=se(Fe,S),Fe.forEach(p),P=R(W),d=_(W,"SPAN",{class:!0});var Ce=I(d);E=se(Ce,"/ "),b=se(Ce,i[1]),Ce.forEach(p),W.forEach(p),X=R(B),F=_(B,"DIV",{class:!0});var Me=I(F);T=_(Me,"SPAN",{class:!0,"data-svelte-h":!0}),re(T)!=="svelte-1ikbzr0"&&(T.textContent=z),D=R(Me),$=_(Me,"SPAN",{class:!0});var Ue=I($);H=se(Ue,N),Ue.forEach(p),Z=R(Me),K=_(Me,"SPAN",{class:!0,"data-svelte-h":!0}),re(K)!=="svelte-13w5gq7"&&(K.textContent=U),Me.forEach(p),L=R(B),ce&&ce.l(B),B.forEach(p),k=R(oe),ue&&ue.l(oe),q=R(oe),Q=_(oe,"DIV",{class:!0});var Ve=I(Q);j=_(Ve,"SPAN",{class:!0});var ze=I(j);Te.l(ze),ze.forEach(p),Ve.forEach(p),oe.forEach(p),this.h()},h(){m(t,"class","panel-title svelte-yn9y4g"),m(r,"class","toggle-controls svelte-yn9y4g"),m(r,"title","Show performance controls"),m(n,"class","panel-header svelte-yn9y4g"),m(g,"class","label svelte-yn9y4g"),m(M,"class","value svelte-yn9y4g"),Ze(M,"color",i[6]),m(d,"class","target svelte-yn9y4g"),m(f,"class","stat svelte-yn9y4g"),m(T,"class","label svelte-yn9y4g"),m($,"class","value svelte-yn9y4g"),m(K,"class","unit svelte-yn9y4g"),m(F,"class","stat svelte-yn9y4g"),m(u,"class","stats-grid svelte-yn9y4g"),m(j,"class","hint svelte-yn9y4g"),m(Q,"class","panel-footer svelte-yn9y4g"),m(e,"class","panel perf-panel svelte-yn9y4g"),Y(e,"power-saver",i[7])},m(le,oe){V(le,e,oe),h(e,n),h(n,t),h(n,a),h(n,r),h(r,l),h(e,c),h(e,u),h(u,f),h(f,g),h(f,v),h(f,M),h(M,C),h(f,P),h(f,d),h(d,E),h(d,b),h(u,X),h(u,F),h(F,T),h(F,D),h(F,$),h($,H),h(F,Z),h(F,K),h(u,L),ce&&ce.m(u,null),h(e,k),ue&&ue.m(e,null),h(e,q),h(e,Q),h(Q,j),Te.m(j,null),J=!0,pe||(Se=ne(r,"click",i[10]),pe=!0)},p(le,oe){(!J||oe&16)&&o!==(o=le[4]?"":"+")&&me(l,o),(!J||oe&4)&&S!==(S=le[2].fps+"")&&me(C,S),(!J||oe&64)&&Ze(M,"color",le[6]),(!J||oe&2)&&me(b,le[1]),(!J||oe&4)&&N!==(N=le[2].frameTime.toFixed(1)+"")&&me(H,N),le[7]&&le[5]>0?ce?ce.p(le,oe):(ce=Vt(le),ce.c(),ce.m(u,null)):ce&&(ce.d(1),ce=null),le[4]?ue?(ue.p(le,oe),oe&16&&O(ue,1)):(ue=zt(le),ue.c(),O(ue,1),ue.m(e,q)):ue&&(Pe(),G(ue,1,1,()=>{ue=null}),De()),Oe===(Oe=Ke(le))&&Te?Te.p(le,oe):(Te.d(1),Te=Oe(le),Te&&(Te.c(),Te.m(j,null))),(!J||oe&128)&&Y(e,"power-saver",le[7])},i(le){J||(O(ue),J=!0)},o(le){G(ue),J=!1},d(le){le&&p(e),ce&&ce.d(),ue&&ue.d(),Te.d(),pe=!1,Se()}}}function Vt(i){let e,n,t="Saved",s,a,r,o,l;return{c(){e=y("div"),n=y("span"),n.textContent=t,s=A(),a=y("span"),r=ae("~"),o=ae(i[5]),l=ae("%"),this.h()},l(c){e=_(c,"DIV",{class:!0});var u=I(e);n=_(u,"SPAN",{class:!0,"data-svelte-h":!0}),re(n)!=="svelte-dz9cv6"&&(n.textContent=t),s=R(u),a=_(u,"SPAN",{class:!0});var f=I(a);r=se(f,"~"),o=se(f,i[5]),l=se(f,"%"),f.forEach(p),u.forEach(p),this.h()},h(){m(n,"class","label svelte-yn9y4g"),m(a,"class","value success svelte-yn9y4g"),m(e,"class","stat savings svelte-yn9y4g")},m(c,u){V(c,e,u),h(e,n),h(e,s),h(e,a),h(a,r),h(a,o),h(a,l)},p(c,u){u&32&&me(o,c[5])},d(c){c&&p(e)}}}function zt(i){let e,n,t,s,a,r,o,l,c,u,f,g,w,v,M,S="Quick:",C,P,d="Mobile",E,b,X="Laptop",F,T,z="Desktop",D,$,N;function H(k){i[11](k)}let Z={label:"Power Saver"};i[3].powerSaverEnabled!==void 0&&(Z.checked=i[3].powerSaverEnabled),a=new xt({props:Z}),ve.push(()=>ye(a,"checked",H));function K(k){i[12](k)}let U={label:"Target",min:15,max:60,step:5,formatValue:i[8]};i[3].targetFps!==void 0&&(U.value=i[3].targetFps),c=new Ee({props:U}),ve.push(()=>ye(c,"value",K));let L=!i[7]&&Nt();return{c(){e=y("div"),n=A(),t=y("div"),s=y("div"),ie(a.$$.fragment),o=A(),l=y("div"),ie(c.$$.fragment),f=A(),L&&L.c(),w=A(),v=y("div"),M=y("span"),M.textContent=S,C=A(),P=y("button"),P.textContent=d,E=A(),b=y("button"),b.textContent=X,F=A(),T=y("button"),T.textContent=z,this.h()},l(k){e=_(k,"DIV",{class:!0}),I(e).forEach(p),n=R(k),t=_(k,"DIV",{class:!0});var q=I(t);s=_(q,"DIV",{title:!0});var Q=I(s);te(a.$$.fragment,Q),Q.forEach(p),o=R(q),l=_(q,"DIV",{class:!0,title:!0});var j=I(l);te(c.$$.fragment,j),f=R(j),L&&L.l(j),j.forEach(p),w=R(q),v=_(q,"DIV",{class:!0});var J=I(v);M=_(J,"SPAN",{class:!0,"data-svelte-h":!0}),re(M)!=="svelte-9ap1jd"&&(M.textContent=S),C=R(J),P=_(J,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),re(P)!=="svelte-211gfj"&&(P.textContent=d),E=R(J),b=_(J,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),re(b)!=="svelte-mfdn79"&&(b.textContent=X),F=R(J),T=_(J,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),re(T)!=="svelte-13c6eed"&&(T.textContent=z),J.forEach(p),q.forEach(p),this.h()},h(){m(e,"class","divider svelte-yn9y4g"),m(s,"title","Enable power saving mode to limit frame rate"),m(l,"class","fps-slider-wrapper svelte-yn9y4g"),m(l,"title",g=i[7]?"Target frames per second - lower values save more battery":"Enable Power Saver to limit frame rate"),Y(l,"disabled",!i[7]),m(M,"class","presets-label svelte-yn9y4g"),m(P,"class","preset-btn svelte-yn9y4g"),m(P,"title","24fps - Best for phones and old devices"),Y(P,"active",i[1]<=24),m(b,"class","preset-btn svelte-yn9y4g"),m(b,"title","30fps - Good for laptops on battery"),Y(b,"active",i[1]===30),m(T,"class","preset-btn svelte-yn9y4g"),m(T,"title","60fps - Full quality for desktops"),Y(T,"active",i[1]>=60&&!i[7]),m(v,"class","presets svelte-yn9y4g"),m(t,"class","controls-grid svelte-yn9y4g")},m(k,q){V(k,e,q),V(k,n,q),V(k,t,q),h(t,s),ee(a,s,null),h(t,o),h(t,l),ee(c,l,null),h(l,f),L&&L.m(l,null),h(t,w),h(t,v),h(v,M),h(v,C),h(v,P),h(v,E),h(v,b),h(v,F),h(v,T),D=!0,$||(N=[ne(P,"click",i[13]),ne(b,"click",i[14]),ne(T,"click",i[15])],$=!0)},p(k,q){const Q={};!r&&q&8&&(r=!0,Q.checked=k[3].powerSaverEnabled,_e(()=>r=!1)),a.$set(Q);const j={};!u&&q&8&&(u=!0,j.value=k[3].targetFps,_e(()=>u=!1)),c.$set(j),k[7]?L&&(L.d(1),L=null):L||(L=Nt(),L.c(),L.m(l,null)),(!D||q&128&&g!==(g=k[7]?"Target frames per second - lower values save more battery":"Enable Power Saver to limit frame rate"))&&m(l,"title",g),(!D||q&128)&&Y(l,"disabled",!k[7]),(!D||q&2)&&Y(P,"active",k[1]<=24),(!D||q&2)&&Y(b,"active",k[1]===30),(!D||q&130)&&Y(T,"active",k[1]>=60&&!k[7])},i(k){D||(O(a.$$.fragment,k),O(c.$$.fragment,k),D=!0)},o(k){G(a.$$.fragment,k),G(c.$$.fragment,k),D=!1},d(k){k&&(p(e),p(n),p(t)),x(a),x(c),L&&L.d(),$=!1,$e(N)}}}function Nt(i){let e,n="Enable Power Saver to apply";return{c(){e=y("span"),e.textContent=n,this.h()},l(t){e=_(t,"SPAN",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-18yqm2c"&&(e.textContent=n),this.h()},h(){m(e,"class","slider-hint svelte-yn9y4g")},m(t,s){V(t,e,s)},d(t){t&&p(e)}}}function hn(i){let e;return{c(){e=ae("Running at display refresh rate")},l(n){e=se(n,"Running at display refresh rate")},m(n,t){V(n,e,t)},p:ge,d(n){n&&p(e)}}}function pn(i){let e,n,t,s,a;return{c(){e=ae("Limiting to "),n=ae(i[1]),t=ae("fps ("),s=ae(i[5]),a=ae("% less GPU)")},l(r){e=se(r,"Limiting to "),n=se(r,i[1]),t=se(r,"fps ("),s=se(r,i[5]),a=se(r,"% less GPU)")},m(r,o){V(r,e,o),V(r,n,o),V(r,t,o),V(r,s,o),V(r,a,o)},p(r,o){o&2&&me(n,r[1]),o&32&&me(s,r[5])},d(r){r&&(p(e),p(n),p(t),p(s),p(a))}}}function vn(i){let e,n,t=i[0]&&Ut(i);return{c(){t&&t.c(),e=he()},l(s){t&&t.l(s),e=he()},m(s,a){t&&t.m(s,a),V(s,e,a),n=!0},p(s,[a]){s[0]?t?(t.p(s,a),a&1&&O(t,1)):(t=Ut(s),t.c(),O(t,1),t.m(e.parentNode,e)):t&&(Pe(),G(t,1,1,()=>{t=null}),De())},i(s){n||(O(t),n=!0)},o(s){G(t),n=!1},d(s){s&&p(e),t&&t.d(s)}}}function gn(i,e,n){let t,s,a,r,o,l;we(i,Jt,d=>n(2,o=d)),we(i,de,d=>n(3,l=d));let{visible:c=!0}=e,u=!1;const f=d=>`${Math.round(d)}`;function g(d){de.update(E=>{switch(d){case"mobile":return{...E,powerSaverEnabled:!0,targetFps:24};case"laptop":return{...E,powerSaverEnabled:!0,targetFps:30};case"desktop":return{...E,powerSaverEnabled:!1,targetFps:60};default:return E}})}const w=()=>n(4,u=!u);function v(d){i.$$.not_equal(l.powerSaverEnabled,d)&&(l.powerSaverEnabled=d,de.set(l))}function M(d){i.$$.not_equal(l.targetFps,d)&&(l.targetFps=d,de.set(l))}const S=()=>g("mobile"),C=()=>g("laptop"),P=()=>g("desktop");return i.$$set=d=>{"visible"in d&&n(0,c=d.visible)},i.$$.update=()=>{i.$$.dirty&8&&n(7,t=l.powerSaverEnabled),i.$$.dirty&8&&n(1,s=l.targetFps),i.$$.dirty&6&&n(6,a=o.fps>=s*.9?"var(--color-success)":o.fps>=s*.5?"var(--color-warning, #f59e0b)":"var(--color-error, #ef4444)"),i.$$.dirty&2&&n(5,r=Math.round((1-s/60)*100))},[c,s,o,l,u,r,a,t,f,g,w,v,M,S,C,P]}class bn extends Be{constructor(e){super(),Ie(this,e,gn,vn,Le,{visible:0})}}function $t(i){let e,n,t,s="",a,r,o='<h1 id="info-title" class="svelte-199k3h4">SOUNDART</h1> <p class="tagline svelte-199k3h4">Audio-reactive WebGL visualizer that transforms sound into mesmerizing visuals in real-time.</p>',l,c,u='<section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Getting Started</h2> <ol class="svelte-199k3h4"><li class="svelte-199k3h4">Click <strong class="svelte-199k3h4">MIC ON</strong> to enable microphone</li> <li class="svelte-199k3h4">Play music or make sounds</li> <li class="svelte-199k3h4">Watch the visuals react!</li></ol></section> <section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Keyboard Shortcuts</h2> <div class="shortcuts svelte-199k3h4"><div class="shortcut svelte-199k3h4"><kbd class="svelte-199k3h4">C</kbd><span>Toggle control panels</span></div> <div class="shortcut svelte-199k3h4"><kbd class="svelte-199k3h4">F</kbd><span>Toggle fullscreen</span></div> <div class="shortcut svelte-199k3h4"><kbd class="svelte-199k3h4">?</kbd><span>Show/hide this help</span></div></div></section> <section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Touch Controls</h2> <div class="shortcuts svelte-199k3h4"><div class="shortcut svelte-199k3h4"><span class="gesture svelte-199k3h4">Single tap</span><span>Toggle panels</span></div> <div class="shortcut svelte-199k3h4"><span class="gesture svelte-199k3h4">Double tap</span><span>Toggle fullscreen</span></div></div></section> <section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Layers</h2> <ul class="svelte-199k3h4"><li class="svelte-199k3h4">Toggle layers on/off with the indicator dot</li> <li class="svelte-199k3h4">Click <strong class="svelte-199k3h4">+</strong> to expand and adjust settings</li> <li class="svelte-199k3h4">Adjust <strong class="svelte-199k3h4">intensity</strong>, <strong class="svelte-199k3h4">zoom</strong>, <strong class="svelte-199k3h4">theme</strong>, and <strong class="svelte-199k3h4">sensitivity</strong></li></ul> <h3 class="svelte-199k3h4">Global Controls</h3> <ul class="svelte-199k3h4"><li class="svelte-199k3h4"><strong class="svelte-199k3h4">RANDOM</strong> - Enable automatic parameter changes on beats</li> <li class="svelte-199k3h4"><strong class="svelte-199k3h4">STROBE</strong> - Enable layers flashing on/off with beats</li></ul> <h3 class="svelte-199k3h4">Per-Layer Buttons</h3> <div class="button-legend svelte-199k3h4"><div class="legend-item svelte-199k3h4"><span class="legend-btn r svelte-199k3h4">R</span><span>Include in randomizer (theme/intensity/zoom)</span></div> <div class="legend-item svelte-199k3h4"><span class="legend-btn s svelte-199k3h4">S</span><span>Include in strobe (flash on/off)</span></div></div></section> <section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Audio Tuning</h2> <ul class="svelte-199k3h4"><li class="svelte-199k3h4"><strong class="svelte-199k3h4">Global sensitivity</strong>: overall audio reactivity</li> <li class="svelte-199k3h4"><strong class="svelte-199k3h4">Frequency boosts</strong>: enhance specific ranges</li> <li class="svelte-199k3h4"><strong class="svelte-199k3h4">Beat gate</strong>: threshold for beat detection</li> <li class="svelte-199k3h4"><strong class="svelte-199k3h4">Auto-suggest</strong>: automatic sensitivity adjustment</li></ul></section> <section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Tips</h2> <ul class="svelte-199k3h4"><li class="svelte-199k3h4">Use <strong class="svelte-199k3h4">fullscreen</strong> for best experience</li> <li class="svelte-199k3h4">Try different <strong class="svelte-199k3h4">themes</strong> on each layer</li> <li class="svelte-199k3h4">Adjust <strong class="svelte-199k3h4">sensitivity</strong> if visuals are too subtle or intense</li> <li class="svelte-199k3h4">Enable <strong class="svelte-199k3h4">Power Saver</strong> on laptops to save battery</li></ul></section>',f,g,w='<span>Press <kbd class="svelte-199k3h4">?</kbd> or tap the help button to reopen</span>',v,M;return{c(){e=y("div"),n=y("div"),t=y("button"),t.textContent=s,a=A(),r=y("header"),r.innerHTML=o,l=A(),c=y("div"),c.innerHTML=u,f=A(),g=y("footer"),g.innerHTML=w,this.h()},l(S){e=_(S,"DIV",{class:!0});var C=I(e);n=_(C,"DIV",{class:!0,role:!0,"aria-modal":!0,"aria-labelledby":!0});var P=I(n);t=_(P,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),re(t)!=="svelte-h7on2u"&&(t.textContent=s),a=R(P),r=_(P,"HEADER",{class:!0,"data-svelte-h":!0}),re(r)!=="svelte-1jvg3xd"&&(r.innerHTML=o),l=R(P),c=_(P,"DIV",{class:!0,"data-svelte-h":!0}),re(c)!=="svelte-1k0sc2q"&&(c.innerHTML=u),f=R(P),g=_(P,"FOOTER",{class:!0,"data-svelte-h":!0}),re(g)!=="svelte-5jo3kb"&&(g.innerHTML=w),P.forEach(p),C.forEach(p),this.h()},h(){m(t,"class","close-btn svelte-199k3h4"),m(t,"aria-label","Close"),m(r,"class","info-header svelte-199k3h4"),m(c,"class","info-content svelte-199k3h4"),m(g,"class","info-footer svelte-199k3h4"),m(n,"class","info-panel svelte-199k3h4"),m(n,"role","dialog"),m(n,"aria-modal","true"),m(n,"aria-labelledby","info-title"),m(e,"class","overlay svelte-199k3h4")},m(S,C){V(S,e,C),h(e,n),h(n,t),h(n,a),h(n,r),h(n,l),h(n,c),h(n,f),h(n,g),v||(M=[ne(t,"click",i[1]),ne(e,"click",i[3])],v=!0)},p:ge,d(S){S&&p(e),v=!1,$e(M)}}}function _n(i){let e,n,t,s=i[0]&&$t(i);return{c(){s&&s.c(),e=he()},l(a){s&&s.l(a),e=he()},m(a,r){s&&s.m(a,r),V(a,e,r),n||(t=ne(window,"keydown",i[2]),n=!0)},p(a,[r]){a[0]?s?s.p(a,r):(s=$t(a),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null)},i:ge,o:ge,d(a){a&&p(e),s&&s.d(a),n=!1,t()}}}const Ot="soundart-seen-info";function yn(i,e,n){let{visible:t=!1}=e,{onClose:s}=e;function a(){return!localStorage.getItem(Ot)}function r(){localStorage.setItem(Ot,"true")}function o(){r(),s()}function l(u){u.key==="Escape"&&t&&o()}function c(u){u.target===u.currentTarget&&o()}return i.$$set=u=>{"visible"in u&&n(0,t=u.visible),"onClose"in u&&n(4,s=u.onClose)},[t,o,l,c,s,a]}class wn extends Be{constructor(e){super(),Ie(this,e,yn,_n,Le,{visible:0,onClose:4,shouldShowOnFirstVisit:5})}get shouldShowOnFirstVisit(){return this.$$.ctx[5]}}function Tn(i){let e,n,t,s,a,r,o,l,c,u,f,g,w,v,M,S,C,P={};return n=new Oi({props:P}),i[7](n),s=new tn({props:{onEnableMic:i[3],onShowInfo:i[4],visible:i[2].panelsVisible}}),r=new rn({props:{visible:i[2].panelsVisible}}),l=new fn({props:{visible:i[2].panelsVisible}}),u=new mn({props:{visible:i[2].panelsVisible}}),g=new bn({props:{visible:i[2].panelsVisible}}),v=new wn({props:{visible:i[1],onClose:i[5]}}),{c(){e=y("main"),ie(n.$$.fragment),t=A(),ie(s.$$.fragment),a=A(),ie(r.$$.fragment),o=A(),ie(l.$$.fragment),c=A(),ie(u.$$.fragment),f=A(),ie(g.$$.fragment),w=A(),ie(v.$$.fragment),this.h()},l(d){e=_(d,"MAIN",{class:!0});var E=I(e);te(n.$$.fragment,E),t=R(E),te(s.$$.fragment,E),a=R(E),te(r.$$.fragment,E),o=R(E),te(l.$$.fragment,E),c=R(E),te(u.$$.fragment,E),f=R(E),te(g.$$.fragment,E),w=R(E),te(v.$$.fragment,E),E.forEach(p),this.h()},h(){m(e,"class","app svelte-1hyx21c")},m(d,E){V(d,e,E),ee(n,e,null),h(e,t),ee(s,e,null),h(e,a),ee(r,e,null),h(e,o),ee(l,e,null),h(e,c),ee(u,e,null),h(e,f),ee(g,e,null),h(e,w),ee(v,e,null),M=!0,S||(C=ne(window,"keydown",i[6]),S=!0)},p(d,[E]){const b={};n.$set(b);const X={};E&4&&(X.visible=d[2].panelsVisible),s.$set(X);const F={};E&4&&(F.visible=d[2].panelsVisible),r.$set(F);const T={};E&4&&(T.visible=d[2].panelsVisible),l.$set(T);const z={};E&4&&(z.visible=d[2].panelsVisible),u.$set(z);const D={};E&4&&(D.visible=d[2].panelsVisible),g.$set(D);const $={};E&2&&($.visible=d[1]),v.$set($)},i(d){M||(O(n.$$.fragment,d),O(s.$$.fragment,d),O(r.$$.fragment,d),O(l.$$.fragment,d),O(u.$$.fragment,d),O(g.$$.fragment,d),O(v.$$.fragment,d),M=!0)},o(d){G(n.$$.fragment,d),G(s.$$.fragment,d),G(r.$$.fragment,d),G(l.$$.fragment,d),G(u.$$.fragment,d),G(g.$$.fragment,d),G(v.$$.fragment,d),M=!1},d(d){d&&p(e),i[7](null),x(n),x(s),x(r),x(l),x(u),x(g),x(v),S=!1,C()}}}const st="soundart-seen-info";function kn(i,e,n){let t;we(i,de,v=>n(2,t=v));let s,a=!1;async function r(){return s?await s.enableMicrophone():!1}function o(){n(1,a=!0)}function l(){n(1,a=!1),localStorage.setItem(st,"true")}function c(){a?l():o()}function u(v){if(!(v.target instanceof HTMLInputElement||v.target instanceof HTMLTextAreaElement))switch(v.key){case"?":c();break;case"c":case"C":a||gi();break;case"f":case"F":a||f();break}}async function f(){document.fullscreenElement?(await document.exitFullscreen(),de.update(v=>({...v,fullscreen:!1}))):(await document.documentElement.requestFullscreen(),de.update(v=>({...v,fullscreen:!0})))}function g(){de.update(v=>({...v,fullscreen:!!document.fullscreenElement}))}qt(()=>{document.addEventListener("fullscreenchange",g),localStorage.getItem(st)||setTimeout(()=>{n(1,a=!0)},800);const v=localStorage.getItem(st)?500:1500;return setTimeout(()=>{r()},v),()=>{document.removeEventListener("fullscreenchange",g)}});function w(v){ve[v?"unshift":"push"](()=>{s=v,n(0,s)})}return[s,a,t,r,o,l,u,w]}class Ln extends Be{constructor(e){super(),Ie(this,e,kn,Tn,Le,{})}}export{Ln as component};
