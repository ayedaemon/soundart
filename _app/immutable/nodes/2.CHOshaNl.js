import{r as Ae,P as Ge,s as _e,n as me,d as h,i as C,Q,A as m,c as S,e as B,h as M,k as pe,x as Dt,R as Zt,C as oe,a as ge,S as G,b as y,f as se,g as F,t as re,j as V,T as Pt,U as jt,V as lt,W as st,B as Oe,v as ue,X as be,Y as ce}from"../chunks/D6DlaX6_.js";import{a as N,t as q,S as we,i as Te,g as ke,c as Se,d as Y,m as W,e as x,b as K,f as de}from"../chunks/COUIFFA3.js";import{b as At,d as Ke,w as Le}from"../chunks/BMLVKjn0.js";function Pe(i){return i?.length!==void 0?i:Array.from(i)}function Ut(i,e){q(i,1,1,()=>{e.delete(i.key)})}function Ct(i,e,n,t,a,l,r,o,s,f,u,c){let p=i.length,_=l.length,w=p;const E={};for(;w--;)E[i[w].key]=w;const b=[],U=new Map,R=new Map,d=[];for(w=_;w--;){const A=c(a,l,w),v=n(A);let L=r.get(v);L?d.push(()=>L.p(A,e)):(L=f(v,A),L.c()),U.set(v,b[w]=L),v in E&&R.set(v,Math.abs(w-E[v]))}const I=new Set,T=new Set;function O(A){N(A,1),A.m(o,u),r.set(A.key,A),u=A.first,_--}for(;p&&_;){const A=b[_-1],v=i[p-1],L=A.key,P=v.key;A===v?(u=A.first,p--,_--):U.has(P)?!r.has(L)||I.has(L)?O(A):T.has(P)?p--:R.get(L)>R.get(P)?(T.add(L),O(A)):(I.add(P),p--):(s(v,r),p--)}for(;p--;){const A=i[p];U.has(A.key)||s(A,r)}for(;_;)O(b[_-1]);return Ae(d),b}const Ze=new Map;async function Ft(i){if(Ze.has(i))return Ze.get(i);const e=await fetch(i);if(!e.ok)throw new Error(`Failed to load shader: ${i}`);const n=await e.text();return Ze.set(i,n),n}async function Vt(i,e,n=new Set){const t=/#include\s+"([^"]+)"/g;let a=i,l;const r=[];for(;(l=t.exec(i))!==null;)r.push({full:l[0],path:l[1]});for(const{full:o,path:s}of r){const f=e+s;if(n.has(f)){console.warn(`Circular include detected: ${f}`),a=a.replace(o,"");continue}n.add(f);try{let u=await Ft(f);u=await Vt(u,e,n),a=a.replace(o,u)}catch(u){console.error(`Failed to include shader: ${f}`,u),a=a.replace(o,`// Failed to include: ${s}`)}}return a}async function rt(i,e=`${At}/shaders/`){const n=await Ft(e+i);return Vt(n,e)}function ot(i,e,n){const t=i.createShader(e);if(!t)return console.error("Failed to create shader"),null;if(i.shaderSource(t,n),i.compileShader(t),!i.getShaderParameter(t,i.COMPILE_STATUS)){const a=i.getShaderInfoLog(t);console.error("Shader compilation error:",a);const r=n.split(`
`).map((o,s)=>`${s+1}: ${o}`);return console.error(`Shader source:
`+r.join(`
`)),i.deleteShader(t),null}return t}function Yt(i,e,n){const t=ot(i,i.VERTEX_SHADER,e),a=ot(i,i.FRAGMENT_SHADER,n);if(!t||!a)return null;const l=i.createProgram();if(!l)return console.error("Failed to create program"),null;if(i.attachShader(l,t),i.attachShader(l,a),i.linkProgram(l),!i.getProgramParameter(l,i.LINK_STATUS)){const r=i.getProgramInfoLog(l);return console.error("Program linking error:",r),i.deleteProgram(l),null}return i.deleteShader(t),i.deleteShader(a),l}async function ut(i,e,n,t=`${At}/shaders/`){const[a,l]=await Promise.all([rt(e,t),rt(n,t)]);return Yt(i,a,l)}const Be=[{id:"glow",label:"Center Glow",description:"Pulsing core with arcs",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerGlow"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerGlowZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerGlowTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerGlowSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerGlowMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/glow.glsl",randomizable:!0},{id:"turbulence",label:"Turbulence",description:"Audio-reactive turbulence",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerTurbulence"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerTurbulenceZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerTurbulenceTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerTurbulenceSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerTurbulenceMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.3,transform:"linear"}],shaderPath:"layers/turbulence.glsl",randomizable:!0},{id:"displacement",label:"Displacement",description:"Cellular displacement waves",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerDisplacement"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerDisplacementZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerDisplacementTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerDisplacementSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerDisplacementMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.3,transform:"linear"}],shaderPath:"layers/displacement.glsl",randomizable:!0},{id:"starfield",label:"Starfield",description:"Warp tunnel streaks",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerStarfield"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerStarfieldZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerStarfieldTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerStarfieldSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerStarfieldMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"}],shaderPath:"layers/starfield.glsl",randomizable:!0},{id:"cubescape",label:"Cubescape",description:"3D cube lattice",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerCubescape"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerCubescapeZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerCubescapeTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerCubescapeSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerCubescapeMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/cubescape.glsl",randomizable:!0},{id:"spires",label:"Spires",description:"Cathedral-like pillars",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerSpires"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerSpiresZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerSpiresTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerSpiresSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerSpiresMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.3,transform:"linear"}],shaderPath:"layers/spires.glsl",randomizable:!0},{id:"mandala",label:"Mandala",description:"Radial symmetries",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerMandala"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerMandalaZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerMandalaTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerMandalaSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerMandalaMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/mandala.glsl",randomizable:!0},{id:"kaleidoscope",label:"Kaleidoscope",description:"Sacred geometry mirroring",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerKaleidoscope"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerKaleidoscopeZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerKaleidoscopeTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerKaleidoscopeSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerKaleidoscopeMouseSens"}],audioBindings:[{audioMetric:"treble",targetProperty:"intensity",sensitivity:1,transform:"linear"}],shaderPath:"layers/kaleidoscope.glsl",randomizable:!0},{id:"lissajous",label:"Lissajous",description:"Flowing curves",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerLissajous"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerLissajousZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerLissajousTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerLissajousSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerLissajousMouseSens"}],audioBindings:[{audioMetric:"energy",targetProperty:"intensity",sensitivity:1,transform:"linear"}],shaderPath:"layers/lissajous.glsl",randomizable:!0},{id:"flower",label:"Flower of Life",description:"Sacred circles",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerFlower"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerFlowerZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerFlowerTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerFlowerSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerFlowerMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"}],shaderPath:"layers/flower.glsl",randomizable:!0},{id:"fibonacci",label:"Fibonacci",description:"Golden spiral",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerFibonacci"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerFibonacciZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerFibonacciTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerFibonacciSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerFibonacciMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"}],shaderPath:"layers/fibonacci.glsl",randomizable:!0},{id:"hopalong",label:"Hopalong Orbits",description:"Barry Martin attractor",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerHopalong"},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerHopalongZoom"},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerHopalongTheme"},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerHopalongSensitivity"},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerHopalongMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/hopalong.glsl",randomizable:!0}];class Wt{canvas;gl=null;program=null;uniformLocations={};mouseUniformLocations={};layerUniformLocations=new Map;reactionProgram=null;reactionUniforms={input:null,texel:null,time:null,treble:null};reactionSeeded=!1;feedbackTexture=null;feedbackReady=!1;reactionBuffer=null;positionBuffer=null;initialized=!1;currentTime=0;constructor(e){this.canvas=e}async init(){if(this.gl=this.canvas.getContext("webgl",{antialias:!1,preserveDrawingBuffer:!0}),!this.gl)return console.error("WebGL not supported"),!1;const e=this.gl;try{if(this.program=await ut(e,"quad.vert","composite.frag"),!this.program)return console.error("Failed to create shader program"),!1;if(this.reactionProgram=await ut(e,"quad.vert","reaction_diffusion.frag"),!this.reactionProgram)return console.error("Failed to create reaction-diffusion program"),!1;this.reactionUniforms={input:e.getUniformLocation(this.reactionProgram,"uInput"),texel:e.getUniformLocation(this.reactionProgram,"uTexel"),time:e.getUniformLocation(this.reactionProgram,"uTime"),treble:e.getUniformLocation(this.reactionProgram,"uTreble")}}catch(r){return console.error("Failed to load shaders:",r),!1}this.uniformLocations={time:e.getUniformLocation(this.program,"uTime"),resolution:e.getUniformLocation(this.program,"uResolution"),beat:e.getUniformLocation(this.program,"uBeat"),energy:e.getUniformLocation(this.program,"uEnergy"),treble:e.getUniformLocation(this.program,"uTreble"),feedbackTexture:e.getUniformLocation(this.program,"uFeedbackTex"),feedbackReady:e.getUniformLocation(this.program,"uFeedbackReady"),reactionTexture:e.getUniformLocation(this.program,"uReactionTex")},this.mouseUniformLocations={position:e.getUniformLocation(this.program,"uMouse"),velocity:e.getUniformLocation(this.program,"uMouseVelocity"),speed:e.getUniformLocation(this.program,"uMouseSpeed"),down:e.getUniformLocation(this.program,"uMouseDown"),click:e.getUniformLocation(this.program,"uMouseClick")};for(const r of Be)for(const o of r.properties){const s=e.getUniformLocation(this.program,o.uniform);this.layerUniformLocations.set(o.uniform,s)}this.positionBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.positionBuffer);const n=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]);e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW);const t=e.getAttribLocation(this.program,"aPosition");e.enableVertexAttribArray(t),e.vertexAttribPointer(t,2,e.FLOAT,!1,0,0),this.feedbackTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.feedbackTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.canvas.width,this.canvas.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);const a=Math.max(1,this.canvas.width),l=Math.max(1,this.canvas.height);return this.reactionBuffer=this.createPingPongBuffer(a,l),this.initialized=!0,!0}resize(){if(!this.gl||!this.canvas)return;const e=this.gl,n=window.devicePixelRatio||1,t=Math.floor(this.canvas.clientWidth*n),a=Math.floor(this.canvas.clientHeight*n);(this.canvas.width!==t||this.canvas.height!==a)&&(this.canvas.width=t,this.canvas.height=a,e.viewport(0,0,t,a),this.feedbackTexture&&(e.bindTexture(e.TEXTURE_2D,this.feedbackTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,a,0,e.RGBA,e.UNSIGNED_BYTE,null)),this.reactionBuffer&&(this.resizePingPongBuffer(this.reactionBuffer,t,a),this.reactionSeeded=!1),this.feedbackReady=!1)}render(e,n,t,a){if(!this.gl||!this.program||!this.initialized)return;const l=this.gl;this.currentTime=e,this.resize(),this.renderReactionDiffusion(8,n.treble),l.clearColor(0,0,0,1),l.clear(l.COLOR_BUFFER_BIT),l.useProgram(this.program);const r=l.getAttribLocation(this.program,"aPosition");l.bindBuffer(l.ARRAY_BUFFER,this.positionBuffer),l.enableVertexAttribArray(r),l.vertexAttribPointer(r,2,l.FLOAT,!1,0,0),l.uniform1f(this.uniformLocations.time,e),l.uniform2f(this.uniformLocations.resolution,this.canvas.width,this.canvas.height),l.uniform1f(this.uniformLocations.beat,n.beat),l.uniform1f(this.uniformLocations.energy,n.energy),l.uniform1f(this.uniformLocations.treble,n.treble),l.uniform2f(this.mouseUniformLocations.position,t.x,t.y),l.uniform2f(this.mouseUniformLocations.velocity,t.velocityX,t.velocityY),l.uniform1f(this.mouseUniformLocations.speed,t.speed),l.uniform1f(this.mouseUniformLocations.down,t.down),l.uniform2f(this.mouseUniformLocations.click,t.clickX,t.clickY);for(const[o,s]of Object.entries(a)){const f=this.layerUniformLocations.get(o);f&&l.uniform1f(f,s)}l.activeTexture(l.TEXTURE0),this.feedbackTexture&&this.feedbackReady?l.bindTexture(l.TEXTURE_2D,this.feedbackTexture):l.bindTexture(l.TEXTURE_2D,null),l.uniform1i(this.uniformLocations.feedbackTexture,0),l.uniform1f(this.uniformLocations.feedbackReady,this.feedbackReady?1:0),l.activeTexture(l.TEXTURE1),this.reactionBuffer&&this.reactionBuffer.textures[this.reactionBuffer.index]?l.bindTexture(l.TEXTURE_2D,this.reactionBuffer.textures[this.reactionBuffer.index]):l.bindTexture(l.TEXTURE_2D,null),l.uniform1i(this.uniformLocations.reactionTexture,1),l.drawArrays(l.TRIANGLES,0,6),this.canvas.width>0&&this.canvas.height>0&&this.feedbackTexture&&(l.bindTexture(l.TEXTURE_2D,this.feedbackTexture),l.copyTexSubImage2D(l.TEXTURE_2D,0,0,0,0,0,this.canvas.width,this.canvas.height),this.feedbackReady=!0),l.activeTexture(l.TEXTURE0)}dispose(){if(!this.gl)return;const e=this.gl;this.program&&(e.deleteProgram(this.program),this.program=null),this.reactionProgram&&(e.deleteProgram(this.reactionProgram),this.reactionProgram=null),this.positionBuffer&&(e.deleteBuffer(this.positionBuffer),this.positionBuffer=null),this.feedbackTexture&&(e.deleteTexture(this.feedbackTexture),this.feedbackTexture=null),this.reactionBuffer&&(this.disposePingPongBuffer(this.reactionBuffer),this.reactionBuffer=null),this.reactionSeeded=!1,this.initialized=!1}isInitialized(){return this.initialized}getCanvas(){return this.canvas}createPingPongBuffer(e,n){if(!this.gl)return null;const t=this.gl,a={textures:[null,null],framebuffers:[null,null],index:0,width:e,height:n};for(let l=0;l<2;l++){const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,n,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),a.textures[l]=r;const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const s=t.checkFramebufferStatus(t.FRAMEBUFFER);s!==t.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer not complete:",s),a.framebuffers[l]=o}return t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),a}swapPingPong(e){e.index=1-e.index}resizePingPongBuffer(e,n,t){if(!this.gl||e.width===n&&e.height===t)return;const a=this.gl;e.width=n,e.height=t;for(let l=0;l<2;l++)e.textures[l]&&(a.bindTexture(a.TEXTURE_2D,e.textures[l]),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,n,t,0,a.RGBA,a.UNSIGNED_BYTE,null));a.bindTexture(a.TEXTURE_2D,null)}disposePingPongBuffer(e){if(!this.gl)return;const n=this.gl;for(let t=0;t<2;t++)e.textures[t]&&(n.deleteTexture(e.textures[t]),e.textures[t]=null),e.framebuffers[t]&&(n.deleteFramebuffer(e.framebuffers[t]),e.framebuffers[t]=null)}seedReactionBuffer(){if(!this.gl||!this.reactionBuffer)return;const e=this.gl,n=this.reactionBuffer.width,t=this.reactionBuffer.height,a=new Uint8Array(n*t*4);for(let l=0;l<t;l++)for(let r=0;r<n;r++){const o=(l*n+r)*4;a[o]=255;const s=r-n/2,f=l-t/2,u=Math.sqrt(s*s+f*f),c=Math.min(n,t)*.3;u<c&&Math.random()<.15?a[o+1]=255:a[o+1]=0,a[o+2]=0,a[o+3]=255}for(let l=0;l<2;l++)e.bindTexture(e.TEXTURE_2D,this.reactionBuffer.textures[l]),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n,t,0,e.RGBA,e.UNSIGNED_BYTE,a);e.bindTexture(e.TEXTURE_2D,null),this.reactionSeeded=!0}renderReactionDiffusion(e,n){if(!this.gl||!this.reactionProgram||!this.reactionBuffer||!this.positionBuffer)return;const t=this.gl;this.reactionSeeded||this.seedReactionBuffer(),t.useProgram(this.reactionProgram);const a=t.getAttribLocation(this.reactionProgram,"aPosition");t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.enableVertexAttribArray(a),t.vertexAttribPointer(a,2,t.FLOAT,!1,0,0),t.uniform2f(this.reactionUniforms.texel,1/this.reactionBuffer.width,1/this.reactionBuffer.height),t.uniform1f(this.reactionUniforms.time,this.currentTime),t.uniform1f(this.reactionUniforms.treble,n);for(let l=0;l<e;l++){const r=this.reactionBuffer.index,o=1-r;t.bindFramebuffer(t.FRAMEBUFFER,this.reactionBuffer.framebuffers[o]),t.viewport(0,0,this.reactionBuffer.width,this.reactionBuffer.height),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.reactionBuffer.textures[r]),t.uniform1i(this.reactionUniforms.input,0),t.drawArrays(t.TRIANGLES,0,6),this.swapPingPong(this.reactionBuffer)}t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,this.canvas.width,this.canvas.height)}}function Re(i,e,n){return i+(e-i)*n}function xt(i,e,n){return Math.min(Math.max(i,e),n)}class Kt{context=null;analyser=null;source=null;freqData=null;stream=null;energy=0;treble=0;highs=0;mids=0;lows=0;bass=0;beatValue=0;beatCutoff=0;beatHold=0;smoothing=.3;beatFalloff=2.4;beatMin=.15;beatDecay=.98;beatHoldTime=.08;async init(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});const e=window.AudioContext||window.webkitAudioContext;return this.context=new e,this.source=this.context.createMediaStreamSource(this.stream),this.analyser=this.context.createAnalyser(),this.analyser.fftSize=2048,this.analyser.smoothingTimeConstant=.8,this.source.connect(this.analyser),this.freqData=new Uint8Array(this.analyser.frequencyBinCount),!0}catch(e){return console.error("Failed to initialize audio:",e),!1}}dispose(){this.source&&(this.source.disconnect(),this.source=null),this.context&&(this.context.close(),this.context=null),this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null),this.analyser=null,this.freqData=null}update(e){if(!this.analyser||!this.freqData)return this.getEmptyMetrics();this.analyser.getByteFrequencyData(this.freqData);const n=this.freqData.length,a=(this.context?.sampleRate||44100)/this.analyser.fftSize,l=120,r=200,o=2e3,s=6e3,f=Math.max(2,Math.floor(l/a)),u=Math.max(f+1,Math.floor(r/a)),c=Math.max(u+1,Math.floor(o/a)),p=Math.max(c+1,Math.floor(s/a)),_=Math.min(n-1,u),w=Math.min(n-1,c),E=Math.min(n-1,p);let b=0,U=0,R=0,d=0,I=0,T=0;for(let H=0;H<n;H++){const Z=this.freqData[H];b+=Z,H<f&&(U+=Z),H<_?R+=Z:H<w?d+=Z:H<E?I+=Z:T+=Z}const O=b/(n*255),A=U/(Math.max(1,f)*255),v=R/(Math.max(1,_)*255),L=d/(Math.max(1,w-_)*255),P=I/(Math.max(1,E-w)*255),$=T/(Math.max(1,n-E)*255);this.energy=Re(this.energy,O,this.smoothing),this.treble=Re(this.treble,$,this.smoothing),this.highs=Re(this.highs,P,this.smoothing),this.mids=Re(this.mids,L,this.smoothing),this.lows=Re(this.lows,v,this.smoothing),this.bass=Re(this.bass,A,this.smoothing);const X=Math.max(0,e);return this.beatValue=Math.max(0,this.beatValue-X*this.beatFalloff),v>this.beatCutoff&&v>this.beatMin&&(this.beatValue=xt(v*1.5,0,1),this.beatCutoff=v*1.1,this.beatHold=this.beatHoldTime),this.beatHold>0?this.beatHold-=X:this.beatCutoff=Math.max(this.beatMin,this.beatCutoff-X*this.beatDecay),{energy:this.energy,treble:this.treble,highs:this.highs,mids:this.mids,lows:this.lows,bass:this.bass,beat:this.beatValue}}getEmptyMetrics(){return{energy:0,treble:0,highs:0,mids:0,lows:0,bass:0,beat:0}}isInitialized(){return this.analyser!==null}}const Qt={energy:0,treble:0,bass:0,mids:0,highs:0,lows:0,beat:0},Jt={sensitivity:1,highsBoost:1,midsBoost:1,lowsBoost:1,trebleBoost:1,bassBoost:1,beatBoost:1,minMotion:.02,beatGate:.35,autoEnabled:!1,autoStrength:.4,autoDecay:.6,autoTarget:"all"},zt=Le(Qt),le=Le(Jt),xe=Le(!1),Nt=Le(0);function fe(i,e,n){return Math.min(Math.max(i,e),n)}const Qe=Ke([zt,le,Nt],([i,e,n])=>{const t=fe(e.sensitivity,0,2);let a=fe(i.energy*t,0,2),l=fe(i.treble*t*e.trebleBoost,0,2),r=fe(i.beat*t*e.beatBoost*e.bassBoost,0,2);const o=(e.highsBoost+e.midsBoost+e.lowsBoost)/3;if(a*=o,a=Math.max(a,e.minMotion),l=Math.max(l,e.minMotion),r=Math.max(r,e.minMotion),e.autoEnabled&&n>0){const s=n*e.autoStrength;switch(e.autoTarget){case"energy":a+=s;break;case"treble":l+=s;break;case"beat":r+=s;break;default:a+=s,l+=s,r+=s}}return{energy:fe(a,0,2),treble:fe(l,0,2),beat:fe(r,0,2),raw:{highs:fe(i.highs*t,0,2),mids:fe(i.mids*t,0,2),lows:fe(i.lows*t,0,2),treble:fe(i.treble*t,0,2),bass:fe(i.bass*t,0,2),beat:fe(i.beat*t,0,2)}}});function ei(){const i=new Map;for(const e of Be){const n={};for(const t of e.properties)n[t.id]=t.default;i.set(e.id,{id:e.id,enabled:!1,properties:n,includeInRandomizer:e.randomizable!==!1,includeInStrobe:e.randomizable!==!1})}return i}const Ee=Le(ei());function ft(i,e,n){Ee.update(t=>{const a=t.get(i);return a&&(a.properties[e]=n),t})}function ti(i){Ee.update(e=>{const n=e.get(i);if(n&&(n.enabled=!n.enabled,n.enabled)){const a=Be.find(l=>l.id===i)?.properties.find(l=>l.id==="intensity");a&&(n.properties.intensity=a.default)}return e})}function ii(i){Ee.update(e=>{const n=e.get(i);return n&&(n.includeInRandomizer=!n.includeInRandomizer),e})}function ni(i){Ee.update(e=>{const n=e.get(i);return n&&(n.includeInStrobe=!n.includeInStrobe),e})}function ai(i){Ee.update(e=>{for(const n of e.values())if(n.enabled=i,i){const a=Be.find(l=>l.id===n.id)?.properties.find(l=>l.id==="intensity");a&&(n.properties.intensity=a.default)}return e})}const li=Ke([Ee,Qe],([i,e])=>{const n={};for(const t of Be){const a=i.get(t.id);if(a){for(const l of t.properties){let r=a.properties[l.id]??l.default;l.id==="intensity"&&!a.enabled&&(r=0),n[l.uniform]=r}for(const l of t.audioBindings)if(e[l.audioMetric],t.properties.find(o=>o.id===l.targetProperty)){const o=t.properties.find(s=>s.id==="sensitivity");o&&(n[o.uniform]=a.properties.sensitivity??1)}}}return n}),si={panelsVisible:!0,fullscreen:!1,pipEnabled:!1,powerSaverEnabled:!1,randomizerEnabled:!0,randomizerCooldown:2,randomizerTogglesLayers:!0,randomizerToggleChance:.3},ae=Le(si);function ri(){ae.update(i=>({...i,panelsVisible:!i.panelsVisible}))}function oi(){ae.update(i=>({...i,powerSaverEnabled:!i.powerSaverEnabled}))}function ui(){ae.update(i=>({...i,randomizerEnabled:!i.randomizerEnabled}))}function fi(){ae.update(i=>({...i,randomizerTogglesLayers:!i.randomizerTogglesLayers}))}const Je=[{id:0,label:"LSD (Rainbow)",preview:"linear-gradient(90deg, #ff0000, #ff8800, #ffff00, #00ff00, #00ffff, #0088ff, #8800ff, #ff00ff)",brightness:"bright",temperature:"neutral",saturation:"high",family:"spectrum"},{id:1,label:"Sunset",preview:"linear-gradient(90deg, #ff2e1f, #ff8c1f, #ffd940)",brightness:"bright",temperature:"warm",saturation:"high",family:"fire"},{id:2,label:"Aurora",preview:"linear-gradient(90deg, #0dd9b3, #1a59ff, #8ce6ff)",brightness:"medium",temperature:"cool",saturation:"high",family:"ocean"},{id:3,label:"Ultraviolet",preview:"linear-gradient(90deg, #8c26ff, #ff33bf, #3366ff)",brightness:"medium",temperature:"cool",saturation:"high",family:"cosmic"},{id:4,label:"Neon",preview:"linear-gradient(90deg, #1aff73, #ff1ad9)",brightness:"bright",temperature:"neutral",saturation:"high",family:"neon"},{id:5,label:"Split Complement",preview:"linear-gradient(90deg, #14d1ff, #ff7333, #cc33ff)",brightness:"bright",temperature:"neutral",saturation:"high",family:"spectrum"},{id:6,label:"Analogous Cool",preview:"linear-gradient(90deg, #14e6bf, #268cff, #6640ff)",brightness:"medium",temperature:"cool",saturation:"high",family:"ocean"},{id:7,label:"Tetradic",preview:"linear-gradient(90deg, #ff4d59, #33e699, #4073ff, #ffd933)",brightness:"bright",temperature:"neutral",saturation:"high",family:"spectrum"},{id:8,label:"Pastel Triad",preview:"linear-gradient(90deg, #e6a3a3, #a3e6b8, #a3b8e6)",brightness:"medium",temperature:"neutral",saturation:"low",family:"twilight"},{id:9,label:"Bioluminescent",preview:"linear-gradient(90deg, #001426, #00a3cc, #4dff99, #004066)",brightness:"dark",temperature:"cool",saturation:"medium",family:"ocean"},{id:10,label:"Iridescent",preview:"linear-gradient(90deg, #1a004d, #0080a6, #e6338c, #ffcc33, #33e666)",brightness:"medium",temperature:"neutral",saturation:"medium",family:"twilight"},{id:11,label:"Chromatic",preview:"linear-gradient(90deg, #ff0066, #00ff88, #0066ff, #ff0066)",brightness:"bright",temperature:"neutral",saturation:"high",family:"neon"},{id:12,label:"Golden Liminal",preview:"linear-gradient(90deg, #ffbf4d, #d9738c, #664db3, #261a59)",brightness:"medium",temperature:"warm",saturation:"medium",family:"twilight"},{id:13,label:"OK Rainbow",preview:"linear-gradient(90deg, #ff6b8a, #e6a040, #8fbf40, #40bfbf, #6b8aff, #bf40bf)",brightness:"medium",temperature:"neutral",saturation:"medium",family:"spectrum"},{id:14,label:"Synesthetic",preview:"linear-gradient(90deg, #7733ff, #cc33cc, #ff33aa, #ff66cc)",brightness:"medium",temperature:"cool",saturation:"high",family:"cosmic"},{id:15,label:"Entropy",preview:"linear-gradient(90deg, #00ffff, #1a0033, #ff4d00, #00cc33)",brightness:"medium",temperature:"neutral",saturation:"high",family:"neon"},{id:16,label:"Velvet Depths",preview:"linear-gradient(90deg, #1f142e, #8c59a6, #e6d9f2, #402659)",brightness:"dark",temperature:"cool",saturation:"low",family:"cosmic"},{id:17,label:"Solar Flare",preview:"linear-gradient(90deg, #1a0000, #cc1a00, #ff9900, #ffffb3)",brightness:"bright",temperature:"warm",saturation:"high",family:"fire"},{id:18,label:"Void Pulse",preview:"linear-gradient(90deg, #000000, #660019, #cc3366, #000000)",brightness:"dark",temperature:"warm",saturation:"low",family:"cosmic"},{id:19,label:"Starless Night",preview:"linear-gradient(90deg, #050a14, #1a3a66, #050a14)",brightness:"dark",temperature:"cool",saturation:"low",family:"ocean"},{id:20,label:"Event Horizon",preview:"linear-gradient(90deg, #000000, #000000, #ff6619, #99ccff, #000000)",brightness:"dark",temperature:"neutral",saturation:"medium",family:"cosmic"}],ci={spectrum:[0,5,7,13],fire:[1,12,17,18],ocean:[2,6,9,19],cosmic:[3,14,16,18,20],neon:[4,11,15],twilight:[8,10,12]};function He(i){return Je.find(e=>e.id===i)}const di={dark:.2,medium:.5,bright:1},ct=Le({lastChangeTime:0,cooldown:2}),dt=2.5;function je(i,e){return i+Math.random()*(e-i)}function $t(i,e){return Math.floor(Math.random()*(e-i+1))+i}function Ye(i){if(i.length===0)throw new Error("randomChoice called with empty array");return i[$t(0,i.length-1)]}function mi(i,e){let n=0;for(const[t,a]of i)if(a.enabled&&t!==e){const l=He(a.properties.theme);l&&(n+=di[l.brightness])}return n}function hi(i){return Je.filter(e=>i.includes(e.brightness))}function pi(i,e){const n={};for(const[l,r]of i)if(r.enabled&&l!==e){const o=He(r.properties.theme);o&&(n[o.family]=(n[o.family]||0)+1)}let t=0,a=null;for(const[l,r]of Object.entries(n))r>t&&(t=r,a=l);return a}function gi(i,e){const n=mi(i,e),t=pi(i,e);let a;n>=dt?a=["dark"]:n>=dt-.5?a=["dark","medium"]:a=["dark","medium","bright"];const l=hi(a);if(l.length===0)return 0;if(t&&Math.random()<.5){const r=ci[t],o=l.filter(s=>r.includes(s.id));if(o.length>0)return Ye(o).id}if(Math.random()<.3){const r=new Set;for(const[o,s]of i)if(s.enabled&&o!==e){const f=He(s.properties.theme);f&&r.add(f.temperature)}if(r.size===1){const o=[...r][0];let s=null;if(o==="warm"?s="cool":o==="cool"&&(s="warm"),s){const f=l.filter(u=>u.temperature===s);if(f.length>0)return Ye(f).id}}}return Ye(l).id}function bi(i){const e=He(i);if(!e)return{min:.3,max:.7};switch(e.brightness){case"dark":return{min:.5,max:.9};case"medium":return{min:.3,max:.7};case"bright":return{min:.2,max:.5}}}function vi(i){const e=Ge(ae);if(!e.randomizerEnabled)return;const n=Ge(ct),t=performance.now()/1e3;if(t-n.lastChangeTime<e.randomizerCooldown||i<.6)return;const a=Ge(Ee),l=Be.filter(s=>{const f=a.get(s.id);return s.randomizable!==!1&&(f?.includeInRandomizer||f?.includeInStrobe)});if(l.length===0)return;const r=l[$t(0,l.length-1)];a.get(r.id)&&(Ee.update(s=>{const f=s.get(r.id);if(!f)return s;if(e.randomizerTogglesLayers&&f.includeInStrobe&&Math.random()<e.randomizerToggleChance&&(f.enabled=!f.enabled),f.enabled&&f.includeInRandomizer){const u=gi(s,r.id);f.properties.theme=u;const c=bi(u);f.properties.intensity=je(c.min,c.max),f.properties.zoom=je(.7,2.5),f.properties.sensitivity=je(.5,1.5)}return s}),ct.update(s=>({...s,lastChangeTime:t})))}const yi={position:{x:.5,y:.5},velocity:{x:0,y:0},speed:0,isDown:!1,clickPosition:{x:.5,y:.5},isInside:!1},Xe=Le(yi),mt=.15,_i=.1;let Ie={x:0,y:0},We=0;function Me(i,e,n){return Math.min(Math.max(i,e),n)}const wi=Ke(Xe,i=>(Ie.x+=(i.velocity.x-Ie.x)*mt,Ie.y+=(i.velocity.y-Ie.y)*mt,We+=(i.speed-We)*_i,{x:i.position.x,y:i.position.y,velocityX:Me(Ie.x,-1,1),velocityY:Me(Ie.y,-1,1),speed:Me(We,0,1),down:i.isDown?1:0,clickX:i.clickPosition.x,clickY:i.clickPosition.y,inside:i.isInside?1:0}));function Ti(i,e,n,t){Xe.update(a=>{const l=Me((i-n.left)/n.width,0,1),r=Me((e-n.top)/n.height,0,1),o=Math.max(t,1),s=(l-a.position.x)/o*16.67,f=(r-a.position.y)/o*16.67,u=Math.sqrt(s*s+f*f);return{...a,position:{x:l,y:r},velocity:{x:s,y:f},speed:Me(u*10,0,1),isInside:!0}})}function Ei(i,e,n){Xe.update(t=>{const a=Me((i-n.left)/n.width,0,1),l=Me((e-n.top)/n.height,0,1);return{...t,isDown:!0,clickPosition:{x:a,y:l}}})}function ki(){Xe.update(i=>({...i,isDown:!1}))}function Si(){Xe.update(i=>({...i,isInside:!1,velocity:{x:0,y:0},speed:0}))}function Mi(i){let e,n,t;return{c(){e=M("canvas"),this.h()},l(a){e=S(a,"CANVAS",{class:!0,"aria-label":!0}),B(e).forEach(h),this.h()},h(){m(e,"class","visualizer-canvas svelte-1nin8xa"),m(e,"aria-label","Audio reactive canvas")},m(a,l){C(a,e,l),i[9](e),n||(t=[Q(e,"click",i[1]),Q(e,"touchend",i[2]),Q(e,"mousemove",i[3]),Q(e,"mousedown",i[4]),Q(e,"mouseup",i[5]),Q(e,"mouseleave",i[6])],n=!0)},p:me,i:me,o:me,d(a){a&&h(e),i[9](null),n=!1,Ae(t)}}}const Li=100,qe=32;function Bi(i,e,n){let t,a,l,r,o;pe(i,li,g=>n(20,t=g)),pe(i,wi,g=>n(21,a=g)),pe(i,Qe,g=>n(22,l=g)),pe(i,le,g=>n(23,r=g)),pe(i,ae,g=>n(24,o=g));let s,f=null,u=null,c,p=0,_=0,w=0;const E=1e3/30;let b=null,U=null,R=null;function d(){b=document.createElement("canvas"),b.width=qe,b.height=qe,U=b.getContext("2d"),R=document.querySelector('link[rel="icon"]'),R||(R=document.createElement("link"),R.rel="icon",R.type="image/png",document.head.appendChild(R))}function I(g){if(!b||!U||!R||!s||g-w<Li)return;w=g;const z=Math.min(s.width,s.height),te=(s.width-z)/2,ne=(s.height-z)/2;U.drawImage(s,te,ne,z,z,0,0,qe,qe);try{R.href=b.toDataURL("image/png")}catch{}}async function T(){u||(u=new Kt);const g=await u.init();return xe.set(g),g}function O(){u&&(u.dispose(),u=null),xe.set(!1)}function A(g){if(c=requestAnimationFrame(A),o.powerSaverEnabled&&g-p<E)return;const z=(g-p)/1e3;if(p=g,u?.isInitialized()){const te=u.update(z);zt.set(te);const ne=r.beatGate,J=te.beat>ne;Nt.update(ve=>{if(r.autoEnabled){if(J)return 1;const ye=.5+r.autoDecay*3.5;return Math.max(0,ve-z*ye)}return 0}),vi(te.beat)}f?.isInitialized()&&(f.render(g/1e3,l,a,t),I(g))}Dt(async()=>{f=new Wt(s),await f.init()&&(p=performance.now(),d(),c=requestAnimationFrame(A))}),Zt(()=>{c&&cancelAnimationFrame(c),f&&f.dispose(),u&&u.dispose()});function v(){ae.update(g=>({...g,panelsVisible:!g.panelsVisible}))}let L=0;function P(g){const z=Date.now();z-L<300&&$(),L=z}async function $(){document.fullscreenElement?(await document.exitFullscreen(),ae.update(g=>({...g,fullscreen:!1}))):(await document.documentElement.requestFullscreen(),ae.update(g=>({...g,fullscreen:!0})))}function X(g){if(!s)return;const z=performance.now(),te=z-_;_=z;const ne=s.getBoundingClientRect();Ti(g.clientX,g.clientY,ne,te)}function H(g){if(!s)return;const z=s.getBoundingClientRect();Ei(g.clientX,g.clientY,z)}function Z(){ki()}function ee(){Si()}function D(g){oe[g?"unshift":"push"](()=>{s=g,n(0,s)})}return[s,v,P,X,H,Z,ee,T,O,D]}class Ri extends we{constructor(e){super(),Te(this,e,Bi,Mi,_e,{enableMicrophone:7,disableMicrophone:8})}get enableMicrophone(){return this.$$.ctx[7]}get disableMicrophone(){return this.$$.ctx[8]}}function ht(i){let e,n=i[6](i[0])+"",t;return{c(){e=M("span"),t=re(n),this.h()},l(a){e=S(a,"SPAN",{class:!0});var l=B(e);t=se(l,n),l.forEach(h),this.h()},h(){m(e,"class","slider-value svelte-13dvwfr")},m(a,l){C(a,e,l),y(e,t)},p(a,l){l&65&&n!==(n=a[6](a[0])+"")&&ge(t,n)},d(a){a&&h(e)}}}function Ii(i){let e,n,t,a,l,r,o,s,f,u=i[5]&&ht(i);return{c(){e=M("div"),n=M("div"),t=M("span"),a=re(i[1]),l=V(),u&&u.c(),r=V(),o=M("input"),this.h()},l(c){e=S(c,"DIV",{class:!0});var p=B(e);n=S(p,"DIV",{class:!0});var _=B(n);t=S(_,"SPAN",{class:!0});var w=B(t);a=se(w,i[1]),w.forEach(h),l=F(_),u&&u.l(_),_.forEach(h),r=F(p),o=S(p,"INPUT",{type:!0,min:!0,max:!0,step:!0,"aria-label":!0,class:!0}),p.forEach(h),this.h()},h(){m(t,"class","slider-label svelte-13dvwfr"),m(n,"class","slider-header svelte-13dvwfr"),m(o,"type","range"),m(o,"min",i[2]),m(o,"max",i[3]),m(o,"step",i[4]),o.value=i[0],m(o,"aria-label",i[1]),m(o,"class","svelte-13dvwfr"),m(e,"class","slider svelte-13dvwfr"),G(e,"compact",i[7])},m(c,p){C(c,e,p),y(e,n),y(n,t),y(t,a),y(n,l),u&&u.m(n,null),y(e,r),y(e,o),s||(f=Q(o,"input",i[8]),s=!0)},p(c,[p]){p&2&&ge(a,c[1]),c[5]?u?u.p(c,p):(u=ht(c),u.c(),u.m(n,null)):u&&(u.d(1),u=null),p&4&&m(o,"min",c[2]),p&8&&m(o,"max",c[3]),p&16&&m(o,"step",c[4]),p&1&&(o.value=c[0]),p&2&&m(o,"aria-label",c[1]),p&128&&G(e,"compact",c[7])},i:me,o:me,d(c){c&&h(e),u&&u.d(),s=!1,f()}}}function Di(i,e,n){let{label:t}=e,{value:a}=e,{min:l=0}=e,{max:r=1}=e,{step:o=.01}=e,{showValue:s=!0}=e,{formatValue:f=_=>_.toFixed(2)}=e,{compact:u=!0}=e;const c=Pt();function p(_){const w=_.target;n(0,a=parseFloat(w.value)),c("input",a)}return i.$$set=_=>{"label"in _&&n(1,t=_.label),"value"in _&&n(0,a=_.value),"min"in _&&n(2,l=_.min),"max"in _&&n(3,r=_.max),"step"in _&&n(4,o=_.step),"showValue"in _&&n(5,s=_.showValue),"formatValue"in _&&n(6,f=_.formatValue),"compact"in _&&n(7,u=_.compact)},[a,t,l,r,o,s,f,u,p]}class he extends we{constructor(e){super(),Te(this,e,Di,Ii,_e,{label:1,value:0,min:2,max:3,step:4,showValue:5,formatValue:6,compact:7})}}function Pi(i){let e,n,t,a,l,r,o;return{c(){e=M("button"),n=M("span"),t=V(),a=M("span"),l=re(i[1]),this.h()},l(s){e=S(s,"BUTTON",{class:!0,"aria-pressed":!0,type:!0});var f=B(e);n=S(f,"SPAN",{class:!0}),B(n).forEach(h),t=F(f),a=S(f,"SPAN",{class:!0});var u=B(a);l=se(u,i[1]),u.forEach(h),f.forEach(h),this.h()},h(){m(n,"class","toggle-indicator svelte-1qxicao"),m(a,"class","toggle-label svelte-1qxicao"),m(e,"class","toggle svelte-1qxicao"),m(e,"aria-pressed",i[0]),e.disabled=i[2],m(e,"type","button"),G(e,"checked",i[0]),G(e,"disabled",i[2]),G(e,"compact",i[3])},m(s,f){C(s,e,f),y(e,n),y(e,t),y(e,a),y(a,l),r||(o=Q(e,"click",i[4]),r=!0)},p(s,[f]){f&2&&ge(l,s[1]),f&1&&m(e,"aria-pressed",s[0]),f&4&&(e.disabled=s[2]),f&1&&G(e,"checked",s[0]),f&4&&G(e,"disabled",s[2]),f&8&&G(e,"compact",s[3])},i:me,o:me,d(s){s&&h(e),r=!1,o()}}}function Ai(i,e,n){let{label:t}=e,{checked:a=!1}=e,{disabled:l=!1}=e,{compact:r=!0}=e;function o(){l||n(0,a=!a)}return i.$$set=s=>{"label"in s&&n(1,t=s.label),"checked"in s&&n(0,a=s.checked),"disabled"in s&&n(2,l=s.disabled),"compact"in s&&n(3,r=s.compact)},[a,t,l,r,o]}class Ui extends we{constructor(e){super(),Te(this,e,Ai,Pi,_e,{label:1,checked:0,disabled:2,compact:3})}}function pt(i,e,n){const t=i.slice();return t[8]=e[n],t}function gt(i){let e;return{c(){e=M("span"),this.h()},l(n){e=S(n,"SPAN",{class:!0,style:!0}),B(e).forEach(h),this.h()},h(){m(e,"class","select-preview svelte-1weciec"),Oe(e,"background",i[2].find(i[6])?.preview)},m(n,t){C(n,e,t)},p(n,t){t&5&&Oe(e,"background",n[2].find(n[6])?.preview)},d(n){n&&h(e)}}}function bt(i){let e,n=i[8].label+"",t,a;return{c(){e=M("option"),t=re(n),this.h()},l(l){e=S(l,"OPTION",{});var r=B(e);t=se(r,n),r.forEach(h),this.h()},h(){e.__value=a=i[8].value,st(e,e.__value)},m(l,r){C(l,e,r),y(e,t)},p(l,r){r&4&&n!==(n=l[8].label+"")&&ge(t,n),r&4&&a!==(a=l[8].value)&&(e.__value=a,st(e,e.__value))},d(l){l&&h(e)}}}function Ci(i){let e,n,t,a,l,r=i[2].find(i[5])?.preview,o,s,f,u,c=r&&gt(i),p=Pe(i[2]),_=[];for(let w=0;w<p.length;w+=1)_[w]=bt(pt(i,p,w));return{c(){e=M("div"),n=M("span"),t=re(i[1]),a=V(),l=M("div"),c&&c.c(),o=V(),s=M("select");for(let w=0;w<_.length;w+=1)_[w].c();this.h()},l(w){e=S(w,"DIV",{class:!0});var E=B(e);n=S(E,"SPAN",{class:!0});var b=B(n);t=se(b,i[1]),b.forEach(h),a=F(E),l=S(E,"DIV",{class:!0});var U=B(l);c&&c.l(U),o=F(U),s=S(U,"SELECT",{"aria-label":!0,class:!0});var R=B(s);for(let d=0;d<_.length;d+=1)_[d].l(R);R.forEach(h),U.forEach(h),E.forEach(h),this.h()},h(){m(n,"class","select-label svelte-1weciec"),m(s,"aria-label",i[1]),m(s,"class","svelte-1weciec"),m(l,"class","select-container svelte-1weciec"),m(e,"class","select-wrapper svelte-1weciec"),G(e,"compact",i[3])},m(w,E){C(w,e,E),y(e,n),y(n,t),y(e,a),y(e,l),c&&c.m(l,null),y(l,o),y(l,s);for(let b=0;b<_.length;b+=1)_[b]&&_[b].m(s,null);lt(s,i[0]),f||(u=Q(s,"change",i[4]),f=!0)},p(w,[E]){if(E&2&&ge(t,w[1]),E&5&&(r=w[2].find(w[5])?.preview),r?c?c.p(w,E):(c=gt(w),c.c(),c.m(l,o)):c&&(c.d(1),c=null),E&4){p=Pe(w[2]);let b;for(b=0;b<p.length;b+=1){const U=pt(w,p,b);_[b]?_[b].p(U,E):(_[b]=bt(U),_[b].c(),_[b].m(s,null))}for(;b<_.length;b+=1)_[b].d(1);_.length=p.length}E&5&&lt(s,w[0]),E&2&&m(s,"aria-label",w[1]),E&8&&G(e,"compact",w[3])},i:me,o:me,d(w){w&&h(e),c&&c.d(),jt(_,w),f=!1,u()}}}function Fi(i,e,n){let{label:t}=e,{value:a}=e,{options:l=[]}=e,{compact:r=!0}=e;const o=Pt();function s(c){const p=c.target;n(0,a=isNaN(Number(p.value))?p.value:Number(p.value)),o("change",a)}const f=c=>c.value===a,u=c=>c.value===a;return i.$$set=c=>{"label"in c&&n(1,t=c.label),"value"in c&&n(0,a=c.value),"options"in c&&n(2,l=c.options),"compact"in c&&n(3,r=c.compact)},[a,t,l,r,s,f,u]}class Xt extends we{constructor(e){super(),Te(this,e,Fi,Ci,_e,{label:1,value:0,options:2,compact:3})}}function Vi(i){let e,n,t,a,l,r,o,s,f;return{c(){e=M("div"),n=M("span"),t=re(i[0]),a=V(),l=M("div"),r=M("div"),o=V(),s=M("span"),f=re(i[1]),this.h()},l(u){e=S(u,"DIV",{class:!0});var c=B(e);n=S(c,"SPAN",{class:!0});var p=B(n);t=se(p,i[0]),p.forEach(h),a=F(c),l=S(c,"DIV",{class:!0});var _=B(l);r=S(_,"DIV",{class:!0,style:!0}),B(r).forEach(h),_.forEach(h),o=F(c),s=S(c,"SPAN",{class:!0});var w=B(s);f=se(w,i[1]),w.forEach(h),c.forEach(h),this.h()},h(){m(n,"class","level-label svelte-2vktfp"),m(r,"class","level-fill svelte-2vktfp"),Oe(r,"width",i[2]+"%"),m(l,"class","level-bar svelte-2vktfp"),m(s,"class","level-value svelte-2vktfp"),m(e,"class","level-meter svelte-2vktfp")},m(u,c){C(u,e,c),y(e,n),y(n,t),y(e,a),y(e,l),y(l,r),y(e,o),y(e,s),y(s,f)},p(u,[c]){c&1&&ge(t,u[0]),c&4&&Oe(r,"width",u[2]+"%"),c&2&&ge(f,u[1])},i:me,o:me,d(u){u&&h(e)}}}function zi(i,e,n){let t,a,{label:l}=e,{value:r=0}=e,{max:o=1}=e;return i.$$set=s=>{"label"in s&&n(0,l=s.label),"value"in s&&n(3,r=s.value),"max"in s&&n(4,o=s.max)},i.$$.update=()=>{i.$$.dirty&24&&n(2,t=Math.min(100,r/o*100)),i.$$.dirty&8&&n(1,a=r.toFixed(2))},[l,a,t,r,o]}class De extends we{constructor(e){super(),Te(this,e,zi,Vi,_e,{label:0,value:3,max:4})}}function vt(i){let e,n,t='<span class="panel-title svelte-60ik2m">CONTROLS</span>',a,l,r,o,s,f,u,c,p='<span class="label">FULLSCR</span>',_,w,E='<span class="label">PWR SAV</span>',b,U,R='<kbd class="svelte-60ik2m">C</kbd> hide/show panels <kbd class="svelte-60ik2m">F</kbd> fullscreen',d,I;function T(v,L){return v[1]?Xi:v[2]?$i:Ni}let O=T(i),A=O(i);return{c(){e=M("div"),n=M("div"),n.innerHTML=t,a=V(),l=M("div"),r=M("button"),o=M("span"),s=V(),f=M("span"),A.c(),u=V(),c=M("button"),c.innerHTML=p,_=V(),w=M("button"),w.innerHTML=E,b=V(),U=M("div"),U.innerHTML=R,this.h()},l(v){e=S(v,"DIV",{class:!0});var L=B(e);n=S(L,"DIV",{class:!0,"data-svelte-h":!0}),be(n)!=="svelte-i65zl2"&&(n.innerHTML=t),a=F(L),l=S(L,"DIV",{class:!0});var P=B(l);r=S(P,"BUTTON",{class:!0,title:!0});var $=B(r);o=S($,"SPAN",{class:!0}),B(o).forEach(h),s=F($),f=S($,"SPAN",{class:!0});var X=B(f);A.l(X),X.forEach(h),$.forEach(h),u=F(P),c=S(P,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),be(c)!=="svelte-1xg66l0"&&(c.innerHTML=p),_=F(P),w=S(P,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),be(w)!=="svelte-e1kxas"&&(w.innerHTML=E),P.forEach(h),b=F(L),U=S(L,"DIV",{class:!0,title:!0,"data-svelte-h":!0}),be(U)!=="svelte-1r8dk9l"&&(U.innerHTML=R),L.forEach(h),this.h()},h(){m(n,"class","panel-header svelte-60ik2m"),m(o,"class","indicator svelte-60ik2m"),G(o,"on",i[2]),m(f,"class","label"),m(r,"class","ctrl-btn mic svelte-60ik2m"),r.disabled=i[1],m(r,"title","Enable microphone to let visuals react to music and sounds around you"),G(r,"active",i[2]),G(r,"loading",i[1]),m(c,"class","ctrl-btn svelte-60ik2m"),m(c,"title","Enter or exit fullscreen mode for an immersive experience"),G(c,"active",i[3].fullscreen),m(w,"class","ctrl-btn svelte-60ik2m"),m(w,"title","Reduce frame rate to save battery and CPU on laptops"),G(w,"active",i[3].powerSaverEnabled),m(l,"class","controls-grid svelte-60ik2m"),m(U,"class","panel-footer svelte-60ik2m"),m(U,"title","Keyboard shortcuts for quick access"),m(e,"class","panel controls-panel svelte-60ik2m")},m(v,L){C(v,e,L),y(e,n),y(e,a),y(e,l),y(l,r),y(r,o),y(r,s),y(r,f),A.m(f,null),y(l,u),y(l,c),y(l,_),y(l,w),y(e,b),y(e,U),d||(I=[Q(r,"click",i[4]),Q(c,"click",i[5]),Q(w,"click",oi)],d=!0)},p(v,L){L&4&&G(o,"on",v[2]),O!==(O=T(v))&&(A.d(1),A=O(v),A&&(A.c(),A.m(f,null))),L&2&&(r.disabled=v[1]),L&4&&G(r,"active",v[2]),L&2&&G(r,"loading",v[1]),L&8&&G(c,"active",v[3].fullscreen),L&8&&G(w,"active",v[3].powerSaverEnabled)},d(v){v&&h(e),A.d(),d=!1,Ae(I)}}}function Ni(i){let e;return{c(){e=re("MIC OFF")},l(n){e=se(n,"MIC OFF")},m(n,t){C(n,e,t)},d(n){n&&h(e)}}}function $i(i){let e;return{c(){e=re("MIC ON")},l(n){e=se(n,"MIC ON")},m(n,t){C(n,e,t)},d(n){n&&h(e)}}}function Xi(i){let e;return{c(){e=re("...")},l(n){e=se(n,"...")},m(n,t){C(n,e,t)},d(n){n&&h(e)}}}function qi(i){let e,n=i[0]&&vt(i);return{c(){n&&n.c(),e=ue()},l(t){n&&n.l(t),e=ue()},m(t,a){n&&n.m(t,a),C(t,e,a)},p(t,[a]){t[0]?n?n.p(t,a):(n=vt(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:me,o:me,d(t){t&&h(e),n&&n.d(t)}}}function Oi(i,e,n){let t,a;pe(i,xe,u=>n(2,t=u)),pe(i,ae,u=>n(3,a=u));let{onEnableMic:l}=e,{visible:r=!0}=e,o=!1;async function s(){t||(n(1,o=!0),await l(),n(1,o=!1))}async function f(){document.fullscreenElement?(await document.exitFullscreen(),ae.update(u=>({...u,fullscreen:!1}))):(await document.documentElement.requestFullscreen(),ae.update(u=>({...u,fullscreen:!0})))}return i.$$set=u=>{"onEnableMic"in u&&n(6,l=u.onEnableMic),"visible"in u&&n(0,r=u.visible)},[r,o,t,a,s,f,l]}class Hi extends we{constructor(e){super(),Te(this,e,Oi,qi,_e,{onEnableMic:6,visible:0})}}function yt(i,e,n){const t=i.slice();return t[16]=e[n].definition,t[17]=e[n].state,t}function _t(i,e,n){const t=i.slice();return t[20]=e[n],t}function wt(i){let e,n,t,a,l,r,o,s="LAYERS",f,u,c=i[1].filter(Mt).length+"",p,_,w=i[1].length+"",E,b,U,R,d="RANDOM",I,T,O="STROBE",A,v,L=[],P=new Map,$,X,H,Z=Pe(i[1]);const ee=D=>D[16].id;for(let D=0;D<Z.length;D+=1){let g=yt(i,Z,D),z=ee(g);P.set(z,L[D]=St(z,g))}return{c(){e=M("div"),n=M("div"),t=M("button"),a=M("span"),r=V(),o=M("span"),o.textContent=s,f=V(),u=M("span"),p=re(c),_=re("/"),E=re(w),b=V(),U=M("div"),R=M("button"),R.textContent=d,I=V(),T=M("button"),T.textContent=O,A=V(),v=M("div");for(let D=0;D<L.length;D+=1)L[D].c();this.h()},l(D){e=S(D,"DIV",{class:!0});var g=B(e);n=S(g,"DIV",{class:!0});var z=B(n);t=S(z,"BUTTON",{class:!0,title:!0,type:!0});var te=B(t);a=S(te,"SPAN",{class:!0}),B(a).forEach(h),te.forEach(h),r=F(z),o=S(z,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),be(o)!=="svelte-1k3t9ew"&&(o.textContent=s),f=F(z),u=S(z,"SPAN",{class:!0,title:!0});var ne=B(u);p=se(ne,c),_=se(ne,"/"),E=se(ne,w),ne.forEach(h),z.forEach(h),b=F(g),U=S(g,"DIV",{class:!0});var J=B(U);R=S(J,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),be(R)!=="svelte-oljq6x"&&(R.textContent=d),I=F(J),T=S(J,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),be(T)!=="svelte-1j3wa1w"&&(T.textContent=O),J.forEach(h),A=F(g),v=S(g,"DIV",{class:!0});var ve=B(v);for(let ye=0;ye<L.length;ye+=1)L[ye].l(ve);ve.forEach(h),g.forEach(h),this.h()},h(){m(a,"class","master-indicator svelte-19n2guw"),m(t,"class","master-toggle svelte-19n2guw"),m(t,"title",l=i[3]?"Turn off all layers":"Turn on all layers"),m(t,"type","button"),G(t,"active",i[3]),m(o,"class","panel-title svelte-19n2guw"),m(o,"title","Visual effect layers - toggle and customize each one"),m(u,"class","panel-count svelte-19n2guw"),m(u,"title","Number of active layers"),m(n,"class","panel-header svelte-19n2guw"),m(R,"class","global-btn svelte-19n2guw"),m(R,"title","Automatically change visual settings on every beat for variety"),m(R,"type","button"),G(R,"active",i[4].randomizerEnabled),m(T,"class","global-btn strobe svelte-19n2guw"),m(T,"title","Flash layers on/off with the beat for a strobe-like effect"),m(T,"type","button"),G(T,"active",i[4].randomizerTogglesLayers),m(U,"class","global-controls svelte-19n2guw"),m(v,"class","layer-list svelte-19n2guw"),m(e,"class","panel layers-panel svelte-19n2guw")},m(D,g){C(D,e,g),y(e,n),y(n,t),y(t,a),y(n,r),y(n,o),y(n,f),y(n,u),y(u,p),y(u,_),y(u,E),y(e,b),y(e,U),y(U,R),y(U,I),y(U,T),y(e,A),y(e,v);for(let z=0;z<L.length;z+=1)L[z]&&L[z].m(v,null);$=!0,X||(H=[Q(t,"click",i[5]),Q(R,"click",ui),Q(T,"click",fi)],X=!0)},p(D,g){(!$||g&8&&l!==(l=D[3]?"Turn off all layers":"Turn on all layers"))&&m(t,"title",l),(!$||g&8)&&G(t,"active",D[3]),(!$||g&2)&&c!==(c=D[1].filter(Mt).length+"")&&ge(p,c),(!$||g&2)&&w!==(w=D[1].length+"")&&ge(E,w),(!$||g&16)&&G(R,"active",D[4].randomizerEnabled),(!$||g&16)&&G(T,"active",D[4].randomizerTogglesLayers),g&198&&(Z=Pe(D[1]),ke(),L=Ct(L,g,ee,1,D,Z,P,v,Ut,St,null,yt),Se())},i(D){if(!$){for(let g=0;g<Z.length;g+=1)N(L[g]);$=!0}},o(D){for(let g=0;g<L.length;g+=1)q(L[g]);$=!1},d(D){D&&h(e);for(let g=0;g<L.length;g+=1)L[g].d();X=!1,Ae(H)}}}function Tt(i){let e,n="R",t,a,l="S",r,o;function s(){return i[11](i[16])}function f(){return i[12](i[16])}return{c(){e=M("button"),e.textContent=n,t=V(),a=M("button"),a.textContent=l,this.h()},l(u){e=S(u,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),be(e)!=="svelte-mwgvpg"&&(e.textContent=n),t=F(u),a=S(u,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),be(a)!=="svelte-v7hsdo"&&(a.textContent=l),this.h()},h(){m(e,"class","quick-btn svelte-19n2guw"),m(e,"title","Include in randomizer - properties (theme, intensity, zoom) will change automatically"),m(e,"type","button"),G(e,"active",i[17].includeInRandomizer),m(a,"class","quick-btn strobe-btn svelte-19n2guw"),m(a,"title","Include in strobe - layer can flash on/off with the beat"),m(a,"type","button"),G(a,"active",i[17].includeInStrobe)},m(u,c){C(u,e,c),C(u,t,c),C(u,a,c),r||(o=[Q(e,"click",s),Q(a,"click",f)],r=!0)},p(u,c){i=u,c&2&&G(e,"active",i[17].includeInRandomizer),c&2&&G(a,"active",i[17].includeInStrobe)},d(u){u&&(h(e),h(t),h(a)),r=!1,Ae(o)}}}function Et(i){let e,n=[],t=new Map,a,l=Pe(i[16].properties);const r=o=>o[20].id;for(let o=0;o<l.length;o+=1){let s=_t(i,l,o),f=r(s);t.set(f,n[o]=kt(f,s))}return{c(){e=M("div");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=S(o,"DIV",{class:!0});var s=B(e);for(let f=0;f<n.length;f+=1)n[f].l(s);s.forEach(h),this.h()},h(){m(e,"class","layer-controls svelte-19n2guw")},m(o,s){C(o,e,s);for(let f=0;f<n.length;f+=1)n[f]&&n[f].m(e,null);a=!0},p(o,s){s&66&&(l=Pe(o[16].properties),ke(),n=Ct(n,s,r,1,o,l,t,e,Ut,kt,null,_t),Se())},i(o){if(!a){for(let s=0;s<l.length;s+=1)N(n[s]);a=!0}},o(o){for(let s=0;s<n.length;s+=1)q(n[s]);a=!1},d(o){o&&h(e);for(let s=0;s<n.length;s+=1)n[s].d()}}}function Gi(i){let e,n,t,a;function l(...r){return i[15](i[16],i[20],...r)}return n=new Xt({props:{label:"Thm",value:i[17].properties[i[20].id]??i[20].default,options:i[6]}}),n.$on("change",l),{c(){e=M("div"),K(n.$$.fragment),t=V(),this.h()},l(r){e=S(r,"DIV",{title:!0});var o=B(e);x(n.$$.fragment,o),t=F(o),o.forEach(h),this.h()},h(){m(e,"title","Color scheme for this visual effect")},m(r,o){C(r,e,o),W(n,e,null),y(e,t),a=!0},p(r,o){i=r;const s={};o&2&&(s.value=i[17].properties[i[20].id]??i[20].default),n.$set(s)},i(r){a||(N(n.$$.fragment,r),a=!0)},o(r){q(n.$$.fragment,r),a=!1},d(r){r&&h(e),Y(n)}}}function Zi(i){let e,n,t,a,l;function r(...o){return i[14](i[16],i[20],...o)}return n=new he({props:{label:i[20].label.slice(0,4),value:i[17].properties[i[20].id]??i[20].default,min:i[20].min??0,max:i[20].max??1,step:i[20].step??.01}}),n.$on("input",r),{c(){e=M("div"),K(n.$$.fragment),t=V(),this.h()},l(o){e=S(o,"DIV",{title:!0});var s=B(e);x(n.$$.fragment,s),t=F(s),s.forEach(h),this.h()},h(){m(e,"title",a=i[20].id==="intensity"?"How visible/strong this effect is":i[20].id==="zoom"?"Scale/size of the effect pattern":i[20].id==="sensitivity"?"How much this layer reacts to audio":i[20].label)},m(o,s){C(o,e,s),W(n,e,null),y(e,t),l=!0},p(o,s){i=o;const f={};s&2&&(f.label=i[20].label.slice(0,4)),s&2&&(f.value=i[17].properties[i[20].id]??i[20].default),s&2&&(f.min=i[20].min??0),s&2&&(f.max=i[20].max??1),s&2&&(f.step=i[20].step??.01),n.$set(f),(!l||s&2&&a!==(a=i[20].id==="intensity"?"How visible/strong this effect is":i[20].id==="zoom"?"Scale/size of the effect pattern":i[20].id==="sensitivity"?"How much this layer reacts to audio":i[20].label))&&m(e,"title",a)},i(o){l||(N(n.$$.fragment,o),l=!0)},o(o){q(n.$$.fragment,o),l=!1},d(o){o&&h(e),Y(n)}}}function kt(i,e){let n,t,a,l,r;const o=[Zi,Gi],s=[];function f(u,c){return u[20].type==="range"?0:u[20].type==="select"&&u[20].id==="theme"?1:-1}return~(t=f(e))&&(a=s[t]=o[t](e)),{key:i,first:null,c(){n=ue(),a&&a.c(),l=ue(),this.h()},l(u){n=ue(),a&&a.l(u),l=ue(),this.h()},h(){this.first=n},m(u,c){C(u,n,c),~t&&s[t].m(u,c),C(u,l,c),r=!0},p(u,c){e=u;let p=t;t=f(e),t===p?~t&&s[t].p(e,c):(a&&(ke(),q(s[p],1,1,()=>{s[p]=null}),Se()),~t?(a=s[t],a?a.p(e,c):(a=s[t]=o[t](e),a.c()),N(a,1),a.m(l.parentNode,l)):a=null)},i(u){r||(N(a),r=!0)},o(u){q(a),r=!1},d(u){u&&(h(n),h(l)),~t&&s[t].d(u)}}}function St(i,e){let n,t,a,l,r,o,s=e[16].label+"",f,u,c,p,_,w,E=e[2]===e[16].id?"":"+",b,U,R,d,I,T;function O(){return e[9](e[16])}function A(){return e[10](e[16])}let v=e[16].randomizable!==!1&&Tt(e);function L(){return e[13](e[16])}let P=e[2]===e[16].id&&Et(e);return{key:i,first:null,c(){n=M("div"),t=M("div"),a=M("button"),l=M("span"),r=V(),o=M("button"),f=re(s),c=V(),p=M("div"),v&&v.c(),_=V(),w=M("button"),b=re(E),U=V(),P&&P.c(),R=V(),this.h()},l($){n=S($,"DIV",{class:!0});var X=B(n);t=S(X,"DIV",{class:!0});var H=B(t);a=S(H,"BUTTON",{class:!0,type:!0,title:!0});var Z=B(a);l=S(Z,"SPAN",{class:!0}),B(l).forEach(h),Z.forEach(h),r=F(H),o=S(H,"BUTTON",{class:!0,type:!0,title:!0});var ee=B(o);f=se(ee,s),ee.forEach(h),c=F(H),p=S(H,"DIV",{class:!0});var D=B(p);v&&v.l(D),_=F(D),w=S(D,"BUTTON",{class:!0,type:!0,title:!0});var g=B(w);b=se(g,E),g.forEach(h),D.forEach(h),H.forEach(h),U=F(X),P&&P.l(X),R=F(X),X.forEach(h),this.h()},h(){m(l,"class","indicator svelte-19n2guw"),G(l,"active",e[17].enabled),m(a,"class","layer-toggle svelte-19n2guw"),m(a,"type","button"),m(a,"title","Turn this visual effect on or off"),m(o,"class","layer-name svelte-19n2guw"),m(o,"type","button"),m(o,"title",u=e[16].description+" - click to adjust settings"),m(w,"class","quick-btn expand-btn svelte-19n2guw"),m(w,"type","button"),m(w,"title","Expand to see detailed controls for this layer"),m(p,"class","layer-quick svelte-19n2guw"),m(t,"class","layer-row svelte-19n2guw"),m(n,"class","layer-item svelte-19n2guw"),G(n,"disabled",!e[17].enabled),G(n,"expanded",e[2]===e[16].id),this.first=n},m($,X){C($,n,X),y(n,t),y(t,a),y(a,l),y(t,r),y(t,o),y(o,f),y(t,c),y(t,p),v&&v.m(p,null),y(p,_),y(p,w),y(w,b),y(n,U),P&&P.m(n,null),y(n,R),d=!0,I||(T=[Q(a,"click",O),Q(o,"click",A),Q(w,"click",L)],I=!0)},p($,X){e=$,(!d||X&2)&&G(l,"active",e[17].enabled),(!d||X&2)&&s!==(s=e[16].label+"")&&ge(f,s),(!d||X&2&&u!==(u=e[16].description+" - click to adjust settings"))&&m(o,"title",u),e[16].randomizable!==!1?v?v.p(e,X):(v=Tt(e),v.c(),v.m(p,_)):v&&(v.d(1),v=null),(!d||X&6)&&E!==(E=e[2]===e[16].id?"":"+")&&ge(b,E),e[2]===e[16].id?P?(P.p(e,X),X&6&&N(P,1)):(P=Et(e),P.c(),N(P,1),P.m(n,R)):P&&(ke(),q(P,1,1,()=>{P=null}),Se()),(!d||X&2)&&G(n,"disabled",!e[17].enabled),(!d||X&6)&&G(n,"expanded",e[2]===e[16].id)},i($){d||(N(P),d=!0)},o($){q(P),d=!1},d($){$&&h(n),v&&v.d(),P&&P.d(),I=!1,Ae(T)}}}function ji(i){let e,n,t=i[0]&&wt(i);return{c(){t&&t.c(),e=ue()},l(a){t&&t.l(a),e=ue()},m(a,l){t&&t.m(a,l),C(a,e,l),n=!0},p(a,[l]){a[0]?t?(t.p(a,l),l&1&&N(t,1)):(t=wt(a),t.c(),N(t,1),t.m(e.parentNode,e)):t&&(ke(),q(t,1,1,()=>{t=null}),Se())},i(a){n||(N(t),n=!0)},o(a){q(t),n=!1},d(a){a&&h(e),t&&t.d(a)}}}const Mt=i=>i.state.enabled;function Yi(i,e,n){let t,a,l,r;pe(i,Ee,d=>n(8,l=d)),pe(i,ae,d=>n(4,r=d));let{visible:o=!0}=e,s=null;function f(){ai(!a)}const u=Je.map(d=>({value:d.id,label:d.label,preview:d.preview}));function c(d){n(2,s=s===d?null:d)}const p=d=>ti(d.id),_=d=>c(d.id),w=d=>ii(d.id),E=d=>ni(d.id),b=d=>c(d.id),U=(d,I,T)=>ft(d.id,I.id,T.detail),R=(d,I,T)=>ft(d.id,I.id,T.detail);return i.$$set=d=>{"visible"in d&&n(0,o=d.visible)},i.$$.update=()=>{i.$$.dirty&256&&n(1,t=Be.map(d=>({definition:d,state:l.get(d.id)})).filter(d=>d.state)),i.$$.dirty&2&&n(3,a=t.some(d=>d.state.enabled))},[o,t,s,a,r,f,u,c,l,p,_,w,E,b,U,R]}class Wi extends we{constructor(e){super(),Te(this,e,Yi,ji,_e,{visible:0})}}function Lt(i){let e,n,t='<span class="panel-title svelte-9wroah">LEVELS</span>',a,l,r,o,s,f,u,c,p,_,w,E,b,U,R,d,I,T,O,A;return o=new De({props:{label:"HI",value:i[1].raw.highs}}),u=new De({props:{label:"MD",value:i[1].raw.mids}}),_=new De({props:{label:"LO",value:i[1].raw.lows}}),b=new De({props:{label:"TR",value:i[1].raw.treble}}),d=new De({props:{label:"BS",value:i[1].raw.bass}}),O=new De({props:{label:"BT",value:i[1].raw.beat}}),{c(){e=M("div"),n=M("div"),n.innerHTML=t,a=V(),l=M("div"),r=M("div"),K(o.$$.fragment),s=V(),f=M("div"),K(u.$$.fragment),c=V(),p=M("div"),K(_.$$.fragment),w=V(),E=M("div"),K(b.$$.fragment),U=V(),R=M("div"),K(d.$$.fragment),I=V(),T=M("div"),K(O.$$.fragment),this.h()},l(v){e=S(v,"DIV",{class:!0});var L=B(e);n=S(L,"DIV",{class:!0,title:!0,"data-svelte-h":!0}),be(n)!=="svelte-1qdq6z0"&&(n.innerHTML=t),a=F(L),l=S(L,"DIV",{class:!0});var P=B(l);r=S(P,"DIV",{title:!0});var $=B(r);x(o.$$.fragment,$),$.forEach(h),s=F(P),f=S(P,"DIV",{title:!0});var X=B(f);x(u.$$.fragment,X),X.forEach(h),c=F(P),p=S(P,"DIV",{title:!0});var H=B(p);x(_.$$.fragment,H),H.forEach(h),w=F(P),E=S(P,"DIV",{title:!0});var Z=B(E);x(b.$$.fragment,Z),Z.forEach(h),U=F(P),R=S(P,"DIV",{title:!0});var ee=B(R);x(d.$$.fragment,ee),ee.forEach(h),I=F(P),T=S(P,"DIV",{title:!0});var D=B(T);x(O.$$.fragment,D),D.forEach(h),P.forEach(h),L.forEach(h),this.h()},h(){m(n,"class","panel-header svelte-9wroah"),m(n,"title","Real-time audio levels from your microphone"),m(r,"title","High frequencies - cymbals, hi-hats, bright sounds"),m(f,"title","Mid frequencies - vocals, guitars, main melody"),m(p,"title","Low frequencies - bass, kick drum, rumble"),m(E,"title","Treble - combined high-pitched sounds"),m(R,"title","Bass - combined low-pitched sounds"),m(T,"title","Beat detection - pulses when drums or strong beats hit"),m(l,"class","levels-grid svelte-9wroah"),m(e,"class","panel levels-panel svelte-9wroah")},m(v,L){C(v,e,L),y(e,n),y(e,a),y(e,l),y(l,r),W(o,r,null),y(l,s),y(l,f),W(u,f,null),y(l,c),y(l,p),W(_,p,null),y(l,w),y(l,E),W(b,E,null),y(l,U),y(l,R),W(d,R,null),y(l,I),y(l,T),W(O,T,null),A=!0},p(v,L){const P={};L&2&&(P.value=v[1].raw.highs),o.$set(P);const $={};L&2&&($.value=v[1].raw.mids),u.$set($);const X={};L&2&&(X.value=v[1].raw.lows),_.$set(X);const H={};L&2&&(H.value=v[1].raw.treble),b.$set(H);const Z={};L&2&&(Z.value=v[1].raw.bass),d.$set(Z);const ee={};L&2&&(ee.value=v[1].raw.beat),O.$set(ee)},i(v){A||(N(o.$$.fragment,v),N(u.$$.fragment,v),N(_.$$.fragment,v),N(b.$$.fragment,v),N(d.$$.fragment,v),N(O.$$.fragment,v),A=!0)},o(v){q(o.$$.fragment,v),q(u.$$.fragment,v),q(_.$$.fragment,v),q(b.$$.fragment,v),q(d.$$.fragment,v),q(O.$$.fragment,v),A=!1},d(v){v&&h(e),Y(o),Y(u),Y(_),Y(b),Y(d),Y(O)}}}function xi(i){let e,n,t=i[0]&&Lt(i);return{c(){t&&t.c(),e=ue()},l(a){t&&t.l(a),e=ue()},m(a,l){t&&t.m(a,l),C(a,e,l),n=!0},p(a,[l]){a[0]?t?(t.p(a,l),l&1&&N(t,1)):(t=Lt(a),t.c(),N(t,1),t.m(e.parentNode,e)):t&&(ke(),q(t,1,1,()=>{t=null}),Se())},i(a){n||(N(t),n=!0)},o(a){q(t),n=!1},d(a){a&&h(e),t&&t.d(a)}}}function Ki(i,e,n){let t;pe(i,Qe,l=>n(1,t=l));let{visible:a=!0}=e;return i.$$set=l=>{"visible"in l&&n(0,a=l.visible)},[a,t]}class Qi extends we{constructor(e){super(),Te(this,e,Ki,xi,_e,{visible:0})}}function Bt(i){let e,n,t,a="TUNING",l,r,o=i[1]?"":"+",s,f,u,c,p,_,w,E,b,U,R,d,I,T,O,A,v,L;function P(g){i[5](g)}let $={label:"Sens",min:0,max:2,formatValue:i[3]};i[2].sensitivity!==void 0&&($.value=i[2].sensitivity),p=new he({props:$}),oe.push(()=>de(p,"value",P));function X(g){i[6](g)}let H={label:"Beat",min:0,max:2,formatValue:i[3]};i[2].beatBoost!==void 0&&(H.value=i[2].beatBoost),b=new he({props:H}),oe.push(()=>de(b,"value",X));function Z(g){i[7](g)}let ee={label:"Gate",min:0,max:1,formatValue:i[3]};i[2].beatGate!==void 0&&(ee.value=i[2].beatGate),I=new he({props:ee}),oe.push(()=>de(I,"value",Z));let D=i[1]&&Rt(i);return{c(){e=M("div"),n=M("div"),t=M("span"),t.textContent=a,l=V(),r=M("button"),s=re(o),f=V(),u=M("div"),c=M("div"),K(p.$$.fragment),w=V(),E=M("div"),K(b.$$.fragment),R=V(),d=M("div"),K(I.$$.fragment),O=V(),D&&D.c(),this.h()},l(g){e=S(g,"DIV",{class:!0});var z=B(e);n=S(z,"DIV",{class:!0});var te=B(n);t=S(te,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),be(t)!=="svelte-hff578"&&(t.textContent=a),l=F(te),r=S(te,"BUTTON",{class:!0,title:!0});var ne=B(r);s=se(ne,o),ne.forEach(h),te.forEach(h),f=F(z),u=S(z,"DIV",{class:!0});var J=B(u);c=S(J,"DIV",{title:!0});var ve=B(c);x(p.$$.fragment,ve),ve.forEach(h),w=F(J),E=S(J,"DIV",{title:!0});var ye=B(E);x(b.$$.fragment,ye),ye.forEach(h),R=F(J),d=S(J,"DIV",{title:!0});var Ue=B(d);x(I.$$.fragment,Ue),Ue.forEach(h),O=F(J),D&&D.l(J),J.forEach(h),z.forEach(h),this.h()},h(){m(t,"class","panel-title svelte-1rkomi4"),m(t,"title","Adjust how visuals respond to audio"),m(r,"class","toggle-advanced svelte-1rkomi4"),m(r,"title","Show more advanced audio controls"),m(n,"class","panel-header svelte-1rkomi4"),m(c,"title","Overall sensitivity - how much visuals react to sound"),m(E,"title","Beat boost - make beat reactions stronger or weaker"),m(d,"title","Beat gate - ignore quiet sounds, only react to loud beats"),m(u,"class","tuning-grid svelte-1rkomi4"),m(e,"class","panel tuning-panel svelte-1rkomi4")},m(g,z){C(g,e,z),y(e,n),y(n,t),y(n,l),y(n,r),y(r,s),y(e,f),y(e,u),y(u,c),W(p,c,null),y(u,w),y(u,E),W(b,E,null),y(u,R),y(u,d),W(I,d,null),y(u,O),D&&D.m(u,null),A=!0,v||(L=Q(r,"click",i[4]),v=!0)},p(g,z){(!A||z&2)&&o!==(o=g[1]?"":"+")&&ge(s,o);const te={};!_&&z&4&&(_=!0,te.value=g[2].sensitivity,ce(()=>_=!1)),p.$set(te);const ne={};!U&&z&4&&(U=!0,ne.value=g[2].beatBoost,ce(()=>U=!1)),b.$set(ne);const J={};!T&&z&4&&(T=!0,J.value=g[2].beatGate,ce(()=>T=!1)),I.$set(J),g[1]?D?(D.p(g,z),z&2&&N(D,1)):(D=Rt(g),D.c(),N(D,1),D.m(u,null)):D&&(ke(),q(D,1,1,()=>{D=null}),Se())},i(g){A||(N(p.$$.fragment,g),N(b.$$.fragment,g),N(I.$$.fragment,g),N(D),A=!0)},o(g){q(p.$$.fragment,g),q(b.$$.fragment,g),q(I.$$.fragment,g),q(D),A=!1},d(g){g&&h(e),Y(p),Y(b),Y(I),D&&D.d(),v=!1,L()}}}function Rt(i){let e,n,t,a,l,r,o,s,f,u,c,p,_,w,E,b,U,R,d,I,T,O,A,v,L,P,$,X,H,Z,ee,D,g,z;function te(k){i[8](k)}let ne={label:"Hi+",min:0,max:2,formatValue:i[3]};i[2].highsBoost!==void 0&&(ne.value=i[2].highsBoost),a=new he({props:ne}),oe.push(()=>de(a,"value",te));function J(k){i[9](k)}let ve={label:"Mid+",min:0,max:2,formatValue:i[3]};i[2].midsBoost!==void 0&&(ve.value=i[2].midsBoost),s=new he({props:ve}),oe.push(()=>de(s,"value",J));function ye(k){i[10](k)}let Ue={label:"Low+",min:0,max:2,formatValue:i[3]};i[2].lowsBoost!==void 0&&(Ue.value=i[2].lowsBoost),p=new he({props:Ue}),oe.push(()=>de(p,"value",ye));function qt(k){i[11](k)}let et={label:"Trbl",min:0,max:2,formatValue:i[3]};i[2].trebleBoost!==void 0&&(et.value=i[2].trebleBoost),b=new he({props:et}),oe.push(()=>de(b,"value",qt));function Ot(k){i[12](k)}let tt={label:"Bass",min:0,max:2,formatValue:i[3]};i[2].bassBoost!==void 0&&(tt.value=i[2].bassBoost),I=new he({props:tt}),oe.push(()=>de(I,"value",Ot));function Ht(k){i[13](k)}let it={label:"Min",min:0,max:.1,step:.005,formatValue:i[3]};i[2].minMotion!==void 0&&(it.value=i[2].minMotion),v=new he({props:it}),oe.push(()=>de(v,"value",Ht));function Gt(k){i[14](k)}let nt={label:"Auto Suggest"};i[2].autoEnabled!==void 0&&(nt.checked=i[2].autoEnabled),Z=new Ui({props:nt}),oe.push(()=>de(Z,"checked",Gt));let ie=i[2].autoEnabled&&It(i);return{c(){e=M("div"),n=V(),t=M("div"),K(a.$$.fragment),r=V(),o=M("div"),K(s.$$.fragment),u=V(),c=M("div"),K(p.$$.fragment),w=V(),E=M("div"),K(b.$$.fragment),R=V(),d=M("div"),K(I.$$.fragment),O=V(),A=M("div"),K(v.$$.fragment),P=V(),$=M("div"),X=V(),H=M("div"),K(Z.$$.fragment),D=V(),ie&&ie.c(),g=ue(),this.h()},l(k){e=S(k,"DIV",{class:!0}),B(e).forEach(h),n=F(k),t=S(k,"DIV",{title:!0});var j=B(t);x(a.$$.fragment,j),j.forEach(h),r=F(k),o=S(k,"DIV",{title:!0});var Ce=B(o);x(s.$$.fragment,Ce),Ce.forEach(h),u=F(k),c=S(k,"DIV",{title:!0});var Fe=B(c);x(p.$$.fragment,Fe),Fe.forEach(h),w=F(k),E=S(k,"DIV",{title:!0});var Ve=B(E);x(b.$$.fragment,Ve),Ve.forEach(h),R=F(k),d=S(k,"DIV",{title:!0});var ze=B(d);x(I.$$.fragment,ze),ze.forEach(h),O=F(k),A=S(k,"DIV",{title:!0});var Ne=B(A);x(v.$$.fragment,Ne),Ne.forEach(h),P=F(k),$=S(k,"DIV",{class:!0}),B($).forEach(h),X=F(k),H=S(k,"DIV",{title:!0});var $e=B(H);x(Z.$$.fragment,$e),$e.forEach(h),D=F(k),ie&&ie.l(k),g=ue(),this.h()},h(){m(e,"class","divider svelte-1rkomi4"),m(t,"title","Boost high frequency response (cymbals, hi-hats)"),m(o,"title","Boost mid frequency response (vocals, guitars)"),m(c,"title","Boost low frequency response (bass, kick drums)"),m(E,"title","Boost treble (bright, high-pitched sounds)"),m(d,"title","Boost bass (deep, low-pitched sounds)"),m(A,"title","Minimum motion - keep some movement even in silence"),m($,"class","divider svelte-1rkomi4"),m(H,"title","Automatically adjust settings based on audio levels")},m(k,j){C(k,e,j),C(k,n,j),C(k,t,j),W(a,t,null),C(k,r,j),C(k,o,j),W(s,o,null),C(k,u,j),C(k,c,j),W(p,c,null),C(k,w,j),C(k,E,j),W(b,E,null),C(k,R,j),C(k,d,j),W(I,d,null),C(k,O,j),C(k,A,j),W(v,A,null),C(k,P,j),C(k,$,j),C(k,X,j),C(k,H,j),W(Z,H,null),C(k,D,j),ie&&ie.m(k,j),C(k,g,j),z=!0},p(k,j){const Ce={};!l&&j&4&&(l=!0,Ce.value=k[2].highsBoost,ce(()=>l=!1)),a.$set(Ce);const Fe={};!f&&j&4&&(f=!0,Fe.value=k[2].midsBoost,ce(()=>f=!1)),s.$set(Fe);const Ve={};!_&&j&4&&(_=!0,Ve.value=k[2].lowsBoost,ce(()=>_=!1)),p.$set(Ve);const ze={};!U&&j&4&&(U=!0,ze.value=k[2].trebleBoost,ce(()=>U=!1)),b.$set(ze);const Ne={};!T&&j&4&&(T=!0,Ne.value=k[2].bassBoost,ce(()=>T=!1)),I.$set(Ne);const $e={};!L&&j&4&&(L=!0,$e.value=k[2].minMotion,ce(()=>L=!1)),v.$set($e);const at={};!ee&&j&4&&(ee=!0,at.checked=k[2].autoEnabled,ce(()=>ee=!1)),Z.$set(at),k[2].autoEnabled?ie?(ie.p(k,j),j&4&&N(ie,1)):(ie=It(k),ie.c(),N(ie,1),ie.m(g.parentNode,g)):ie&&(ke(),q(ie,1,1,()=>{ie=null}),Se())},i(k){z||(N(a.$$.fragment,k),N(s.$$.fragment,k),N(p.$$.fragment,k),N(b.$$.fragment,k),N(I.$$.fragment,k),N(v.$$.fragment,k),N(Z.$$.fragment,k),N(ie),z=!0)},o(k){q(a.$$.fragment,k),q(s.$$.fragment,k),q(p.$$.fragment,k),q(b.$$.fragment,k),q(I.$$.fragment,k),q(v.$$.fragment,k),q(Z.$$.fragment,k),q(ie),z=!1},d(k){k&&(h(e),h(n),h(t),h(r),h(o),h(u),h(c),h(w),h(E),h(R),h(d),h(O),h(A),h(P),h($),h(X),h(H),h(D),h(g)),Y(a),Y(s),Y(p),Y(b),Y(I),Y(v),Y(Z),ie&&ie.d(k)}}}function It(i){let e,n,t,a,l,r,o,s,f,u,c,p;function _(d){i[15](d)}let w={label:"Str",min:0,max:1,formatValue:i[3]};i[2].autoStrength!==void 0&&(w.value=i[2].autoStrength),n=new he({props:w}),oe.push(()=>de(n,"value",_));function E(d){i[16](d)}let b={label:"Dec",min:0,max:1,formatValue:i[3]};i[2].autoDecay!==void 0&&(b.value=i[2].autoDecay),r=new he({props:b}),oe.push(()=>de(r,"value",E));function U(d){i[17](d)}let R={label:"Tgt",options:[{value:"all",label:"All"},{value:"energy",label:"Energy"},{value:"treble",label:"Treble"},{value:"beat",label:"Beat"}]};return i[2].autoTarget!==void 0&&(R.value=i[2].autoTarget),u=new Xt({props:R}),oe.push(()=>de(u,"value",U)),{c(){e=M("div"),K(n.$$.fragment),a=V(),l=M("div"),K(r.$$.fragment),s=V(),f=M("div"),K(u.$$.fragment),this.h()},l(d){e=S(d,"DIV",{title:!0});var I=B(e);x(n.$$.fragment,I),I.forEach(h),a=F(d),l=S(d,"DIV",{title:!0});var T=B(l);x(r.$$.fragment,T),T.forEach(h),s=F(d),f=S(d,"DIV",{title:!0});var O=B(f);x(u.$$.fragment,O),O.forEach(h),this.h()},h(){m(e,"title","How strongly auto-adjust affects the visuals"),m(l,"title","How quickly auto-adjustments fade back to normal"),m(f,"title","Which audio metric to use for auto-adjustment")},m(d,I){C(d,e,I),W(n,e,null),C(d,a,I),C(d,l,I),W(r,l,null),C(d,s,I),C(d,f,I),W(u,f,null),p=!0},p(d,I){const T={};!t&&I&4&&(t=!0,T.value=d[2].autoStrength,ce(()=>t=!1)),n.$set(T);const O={};!o&&I&4&&(o=!0,O.value=d[2].autoDecay,ce(()=>o=!1)),r.$set(O);const A={};!c&&I&4&&(c=!0,A.value=d[2].autoTarget,ce(()=>c=!1)),u.$set(A)},i(d){p||(N(n.$$.fragment,d),N(r.$$.fragment,d),N(u.$$.fragment,d),p=!0)},o(d){q(n.$$.fragment,d),q(r.$$.fragment,d),q(u.$$.fragment,d),p=!1},d(d){d&&(h(e),h(a),h(l),h(s),h(f)),Y(n),Y(r),Y(u)}}}function Ji(i){let e,n,t=i[0]&&Bt(i);return{c(){t&&t.c(),e=ue()},l(a){t&&t.l(a),e=ue()},m(a,l){t&&t.m(a,l),C(a,e,l),n=!0},p(a,[l]){a[0]?t?(t.p(a,l),l&1&&N(t,1)):(t=Bt(a),t.c(),N(t,1),t.m(e.parentNode,e)):t&&(ke(),q(t,1,1,()=>{t=null}),Se())},i(a){n||(N(t),n=!0)},o(a){q(t),n=!1},d(a){a&&h(e),t&&t.d(a)}}}function en(i,e,n){let t;pe(i,le,T=>n(2,t=T));let{visible:a=!0}=e,l=!1;const r=T=>`${Math.round(T*100)}%`,o=()=>n(1,l=!l);function s(T){i.$$.not_equal(t.sensitivity,T)&&(t.sensitivity=T,le.set(t))}function f(T){i.$$.not_equal(t.beatBoost,T)&&(t.beatBoost=T,le.set(t))}function u(T){i.$$.not_equal(t.beatGate,T)&&(t.beatGate=T,le.set(t))}function c(T){i.$$.not_equal(t.highsBoost,T)&&(t.highsBoost=T,le.set(t))}function p(T){i.$$.not_equal(t.midsBoost,T)&&(t.midsBoost=T,le.set(t))}function _(T){i.$$.not_equal(t.lowsBoost,T)&&(t.lowsBoost=T,le.set(t))}function w(T){i.$$.not_equal(t.trebleBoost,T)&&(t.trebleBoost=T,le.set(t))}function E(T){i.$$.not_equal(t.bassBoost,T)&&(t.bassBoost=T,le.set(t))}function b(T){i.$$.not_equal(t.minMotion,T)&&(t.minMotion=T,le.set(t))}function U(T){i.$$.not_equal(t.autoEnabled,T)&&(t.autoEnabled=T,le.set(t))}function R(T){i.$$.not_equal(t.autoStrength,T)&&(t.autoStrength=T,le.set(t))}function d(T){i.$$.not_equal(t.autoDecay,T)&&(t.autoDecay=T,le.set(t))}function I(T){i.$$.not_equal(t.autoTarget,T)&&(t.autoTarget=T,le.set(t))}return i.$$set=T=>{"visible"in T&&n(0,a=T.visible)},[a,l,t,r,o,s,f,u,c,p,_,w,E,b,U,R,d,I]}class tn extends we{constructor(e){super(),Te(this,e,en,Ji,_e,{visible:0})}}function nn(i){let e,n,t,a,l,r,o,s,f,u,c,p,_,w={};return n=new Ri({props:w}),i[4](n),a=new Hi({props:{onEnableMic:i[2],visible:i[1].panelsVisible}}),r=new Wi({props:{visible:i[1].panelsVisible}}),s=new Qi({props:{visible:i[1].panelsVisible}}),u=new tn({props:{visible:i[1].panelsVisible}}),{c(){e=M("main"),K(n.$$.fragment),t=V(),K(a.$$.fragment),l=V(),K(r.$$.fragment),o=V(),K(s.$$.fragment),f=V(),K(u.$$.fragment),this.h()},l(E){e=S(E,"MAIN",{class:!0});var b=B(e);x(n.$$.fragment,b),t=F(b),x(a.$$.fragment,b),l=F(b),x(r.$$.fragment,b),o=F(b),x(s.$$.fragment,b),f=F(b),x(u.$$.fragment,b),b.forEach(h),this.h()},h(){m(e,"class","app svelte-1hyx21c")},m(E,b){C(E,e,b),W(n,e,null),y(e,t),W(a,e,null),y(e,l),W(r,e,null),y(e,o),W(s,e,null),y(e,f),W(u,e,null),c=!0,p||(_=Q(window,"keydown",i[3]),p=!0)},p(E,[b]){const U={};n.$set(U);const R={};b&2&&(R.visible=E[1].panelsVisible),a.$set(R);const d={};b&2&&(d.visible=E[1].panelsVisible),r.$set(d);const I={};b&2&&(I.visible=E[1].panelsVisible),s.$set(I);const T={};b&2&&(T.visible=E[1].panelsVisible),u.$set(T)},i(E){c||(N(n.$$.fragment,E),N(a.$$.fragment,E),N(r.$$.fragment,E),N(s.$$.fragment,E),N(u.$$.fragment,E),c=!0)},o(E){q(n.$$.fragment,E),q(a.$$.fragment,E),q(r.$$.fragment,E),q(s.$$.fragment,E),q(u.$$.fragment,E),c=!1},d(E){E&&h(e),i[4](null),Y(n),Y(a),Y(r),Y(s),Y(u),p=!1,_()}}}function an(i,e,n){let t;pe(i,ae,u=>n(1,t=u));let a;async function l(){return a?await a.enableMicrophone():!1}function r(u){if(!(u.target instanceof HTMLInputElement||u.target instanceof HTMLTextAreaElement))switch(u.key.toLowerCase()){case"c":ri();break;case"f":o();break}}async function o(){document.fullscreenElement?(await document.exitFullscreen(),ae.update(u=>({...u,fullscreen:!1}))):(await document.documentElement.requestFullscreen(),ae.update(u=>({...u,fullscreen:!0})))}function s(){ae.update(u=>({...u,fullscreen:!!document.fullscreenElement}))}Dt(()=>(document.addEventListener("fullscreenchange",s),setTimeout(()=>{l()},500),()=>{document.removeEventListener("fullscreenchange",s)}));function f(u){oe[u?"unshift":"push"](()=>{a=u,n(0,a)})}return[a,t,l,r,f]}class on extends we{constructor(e){super(),Te(this,e,an,nn,_e,{})}}export{on as component};
