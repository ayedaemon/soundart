import{r as ze,P as Je,s as Le,n as ge,d as v,i as U,Q as J,A as m,c as _,e as I,h as w,k as we,x as Ht,R as ti,C as ve,a as me,S as Z,b as p,f as ae,g as R,t as se,j as z,T as Gt,U as ii,V as ft,W as dt,B as Ze,v as he,m as ni,X as re,Y as ye}from"../chunks/D6DlaX6_.js";import{a as $,t as G,S as Be,i as Ie,g as De,c as Pe,d as ee,m as te,e as ie,b as ne,f as _e}from"../chunks/COUIFFA3.js";import{b as Xt,d as lt,w as Ae}from"../chunks/CUSJIBnU.js";function xe(i){return i?.length!==void 0?i:Array.from(i)}function jt(i,e){G(i,1,1,()=>{e.delete(i.key)})}function Zt(i,e,n,t,a,s,r,o,l,c,u,d){let h=i.length,b=s.length,g=h;const S={};for(;g--;)S[i[g].key]=g;const E=[],P=new Map,D=new Map,f=[];for(g=b;g--;){const A=d(a,s,g),T=n(A);let V=r.get(T);V?f.push(()=>V.p(A,e)):(V=c(T,A),V.c()),P.set(T,E[g]=V),T in S&&D.set(T,Math.abs(g-S[T]))}const M=new Set,y=new Set;function X(A){$(A,1),A.m(o,u),r.set(A.key,A),u=A.first,b--}for(;h&&b;){const A=E[b-1],T=i[h-1],V=A.key,C=T.key;A===T?(u=A.first,h--,b--):P.has(C)?!r.has(V)||M.has(V)?X(A):y.has(C)?h--:D.get(V)>D.get(C)?(y.add(V),X(A)):(M.add(C),h--):(l(T,r),h--)}for(;h--;){const A=i[h];P.has(A.key)||l(A,r)}for(;b;)X(E[b-1]);return ze(f),E}const et=new Map;async function xt(i){if(et.has(i))return et.get(i);const e=await fetch(i);if(!e.ok)throw new Error(`Failed to load shader: ${i}`);const n=await e.text();return et.set(i,n),n}async function Yt(i,e,n=new Set){const t=/#include\s+"([^"]+)"/g;let a=i,s;const r=[];for(;(s=t.exec(i))!==null;)r.push({full:s[0],path:s[1]});for(const{full:o,path:l}of r){const c=e+l;if(n.has(c)){console.warn(`Circular include detected: ${c}`),a=a.replace(o,"");continue}n.add(c);try{let u=await xt(c);u=await Yt(u,e,n),a=a.replace(o,u)}catch(u){console.error(`Failed to include shader: ${c}`,u),a=a.replace(o,`// Failed to include: ${l}`)}}return a}async function ct(i,e=`${Xt}/shaders/`){const n=await xt(e+i);return Yt(n,e)}function mt(i,e,n){const t=i.createShader(e);if(!t)return console.error("Failed to create shader"),null;if(i.shaderSource(t,n),i.compileShader(t),!i.getShaderParameter(t,i.COMPILE_STATUS)){const a=i.getShaderInfoLog(t);console.error("Shader compilation error:",a);const r=n.split(`
`).map((o,l)=>`${l+1}: ${o}`);return console.error(`Shader source:
`+r.join(`
`)),i.deleteShader(t),null}return t}function ai(i,e,n){const t=mt(i,i.VERTEX_SHADER,e),a=mt(i,i.FRAGMENT_SHADER,n);if(!t||!a)return null;const s=i.createProgram();if(!s)return console.error("Failed to create program"),null;if(i.attachShader(s,t),i.attachShader(s,a),i.linkProgram(s),!i.getProgramParameter(s,i.LINK_STATUS)){const r=i.getProgramInfoLog(s);return console.error("Program linking error:",r),i.deleteProgram(s),null}return i.deleteShader(t),i.deleteShader(a),s}async function ht(i,e,n,t=`${Xt}/shaders/`){const[a,s]=await Promise.all([ct(e,t),ct(n,t)]);return ai(i,a,s)}const $e=[{id:"glow",label:"Center Glow",description:"Pulsing core with arcs",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerGlow",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerGlowZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerGlowTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerGlowSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerGlowMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/glow.glsl",randomizable:!0},{id:"turbulence",label:"Turbulence",description:"Audio-reactive turbulence",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerTurbulence",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerTurbulenceZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerTurbulenceTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerTurbulenceSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerTurbulenceMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.3,transform:"linear"}],shaderPath:"layers/turbulence.glsl",randomizable:!0},{id:"displacement",label:"Displacement",description:"Cellular displacement waves",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerDisplacement",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerDisplacementZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerDisplacementTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerDisplacementSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerDisplacementMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.3,transform:"linear"}],shaderPath:"layers/displacement.glsl",randomizable:!0},{id:"starfield",label:"Starfield",description:"Warp tunnel streaks",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerStarfield",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerStarfieldZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerStarfieldTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerStarfieldSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerStarfieldMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"}],shaderPath:"layers/starfield.glsl",randomizable:!0},{id:"cubescape",label:"Cubescape",description:"3D cube lattice",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerCubescape",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerCubescapeZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerCubescapeTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerCubescapeSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerCubescapeMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/cubescape.glsl",randomizable:!0},{id:"spires",label:"Spires",description:"Cathedral-like pillars",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerSpires",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerSpiresZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerSpiresTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerSpiresSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerSpiresMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"},{audioMetric:"treble",targetProperty:"intensity",sensitivity:.3,transform:"linear"}],shaderPath:"layers/spires.glsl",randomizable:!0},{id:"mandala",label:"Mandala",description:"Radial symmetries",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerMandala",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerMandalaZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerMandalaTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerMandalaSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerMandalaMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/mandala.glsl",randomizable:!0},{id:"kaleidoscope",label:"Kaleidoscope",description:"Sacred geometry mirroring",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerKaleidoscope",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerKaleidoscopeZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerKaleidoscopeTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerKaleidoscopeSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerKaleidoscopeMouseSens"}],audioBindings:[{audioMetric:"treble",targetProperty:"intensity",sensitivity:1,transform:"linear"}],shaderPath:"layers/kaleidoscope.glsl",randomizable:!0},{id:"lissajous",label:"Lissajous",description:"Flowing curves",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerLissajous",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerLissajousZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerLissajousTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerLissajousSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerLissajousMouseSens"}],audioBindings:[{audioMetric:"energy",targetProperty:"intensity",sensitivity:1,transform:"linear"}],shaderPath:"layers/lissajous.glsl",randomizable:!0},{id:"flower",label:"Flower of Life",description:"Sacred circles",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerFlower",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerFlowerZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerFlowerTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerFlowerSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerFlowerMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"}],shaderPath:"layers/flower.glsl",randomizable:!0},{id:"fibonacci",label:"Fibonacci",description:"Golden spiral with phyllotaxis",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerFibonacci",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerFibonacciZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"points",label:"Points",type:"range",default:100,min:10,max:200,step:1,uniform:"uLayerFibonacciPoints",randomizable:!0,randomMin:30,randomMax:150},{id:"speed",label:"Spin",type:"range",default:1,min:0,max:3,step:.1,uniform:"uLayerFibonacciSpeed",randomizable:!0,randomMin:.3,randomMax:2},{id:"angle",label:"Angle",type:"range",default:1,min:.8,max:1.2,step:.01,uniform:"uLayerFibonacciAngle",randomizable:!0,randomMin:.92,randomMax:1.08},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerFibonacciTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerFibonacciSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerFibonacciMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"}],shaderPath:"layers/fibonacci.glsl",randomizable:!0},{id:"hopalong",label:"Hopalong Orbits",description:"Barry Martin attractor",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerHopalong",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerHopalongZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerHopalongTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerHopalongSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerHopalongMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.5,transform:"linear"}],shaderPath:"layers/hopalong.glsl",randomizable:!0},{id:"metatron",label:"Metatron's Cube",description:"Sacred geometry with nested rings",properties:[{id:"intensity",label:"Intensity",type:"range",default:.5,min:0,max:1,step:.01,uniform:"uLayerMetatron",randomizable:!0},{id:"zoom",label:"Zoom",type:"range",default:1,min:.5,max:4,step:.01,uniform:"uLayerMetatronZoom",randomizable:!0,randomMin:.7,randomMax:2.5},{id:"rings",label:"Rings",type:"range",default:2,min:1,max:10,step:1,uniform:"uLayerMetatronRings",randomizable:!0,randomMin:1,randomMax:6},{id:"theme",label:"Theme",type:"select",default:0,options:[],uniform:"uLayerMetatronTheme",randomizable:!0},{id:"sensitivity",label:"Sensitivity",type:"range",default:1,min:0,max:2,step:.01,uniform:"uLayerMetatronSensitivity",randomizable:!0,randomMin:.5,randomMax:1.5},{id:"mouseSensitivity",label:"Mouse",type:"range",default:0,min:0,max:2,step:.01,uniform:"uLayerMetatronMouseSens"}],audioBindings:[{audioMetric:"beat",targetProperty:"intensity",sensitivity:1,transform:"envelope"},{audioMetric:"energy",targetProperty:"intensity",sensitivity:.6,transform:"linear"}],shaderPath:"layers/metatron.glsl",randomizable:!0}];class si{canvas;gl=null;program=null;uniformLocations={};mouseUniformLocations={};layerUniformLocations=new Map;reactionProgram=null;reactionUniforms={input:null,texel:null,time:null,treble:null};reactionSeeded=!1;feedbackTexture=null;feedbackReady=!1;reactionBuffer=null;positionBuffer=null;initialized=!1;currentTime=0;constructor(e){this.canvas=e}async init(){if(this.gl=this.canvas.getContext("webgl",{antialias:!1,preserveDrawingBuffer:!0}),!this.gl)return console.error("WebGL not supported"),!1;const e=this.gl;try{if(this.program=await ht(e,"quad.vert","composite.frag"),!this.program)return console.error("Failed to create shader program"),!1;if(this.reactionProgram=await ht(e,"quad.vert","reaction_diffusion.frag"),!this.reactionProgram)return console.error("Failed to create reaction-diffusion program"),!1;this.reactionUniforms={input:e.getUniformLocation(this.reactionProgram,"uInput"),texel:e.getUniformLocation(this.reactionProgram,"uTexel"),time:e.getUniformLocation(this.reactionProgram,"uTime"),treble:e.getUniformLocation(this.reactionProgram,"uTreble")}}catch(r){return console.error("Failed to load shaders:",r),!1}this.uniformLocations={time:e.getUniformLocation(this.program,"uTime"),resolution:e.getUniformLocation(this.program,"uResolution"),beat:e.getUniformLocation(this.program,"uBeat"),energy:e.getUniformLocation(this.program,"uEnergy"),treble:e.getUniformLocation(this.program,"uTreble"),feedbackTexture:e.getUniformLocation(this.program,"uFeedbackTex"),feedbackReady:e.getUniformLocation(this.program,"uFeedbackReady"),reactionTexture:e.getUniformLocation(this.program,"uReactionTex")},this.mouseUniformLocations={position:e.getUniformLocation(this.program,"uMouse"),velocity:e.getUniformLocation(this.program,"uMouseVelocity"),speed:e.getUniformLocation(this.program,"uMouseSpeed"),down:e.getUniformLocation(this.program,"uMouseDown"),click:e.getUniformLocation(this.program,"uMouseClick")};for(const r of $e)for(const o of r.properties){const l=e.getUniformLocation(this.program,o.uniform);this.layerUniformLocations.set(o.uniform,l)}this.positionBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.positionBuffer);const n=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]);e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW);const t=e.getAttribLocation(this.program,"aPosition");e.enableVertexAttribArray(t),e.vertexAttribPointer(t,2,e.FLOAT,!1,0,0),this.feedbackTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.feedbackTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.canvas.width,this.canvas.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);const a=Math.max(1,this.canvas.width),s=Math.max(1,this.canvas.height);return this.reactionBuffer=this.createPingPongBuffer(a,s),this.initialized=!0,!0}resize(){if(!this.gl||!this.canvas)return;const e=this.gl,n=window.devicePixelRatio||1,t=Math.floor(this.canvas.clientWidth*n),a=Math.floor(this.canvas.clientHeight*n);(this.canvas.width!==t||this.canvas.height!==a)&&(this.canvas.width=t,this.canvas.height=a,e.viewport(0,0,t,a),this.feedbackTexture&&(e.bindTexture(e.TEXTURE_2D,this.feedbackTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,a,0,e.RGBA,e.UNSIGNED_BYTE,null)),this.reactionBuffer&&(this.resizePingPongBuffer(this.reactionBuffer,t,a),this.reactionSeeded=!1),this.feedbackReady=!1)}render(e,n,t,a){if(!this.gl||!this.program||!this.initialized)return;const s=this.gl;this.currentTime=e,this.resize(),this.renderReactionDiffusion(8,n.treble),s.clearColor(0,0,0,1),s.clear(s.COLOR_BUFFER_BIT),s.useProgram(this.program);const r=s.getAttribLocation(this.program,"aPosition");s.bindBuffer(s.ARRAY_BUFFER,this.positionBuffer),s.enableVertexAttribArray(r),s.vertexAttribPointer(r,2,s.FLOAT,!1,0,0),s.uniform1f(this.uniformLocations.time,e),s.uniform2f(this.uniformLocations.resolution,this.canvas.width,this.canvas.height),s.uniform1f(this.uniformLocations.beat,n.beat),s.uniform1f(this.uniformLocations.energy,n.energy),s.uniform1f(this.uniformLocations.treble,n.treble),s.uniform2f(this.mouseUniformLocations.position,t.x,t.y),s.uniform2f(this.mouseUniformLocations.velocity,t.velocityX,t.velocityY),s.uniform1f(this.mouseUniformLocations.speed,t.speed),s.uniform1f(this.mouseUniformLocations.down,t.down),s.uniform2f(this.mouseUniformLocations.click,t.clickX,t.clickY);for(const[o,l]of Object.entries(a)){const c=this.layerUniformLocations.get(o);c&&s.uniform1f(c,l)}s.activeTexture(s.TEXTURE0),this.feedbackTexture&&this.feedbackReady?s.bindTexture(s.TEXTURE_2D,this.feedbackTexture):s.bindTexture(s.TEXTURE_2D,null),s.uniform1i(this.uniformLocations.feedbackTexture,0),s.uniform1f(this.uniformLocations.feedbackReady,this.feedbackReady?1:0),s.activeTexture(s.TEXTURE1),this.reactionBuffer&&this.reactionBuffer.textures[this.reactionBuffer.index]?s.bindTexture(s.TEXTURE_2D,this.reactionBuffer.textures[this.reactionBuffer.index]):s.bindTexture(s.TEXTURE_2D,null),s.uniform1i(this.uniformLocations.reactionTexture,1),s.drawArrays(s.TRIANGLES,0,6),this.canvas.width>0&&this.canvas.height>0&&this.feedbackTexture&&(s.bindTexture(s.TEXTURE_2D,this.feedbackTexture),s.copyTexSubImage2D(s.TEXTURE_2D,0,0,0,0,0,this.canvas.width,this.canvas.height),this.feedbackReady=!0),s.activeTexture(s.TEXTURE0)}dispose(){if(!this.gl)return;const e=this.gl;this.program&&(e.deleteProgram(this.program),this.program=null),this.reactionProgram&&(e.deleteProgram(this.reactionProgram),this.reactionProgram=null),this.positionBuffer&&(e.deleteBuffer(this.positionBuffer),this.positionBuffer=null),this.feedbackTexture&&(e.deleteTexture(this.feedbackTexture),this.feedbackTexture=null),this.reactionBuffer&&(this.disposePingPongBuffer(this.reactionBuffer),this.reactionBuffer=null),this.reactionSeeded=!1,this.initialized=!1}isInitialized(){return this.initialized}getCanvas(){return this.canvas}createPingPongBuffer(e,n){if(!this.gl)return null;const t=this.gl,a={textures:[null,null],framebuffers:[null,null],index:0,width:e,height:n};for(let s=0;s<2;s++){const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,n,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),a.textures[s]=r;const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const l=t.checkFramebufferStatus(t.FRAMEBUFFER);l!==t.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer not complete:",l),a.framebuffers[s]=o}return t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),a}swapPingPong(e){e.index=1-e.index}resizePingPongBuffer(e,n,t){if(!this.gl||e.width===n&&e.height===t)return;const a=this.gl;e.width=n,e.height=t;for(let s=0;s<2;s++)e.textures[s]&&(a.bindTexture(a.TEXTURE_2D,e.textures[s]),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,n,t,0,a.RGBA,a.UNSIGNED_BYTE,null));a.bindTexture(a.TEXTURE_2D,null)}disposePingPongBuffer(e){if(!this.gl)return;const n=this.gl;for(let t=0;t<2;t++)e.textures[t]&&(n.deleteTexture(e.textures[t]),e.textures[t]=null),e.framebuffers[t]&&(n.deleteFramebuffer(e.framebuffers[t]),e.framebuffers[t]=null)}seedReactionBuffer(){if(!this.gl||!this.reactionBuffer)return;const e=this.gl,n=this.reactionBuffer.width,t=this.reactionBuffer.height,a=new Uint8Array(n*t*4);for(let s=0;s<t;s++)for(let r=0;r<n;r++){const o=(s*n+r)*4;a[o]=255;const l=r-n/2,c=s-t/2,u=Math.sqrt(l*l+c*c),d=Math.min(n,t)*.3;u<d&&Math.random()<.15?a[o+1]=255:a[o+1]=0,a[o+2]=0,a[o+3]=255}for(let s=0;s<2;s++)e.bindTexture(e.TEXTURE_2D,this.reactionBuffer.textures[s]),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n,t,0,e.RGBA,e.UNSIGNED_BYTE,a);e.bindTexture(e.TEXTURE_2D,null),this.reactionSeeded=!0}renderReactionDiffusion(e,n){if(!this.gl||!this.reactionProgram||!this.reactionBuffer||!this.positionBuffer)return;const t=this.gl;this.reactionSeeded||this.seedReactionBuffer(),t.useProgram(this.reactionProgram);const a=t.getAttribLocation(this.reactionProgram,"aPosition");t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.enableVertexAttribArray(a),t.vertexAttribPointer(a,2,t.FLOAT,!1,0,0),t.uniform2f(this.reactionUniforms.texel,1/this.reactionBuffer.width,1/this.reactionBuffer.height),t.uniform1f(this.reactionUniforms.time,this.currentTime),t.uniform1f(this.reactionUniforms.treble,n);for(let s=0;s<e;s++){const r=this.reactionBuffer.index,o=1-r;t.bindFramebuffer(t.FRAMEBUFFER,this.reactionBuffer.framebuffers[o]),t.viewport(0,0,this.reactionBuffer.width,this.reactionBuffer.height),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.reactionBuffer.textures[r]),t.uniform1i(this.reactionUniforms.input,0),t.drawArrays(t.TRIANGLES,0,6),this.swapPingPong(this.reactionBuffer)}t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,this.canvas.width,this.canvas.height)}}function Ge(i,e,n){return i+(e-i)*n}function li(i,e,n){return Math.min(Math.max(i,e),n)}class ri{context=null;analyser=null;source=null;freqData=null;stream=null;energy=0;treble=0;highs=0;mids=0;lows=0;bass=0;beatValue=0;beatCutoff=0;beatHold=0;smoothing=.3;beatFalloff=2.4;beatMin=.15;beatDecay=.98;beatHoldTime=.08;async init(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});const e=window.AudioContext||window.webkitAudioContext;return this.context=new e,this.source=this.context.createMediaStreamSource(this.stream),this.analyser=this.context.createAnalyser(),this.analyser.fftSize=2048,this.analyser.smoothingTimeConstant=.8,this.source.connect(this.analyser),this.freqData=new Uint8Array(this.analyser.frequencyBinCount),!0}catch(e){return console.error("Failed to initialize audio:",e),!1}}dispose(){this.source&&(this.source.disconnect(),this.source=null),this.context&&(this.context.close(),this.context=null),this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null),this.analyser=null,this.freqData=null}update(e){if(!this.analyser||!this.freqData)return this.getEmptyMetrics();this.analyser.getByteFrequencyData(this.freqData);const n=this.freqData.length,a=(this.context?.sampleRate||44100)/this.analyser.fftSize,s=120,r=200,o=2e3,l=6e3,c=Math.max(2,Math.floor(s/a)),u=Math.max(c+1,Math.floor(r/a)),d=Math.max(u+1,Math.floor(o/a)),h=Math.max(d+1,Math.floor(l/a)),b=Math.min(n-1,u),g=Math.min(n-1,d),S=Math.min(n-1,h);let E=0,P=0,D=0,f=0,M=0,y=0;for(let H=0;H<n;H++){const x=this.freqData[H];E+=x,H<c&&(P+=x),H<b?D+=x:H<g?f+=x:H<S?M+=x:y+=x}const X=E/(n*255),A=P/(Math.max(1,c)*255),T=D/(Math.max(1,b)*255),V=f/(Math.max(1,g-b)*255),C=M/(Math.max(1,S-g)*255),O=y/(Math.max(1,n-S)*255);this.energy=Ge(this.energy,X,this.smoothing),this.treble=Ge(this.treble,O,this.smoothing),this.highs=Ge(this.highs,C,this.smoothing),this.mids=Ge(this.mids,V,this.smoothing),this.lows=Ge(this.lows,T,this.smoothing),this.bass=Ge(this.bass,A,this.smoothing);const N=Math.max(0,e);return this.beatValue=Math.max(0,this.beatValue-N*this.beatFalloff),T>this.beatCutoff&&T>this.beatMin&&(this.beatValue=li(T*1.5,0,1),this.beatCutoff=T*1.1,this.beatHold=this.beatHoldTime),this.beatHold>0?this.beatHold-=N:this.beatCutoff=Math.max(this.beatMin,this.beatCutoff-N*this.beatDecay),{energy:this.energy,treble:this.treble,highs:this.highs,mids:this.mids,lows:this.lows,bass:this.bass,beat:this.beatValue}}getEmptyMetrics(){return{energy:0,treble:0,highs:0,mids:0,lows:0,bass:0,beat:0}}isInitialized(){return this.analyser!==null}}const oi={energy:0,treble:0,bass:0,mids:0,highs:0,lows:0,beat:0},ui={sensitivity:1,highsBoost:1,midsBoost:1,lowsBoost:1,trebleBoost:1,bassBoost:1,beatBoost:1,minMotion:.02,beatGate:.35,autoEnabled:!1,autoStrength:.4,autoDecay:.6,autoTarget:"all"},Wt=Ae(oi),be=Ae(ui),at=Ae(!1),Kt=Ae(0);function ke(i,e,n){return Math.min(Math.max(i,e),n)}const rt=lt([Wt,be,Kt],([i,e,n])=>{const t=ke(e.sensitivity,0,2);let a=ke(i.energy*t,0,2),s=ke(i.treble*t*e.trebleBoost,0,2),r=ke(i.beat*t*e.beatBoost*e.bassBoost,0,2);const o=(e.highsBoost+e.midsBoost+e.lowsBoost)/3;if(a*=o,a=Math.max(a,e.minMotion),s=Math.max(s,e.minMotion),r=Math.max(r,e.minMotion),e.autoEnabled&&n>0){const l=n*e.autoStrength;switch(e.autoTarget){case"energy":a+=l;break;case"treble":s+=l;break;case"beat":r+=l;break;default:a+=l,s+=l,r+=l}}return{energy:ke(a,0,2),treble:ke(s,0,2),beat:ke(r,0,2),raw:{highs:ke(i.highs*t,0,2),mids:ke(i.mids*t,0,2),lows:ke(i.lows*t,0,2),treble:ke(i.treble*t,0,2),bass:ke(i.bass*t,0,2),beat:ke(i.beat*t,0,2)}}});function fi(){const i=new Map;for(const e of $e){const n={};for(const t of e.properties)n[t.id]=t.default;i.set(e.id,{id:e.id,enabled:!1,properties:n,includeInRandomizer:e.randomizable!==!1,includeInStrobe:e.randomizable!==!1})}return i}const Re=Ae(fi());function pt(i,e,n){Re.update(t=>{const a=t.get(i);return a&&(a.properties[e]=n),t})}function di(i){Re.update(e=>{const n=e.get(i);if(n&&(n.enabled=!n.enabled,n.enabled)){const a=$e.find(s=>s.id===i)?.properties.find(s=>s.id==="intensity");a&&(n.properties.intensity=a.default)}return e})}function ci(i){Re.update(e=>{const n=e.get(i);return n&&(n.includeInRandomizer=!n.includeInRandomizer),e})}function mi(i){Re.update(e=>{const n=e.get(i);return n&&(n.includeInStrobe=!n.includeInStrobe),e})}function hi(i){Re.update(e=>{for(const n of e.values())if(n.enabled=i,i){const a=$e.find(s=>s.id===n.id)?.properties.find(s=>s.id==="intensity");a&&(n.properties.intensity=a.default)}return e})}const pi=lt([Re,rt],([i,e])=>{const n={};for(const t of $e){const a=i.get(t.id);if(a){for(const s of t.properties){let r=a.properties[s.id]??s.default;s.id==="intensity"&&!a.enabled&&(r=0),n[s.uniform]=r}for(const s of t.audioBindings)if(e[s.audioMetric],t.properties.find(o=>o.id===s.targetProperty)){const o=t.properties.find(l=>l.id==="sensitivity");o&&(n[o.uniform]=a.properties.sensitivity??1)}}}return n}),vi={panelsVisible:!0,fullscreen:!1,pipEnabled:!1,powerSaverEnabled:!1,targetFps:60,randomizerEnabled:!0,randomizerCooldown:2,randomizerTogglesLayers:!0,randomizerToggleChance:.3},ce=Ae(vi);function gi(){ce.update(i=>({...i,panelsVisible:!i.panelsVisible}))}function bi(){ce.update(i=>({...i,powerSaverEnabled:!i.powerSaverEnabled}))}function yi(){ce.update(i=>({...i,randomizerEnabled:!i.randomizerEnabled}))}function _i(){ce.update(i=>({...i,randomizerTogglesLayers:!i.randomizerTogglesLayers}))}const ot=[{id:0,label:"LSD (Rainbow)",preview:"linear-gradient(90deg, #ff0000, #ff8800, #ffff00, #00ff00, #00ffff, #0088ff, #8800ff, #ff00ff)",brightness:"bright",temperature:"neutral",saturation:"high",family:"spectrum"},{id:1,label:"Sunset",preview:"linear-gradient(90deg, #ff2e1f, #ff8c1f, #ffd940)",brightness:"bright",temperature:"warm",saturation:"high",family:"fire"},{id:2,label:"Aurora",preview:"linear-gradient(90deg, #0dd9b3, #1a59ff, #8ce6ff)",brightness:"medium",temperature:"cool",saturation:"high",family:"ocean"},{id:3,label:"Ultraviolet",preview:"linear-gradient(90deg, #8c26ff, #ff33bf, #3366ff)",brightness:"medium",temperature:"cool",saturation:"high",family:"cosmic"},{id:4,label:"Neon",preview:"linear-gradient(90deg, #1aff73, #ff1ad9)",brightness:"bright",temperature:"neutral",saturation:"high",family:"neon"},{id:5,label:"Split Complement",preview:"linear-gradient(90deg, #14d1ff, #ff7333, #cc33ff)",brightness:"bright",temperature:"neutral",saturation:"high",family:"spectrum"},{id:6,label:"Analogous Cool",preview:"linear-gradient(90deg, #14e6bf, #268cff, #6640ff)",brightness:"medium",temperature:"cool",saturation:"high",family:"ocean"},{id:7,label:"Tetradic",preview:"linear-gradient(90deg, #ff4d59, #33e699, #4073ff, #ffd933)",brightness:"bright",temperature:"neutral",saturation:"high",family:"spectrum"},{id:8,label:"Pastel Triad",preview:"linear-gradient(90deg, #e6a3a3, #a3e6b8, #a3b8e6)",brightness:"medium",temperature:"neutral",saturation:"low",family:"twilight"},{id:9,label:"Bioluminescent",preview:"linear-gradient(90deg, #001426, #00a3cc, #4dff99, #004066)",brightness:"dark",temperature:"cool",saturation:"medium",family:"ocean"},{id:10,label:"Iridescent",preview:"linear-gradient(90deg, #1a004d, #0080a6, #e6338c, #ffcc33, #33e666)",brightness:"medium",temperature:"neutral",saturation:"medium",family:"twilight"},{id:11,label:"Chromatic",preview:"linear-gradient(90deg, #ff0066, #00ff88, #0066ff, #ff0066)",brightness:"bright",temperature:"neutral",saturation:"high",family:"neon"},{id:12,label:"Golden Liminal",preview:"linear-gradient(90deg, #ffbf4d, #d9738c, #664db3, #261a59)",brightness:"medium",temperature:"warm",saturation:"medium",family:"twilight"},{id:13,label:"OK Rainbow",preview:"linear-gradient(90deg, #ff6b8a, #e6a040, #8fbf40, #40bfbf, #6b8aff, #bf40bf)",brightness:"medium",temperature:"neutral",saturation:"medium",family:"spectrum"},{id:14,label:"Synesthetic",preview:"linear-gradient(90deg, #7733ff, #cc33cc, #ff33aa, #ff66cc)",brightness:"medium",temperature:"cool",saturation:"high",family:"cosmic"},{id:15,label:"Entropy",preview:"linear-gradient(90deg, #00ffff, #1a0033, #ff4d00, #00cc33)",brightness:"medium",temperature:"neutral",saturation:"high",family:"neon"},{id:16,label:"Velvet Depths",preview:"linear-gradient(90deg, #1f142e, #8c59a6, #e6d9f2, #402659)",brightness:"dark",temperature:"cool",saturation:"low",family:"cosmic"},{id:17,label:"Solar Flare",preview:"linear-gradient(90deg, #1a0000, #cc1a00, #ff9900, #ffffb3)",brightness:"bright",temperature:"warm",saturation:"high",family:"fire"},{id:18,label:"Void Pulse",preview:"linear-gradient(90deg, #000000, #660019, #cc3366, #000000)",brightness:"dark",temperature:"warm",saturation:"low",family:"cosmic"},{id:19,label:"Starless Night",preview:"linear-gradient(90deg, #050a14, #1a3a66, #050a14)",brightness:"dark",temperature:"cool",saturation:"low",family:"ocean"},{id:20,label:"Event Horizon",preview:"linear-gradient(90deg, #000000, #000000, #ff6619, #99ccff, #000000)",brightness:"dark",temperature:"neutral",saturation:"medium",family:"cosmic"}],wi={spectrum:[0,5,7,13],fire:[1,12,17,18],ocean:[2,6,9,19],cosmic:[3,14,16,18,20],neon:[4,11,15],twilight:[8,10,12]};function Qe(i){return ot.find(e=>e.id===i)}const Ti={dark:.2,medium:.5,bright:1},vt=Ae({lastChangeTime:0,cooldown:2}),gt=2.5;function bt(i,e){return i+Math.random()*(e-i)}function st(i,e){return Math.floor(Math.random()*(e-i+1))+i}function tt(i){if(i.length===0)throw new Error("randomChoice called with empty array");return i[st(0,i.length-1)]}function ki(i,e){let n=0;for(const[t,a]of i)if(a.enabled&&t!==e){const s=Qe(a.properties.theme);s&&(n+=Ti[s.brightness])}return n}function Ei(i){return ot.filter(e=>i.includes(e.brightness))}function Mi(i,e){const n={};for(const[s,r]of i)if(r.enabled&&s!==e){const o=Qe(r.properties.theme);o&&(n[o.family]=(n[o.family]||0)+1)}let t=0,a=null;for(const[s,r]of Object.entries(n))r>t&&(t=r,a=s);return a}function Si(i,e){const n=ki(i,e),t=Mi(i,e);let a;n>=gt?a=["dark"]:n>=gt-.5?a=["dark","medium"]:a=["dark","medium","bright"];const s=Ei(a);if(s.length===0)return 0;if(t&&Math.random()<.5){const r=wi[t],o=s.filter(l=>r.includes(l.id));if(o.length>0)return tt(o).id}if(Math.random()<.3){const r=new Set;for(const[o,l]of i)if(l.enabled&&o!==e){const c=Qe(l.properties.theme);c&&r.add(c.temperature)}if(r.size===1){const o=[...r][0];let l=null;if(o==="warm"?l="cool":o==="cool"&&(l="warm"),l){const c=s.filter(u=>u.temperature===l);if(c.length>0)return tt(c).id}}}return tt(s).id}function Li(i){const e=Qe(i);if(!e)return{min:.3,max:.7};switch(e.brightness){case"dark":return{min:.5,max:.9};case"medium":return{min:.3,max:.7};case"bright":return{min:.2,max:.5}}}function Bi(i){const e=Je(ce);if(!e.randomizerEnabled)return;const n=Je(vt),t=performance.now()/1e3;if(t-n.lastChangeTime<e.randomizerCooldown||i<.6)return;const a=Je(Re),s=$e.filter(l=>{const c=a.get(l.id);return l.randomizable!==!1&&(c?.includeInRandomizer||c?.includeInStrobe)});if(s.length===0)return;const r=s[st(0,s.length-1)];a.get(r.id)&&(Re.update(l=>{const c=l.get(r.id);if(!c)return l;if(e.randomizerTogglesLayers&&c.includeInStrobe&&Math.random()<e.randomizerToggleChance&&(c.enabled=!c.enabled),c.enabled&&c.includeInRandomizer){const u=$e.find(d=>d.id===r.id);if(!u)return l;for(const d of u.properties)if(d.randomizable){if(d.id==="theme"){c.properties.theme=Si(l,r.id);continue}if(d.id==="intensity"){const h=Li(c.properties.theme);c.properties.intensity=bt(h.min,h.max);continue}if(d.type==="range"&&d.min!==void 0&&d.max!==void 0){const h=d.randomMin??d.min,b=d.randomMax??d.max;d.step&&d.step>=1?c.properties[d.id]=st(h,b):c.properties[d.id]=bt(h,b)}}}return l}),vt.update(l=>({...l,lastChangeTime:t})))}const Ii={position:{x:.5,y:.5},velocity:{x:0,y:0},speed:0,isDown:!1,clickPosition:{x:.5,y:.5},isInside:!1},Ye=Ae(Ii),yt=.15,Di=.1;let Xe={x:0,y:0},it=0;function Oe(i,e,n){return Math.min(Math.max(i,e),n)}const Pi=lt(Ye,i=>(Xe.x+=(i.velocity.x-Xe.x)*yt,Xe.y+=(i.velocity.y-Xe.y)*yt,it+=(i.speed-it)*Di,{x:i.position.x,y:i.position.y,velocityX:Oe(Xe.x,-1,1),velocityY:Oe(Xe.y,-1,1),speed:Oe(it,0,1),down:i.isDown?1:0,clickX:i.clickPosition.x,clickY:i.clickPosition.y,inside:i.isInside?1:0}));function Ci(i,e,n,t){Ye.update(a=>{const s=Oe((i-n.left)/n.width,0,1),r=Oe((e-n.top)/n.height,0,1),o=Math.max(t,1),l=(s-a.position.x)/o*16.67,c=(r-a.position.y)/o*16.67,u=Math.sqrt(l*l+c*c);return{...a,position:{x:s,y:r},velocity:{x:l,y:c},speed:Oe(u*10,0,1),isInside:!0}})}function Ri(i,e,n){Ye.update(t=>{const a=Oe((i-n.left)/n.width,0,1),s=Oe((e-n.top)/n.height,0,1);return{...t,isDown:!0,clickPosition:{x:a,y:s}}})}function zi(){Ye.update(i=>({...i,isDown:!1}))}function Ai(){Ye.update(i=>({...i,isInside:!1,velocity:{x:0,y:0},speed:0}))}const Fi={fps:0,frameTime:0,targetFps:60,cpuSavings:0,mode:"normal"},Qt=Ae(Fi);function Ui(i){let e,n,t;return{c(){e=w("canvas"),this.h()},l(a){e=_(a,"CANVAS",{class:!0,"aria-label":!0}),I(e).forEach(v),this.h()},h(){m(e,"class","visualizer-canvas svelte-1nin8xa"),m(e,"aria-label","Audio reactive canvas")},m(a,s){U(a,e,s),i[9](e),n||(t=[J(e,"click",i[1]),J(e,"touchend",i[2]),J(e,"mousemove",i[3]),J(e,"mousedown",i[4]),J(e,"mouseup",i[5]),J(e,"mouseleave",i[6])],n=!0)},p:ge,i:ge,o:ge,d(a){a&&v(e),i[9](null),n=!1,ze(t)}}}const Vi=500,Ni=100,Ke=32;function Oi(i,e,n){let t,a,s,r,o;we(i,ce,k=>n(22,t=k)),we(i,pi,k=>n(23,a=k)),we(i,Pi,k=>n(24,s=k)),we(i,rt,k=>n(25,r=k)),we(i,be,k=>n(26,o=k));let l,c=null,u=null,d,h=0,b=0,g=0,S=0,E=0,P=null,D=null,f=null;function M(){P=document.createElement("canvas"),P.width=Ke,P.height=Ke,D=P.getContext("2d"),f=document.querySelector('link[rel="icon"]'),f||(f=document.createElement("link"),f.rel="icon",f.type="image/png",document.head.appendChild(f))}function y(k){if(!P||!D||!f||!l||k-g<Ni)return;g=k;const q=Math.min(l.width,l.height),K=(l.width-q)/2,j=(l.height-q)/2;D.drawImage(l,K,j,q,q,0,0,Ke,Ke);try{f.href=P.toDataURL("image/png")}catch{}}async function X(){u||(u=new ri);const k=await u.init();return at.set(k),k}function A(){u&&(u.dispose(),u=null),at.set(!1)}function T(k){const q=1e3/t.targetFps;if(t.powerSaverEnabled){const j=k-h;if(j<q){d=window.setTimeout(()=>requestAnimationFrame(T),q-j);return}}t.powerSaverEnabled?d=window.setTimeout(()=>requestAnimationFrame(T),q):d=requestAnimationFrame(T);const K=(k-h)/1e3;if(h=k,u?.isInitialized()){const j=u.update(K);Wt.set(j);const Q=o.beatGate,pe=j.beat>Q;Kt.update(Me=>{if(o.autoEnabled){if(pe)return 1;const de=.5+o.autoDecay*3.5;return Math.max(0,Me-K*de)}return 0}),Bi(j.beat)}if(c?.isInitialized()&&(c.render(k/1e3,r,s,a),y(k)),S++,k-E>=Vi){const j=(k-E)/1e3,Q=Math.round(S/j),pe=t.targetFps,Me=j*1e3/S,de=t.powerSaverEnabled?Math.round((1-pe/60)*100):0;Qt.set({fps:Q,frameTime:Me,targetFps:pe,cpuSavings:Math.max(0,de),mode:t.powerSaverEnabled?"power-saver":"normal"}),S=0,E=k}}Ht(async()=>{if(c=new si(l),await c.init()){const q=performance.now();h=q,E=q,M(),d=requestAnimationFrame(T)}}),ti(()=>{d&&(cancelAnimationFrame(d),clearTimeout(d)),c&&c.dispose(),u&&u.dispose()});function V(){ce.update(k=>({...k,panelsVisible:!k.panelsVisible}))}let C=0;function O(k){const q=Date.now();q-C<300&&N(),C=q}async function N(){document.fullscreenElement?(await document.exitFullscreen(),ce.update(k=>({...k,fullscreen:!1}))):(await document.documentElement.requestFullscreen(),ce.update(k=>({...k,fullscreen:!0})))}function H(k){if(!l)return;const q=performance.now(),K=q-b;b=q;const j=l.getBoundingClientRect();Ci(k.clientX,k.clientY,j,K)}function x(k){if(!l)return;const q=l.getBoundingClientRect();Ri(k.clientX,k.clientY,q)}function W(){zi()}function F(){Ai()}function L(k){ve[k?"unshift":"push"](()=>{l=k,n(0,l)})}return[l,V,O,H,x,W,F,X,A,L]}class $i extends Be{constructor(e){super(),Ie(this,e,Oi,Ui,Le,{enableMicrophone:7,disableMicrophone:8})}get enableMicrophone(){return this.$$.ctx[7]}get disableMicrophone(){return this.$$.ctx[8]}}function _t(i){let e,n=i[6](i[0])+"",t;return{c(){e=w("span"),t=se(n),this.h()},l(a){e=_(a,"SPAN",{class:!0});var s=I(e);t=ae(s,n),s.forEach(v),this.h()},h(){m(e,"class","slider-value svelte-13dvwfr")},m(a,s){U(a,e,s),p(e,t)},p(a,s){s&65&&n!==(n=a[6](a[0])+"")&&me(t,n)},d(a){a&&v(e)}}}function qi(i){let e,n,t,a,s,r,o,l,c,u=i[5]&&_t(i);return{c(){e=w("div"),n=w("div"),t=w("span"),a=se(i[1]),s=z(),u&&u.c(),r=z(),o=w("input"),this.h()},l(d){e=_(d,"DIV",{class:!0});var h=I(e);n=_(h,"DIV",{class:!0});var b=I(n);t=_(b,"SPAN",{class:!0});var g=I(t);a=ae(g,i[1]),g.forEach(v),s=R(b),u&&u.l(b),b.forEach(v),r=R(h),o=_(h,"INPUT",{type:!0,min:!0,max:!0,step:!0,"aria-label":!0,class:!0}),h.forEach(v),this.h()},h(){m(t,"class","slider-label svelte-13dvwfr"),m(n,"class","slider-header svelte-13dvwfr"),m(o,"type","range"),m(o,"min",i[2]),m(o,"max",i[3]),m(o,"step",i[4]),o.value=i[0],m(o,"aria-label",i[1]),m(o,"class","svelte-13dvwfr"),m(e,"class","slider svelte-13dvwfr"),Z(e,"compact",i[7])},m(d,h){U(d,e,h),p(e,n),p(n,t),p(t,a),p(n,s),u&&u.m(n,null),p(e,r),p(e,o),l||(c=J(o,"input",i[8]),l=!0)},p(d,[h]){h&2&&me(a,d[1]),d[5]?u?u.p(d,h):(u=_t(d),u.c(),u.m(n,null)):u&&(u.d(1),u=null),h&4&&m(o,"min",d[2]),h&8&&m(o,"max",d[3]),h&16&&m(o,"step",d[4]),h&1&&(o.value=d[0]),h&2&&m(o,"aria-label",d[1]),h&128&&Z(e,"compact",d[7])},i:ge,o:ge,d(d){d&&v(e),u&&u.d(),l=!1,c()}}}function Hi(i,e,n){let{label:t}=e,{value:a}=e,{min:s=0}=e,{max:r=1}=e,{step:o=.01}=e,{showValue:l=!0}=e,{formatValue:c=b=>b.toFixed(2)}=e,{compact:u=!0}=e;const d=Gt();function h(b){const g=b.target;n(0,a=parseFloat(g.value)),d("input",a)}return i.$$set=b=>{"label"in b&&n(1,t=b.label),"value"in b&&n(0,a=b.value),"min"in b&&n(2,s=b.min),"max"in b&&n(3,r=b.max),"step"in b&&n(4,o=b.step),"showValue"in b&&n(5,l=b.showValue),"formatValue"in b&&n(6,c=b.formatValue),"compact"in b&&n(7,u=b.compact)},[a,t,s,r,o,l,c,u,h]}class Ee extends Be{constructor(e){super(),Ie(this,e,Hi,qi,Le,{label:1,value:0,min:2,max:3,step:4,showValue:5,formatValue:6,compact:7})}}function Gi(i){let e,n,t,a,s,r,o;return{c(){e=w("button"),n=w("span"),t=z(),a=w("span"),s=se(i[1]),this.h()},l(l){e=_(l,"BUTTON",{class:!0,"aria-pressed":!0,type:!0});var c=I(e);n=_(c,"SPAN",{class:!0}),I(n).forEach(v),t=R(c),a=_(c,"SPAN",{class:!0});var u=I(a);s=ae(u,i[1]),u.forEach(v),c.forEach(v),this.h()},h(){m(n,"class","toggle-indicator svelte-1qxicao"),m(a,"class","toggle-label svelte-1qxicao"),m(e,"class","toggle svelte-1qxicao"),m(e,"aria-pressed",i[0]),e.disabled=i[2],m(e,"type","button"),Z(e,"checked",i[0]),Z(e,"disabled",i[2]),Z(e,"compact",i[3])},m(l,c){U(l,e,c),p(e,n),p(e,t),p(e,a),p(a,s),r||(o=J(e,"click",i[4]),r=!0)},p(l,[c]){c&2&&me(s,l[1]),c&1&&m(e,"aria-pressed",l[0]),c&4&&(e.disabled=l[2]),c&1&&Z(e,"checked",l[0]),c&4&&Z(e,"disabled",l[2]),c&8&&Z(e,"compact",l[3])},i:ge,o:ge,d(l){l&&v(e),r=!1,o()}}}function Xi(i,e,n){let{label:t}=e,{checked:a=!1}=e,{disabled:s=!1}=e,{compact:r=!0}=e;function o(){s||n(0,a=!a)}return i.$$set=l=>{"label"in l&&n(1,t=l.label),"checked"in l&&n(0,a=l.checked),"disabled"in l&&n(2,s=l.disabled),"compact"in l&&n(3,r=l.compact)},[a,t,s,r,o]}class Jt extends Be{constructor(e){super(),Ie(this,e,Xi,Gi,Le,{label:1,checked:0,disabled:2,compact:3})}}function wt(i,e,n){const t=i.slice();return t[8]=e[n],t}function Tt(i){let e;return{c(){e=w("span"),this.h()},l(n){e=_(n,"SPAN",{class:!0,style:!0}),I(e).forEach(v),this.h()},h(){m(e,"class","select-preview svelte-1weciec"),Ze(e,"background",i[2].find(i[6])?.preview)},m(n,t){U(n,e,t)},p(n,t){t&5&&Ze(e,"background",n[2].find(n[6])?.preview)},d(n){n&&v(e)}}}function kt(i){let e,n=i[8].label+"",t,a;return{c(){e=w("option"),t=se(n),this.h()},l(s){e=_(s,"OPTION",{});var r=I(e);t=ae(r,n),r.forEach(v),this.h()},h(){e.__value=a=i[8].value,dt(e,e.__value)},m(s,r){U(s,e,r),p(e,t)},p(s,r){r&4&&n!==(n=s[8].label+"")&&me(t,n),r&4&&a!==(a=s[8].value)&&(e.__value=a,dt(e,e.__value))},d(s){s&&v(e)}}}function ji(i){let e,n,t,a,s,r=i[2].find(i[5])?.preview,o,l,c,u,d=r&&Tt(i),h=xe(i[2]),b=[];for(let g=0;g<h.length;g+=1)b[g]=kt(wt(i,h,g));return{c(){e=w("div"),n=w("span"),t=se(i[1]),a=z(),s=w("div"),d&&d.c(),o=z(),l=w("select");for(let g=0;g<b.length;g+=1)b[g].c();this.h()},l(g){e=_(g,"DIV",{class:!0});var S=I(e);n=_(S,"SPAN",{class:!0});var E=I(n);t=ae(E,i[1]),E.forEach(v),a=R(S),s=_(S,"DIV",{class:!0});var P=I(s);d&&d.l(P),o=R(P),l=_(P,"SELECT",{"aria-label":!0,class:!0});var D=I(l);for(let f=0;f<b.length;f+=1)b[f].l(D);D.forEach(v),P.forEach(v),S.forEach(v),this.h()},h(){m(n,"class","select-label svelte-1weciec"),m(l,"aria-label",i[1]),m(l,"class","svelte-1weciec"),m(s,"class","select-container svelte-1weciec"),m(e,"class","select-wrapper svelte-1weciec"),Z(e,"compact",i[3])},m(g,S){U(g,e,S),p(e,n),p(n,t),p(e,a),p(e,s),d&&d.m(s,null),p(s,o),p(s,l);for(let E=0;E<b.length;E+=1)b[E]&&b[E].m(l,null);ft(l,i[0]),c||(u=J(l,"change",i[4]),c=!0)},p(g,[S]){if(S&2&&me(t,g[1]),S&5&&(r=g[2].find(g[5])?.preview),r?d?d.p(g,S):(d=Tt(g),d.c(),d.m(s,o)):d&&(d.d(1),d=null),S&4){h=xe(g[2]);let E;for(E=0;E<h.length;E+=1){const P=wt(g,h,E);b[E]?b[E].p(P,S):(b[E]=kt(P),b[E].c(),b[E].m(l,null))}for(;E<b.length;E+=1)b[E].d(1);b.length=h.length}S&5&&ft(l,g[0]),S&2&&m(l,"aria-label",g[1]),S&8&&Z(e,"compact",g[3])},i:ge,o:ge,d(g){g&&v(e),d&&d.d(),ii(b,g),c=!1,u()}}}function Zi(i,e,n){let{label:t}=e,{value:a}=e,{options:s=[]}=e,{compact:r=!0}=e;const o=Gt();function l(d){const h=d.target;n(0,a=isNaN(Number(h.value))?h.value:Number(h.value)),o("change",a)}const c=d=>d.value===a,u=d=>d.value===a;return i.$$set=d=>{"label"in d&&n(1,t=d.label),"value"in d&&n(0,a=d.value),"options"in d&&n(2,s=d.options),"compact"in d&&n(3,r=d.compact)},[a,t,s,r,l,c,u]}class ei extends Be{constructor(e){super(),Ie(this,e,Zi,ji,Le,{label:1,value:0,options:2,compact:3})}}function xi(i){let e,n,t,a,s,r,o,l,c;return{c(){e=w("div"),n=w("span"),t=se(i[0]),a=z(),s=w("div"),r=w("div"),o=z(),l=w("span"),c=se(i[1]),this.h()},l(u){e=_(u,"DIV",{class:!0});var d=I(e);n=_(d,"SPAN",{class:!0});var h=I(n);t=ae(h,i[0]),h.forEach(v),a=R(d),s=_(d,"DIV",{class:!0});var b=I(s);r=_(b,"DIV",{class:!0,style:!0}),I(r).forEach(v),b.forEach(v),o=R(d),l=_(d,"SPAN",{class:!0});var g=I(l);c=ae(g,i[1]),g.forEach(v),d.forEach(v),this.h()},h(){m(n,"class","level-label svelte-2vktfp"),m(r,"class","level-fill svelte-2vktfp"),Ze(r,"width",i[2]+"%"),m(s,"class","level-bar svelte-2vktfp"),m(l,"class","level-value svelte-2vktfp"),m(e,"class","level-meter svelte-2vktfp")},m(u,d){U(u,e,d),p(e,n),p(n,t),p(e,a),p(e,s),p(s,r),p(e,o),p(e,l),p(l,c)},p(u,[d]){d&1&&me(t,u[0]),d&4&&Ze(r,"width",u[2]+"%"),d&2&&me(c,u[1])},i:ge,o:ge,d(u){u&&v(e)}}}function Yi(i,e,n){let t,a,{label:s}=e,{value:r=0}=e,{max:o=1}=e;return i.$$set=l=>{"label"in l&&n(0,s=l.label),"value"in l&&n(3,r=l.value),"max"in l&&n(4,o=l.max)},i.$$.update=()=>{i.$$.dirty&24&&n(2,t=Math.min(100,r/o*100)),i.$$.dirty&8&&n(1,a=r.toFixed(2))},[s,a,t,r,o]}class je extends Be{constructor(e){super(),Ie(this,e,Yi,xi,Le,{label:0,value:3,max:4})}}function Et(i){let e,n,t='<span class="panel-title svelte-60ik2m">CONTROLS</span>',a,s,r,o,l,c,u,d,h='<span class="label">FULLSCR</span>',b,g,S='<span class="label">PWR SAV</span>',E,P,D='<span class="label">README</span>',f,M,y='<kbd class="svelte-60ik2m">C</kbd> panels <kbd class="svelte-60ik2m">F</kbd> fullscreen <kbd class="svelte-60ik2m">?</kbd> help',X,A;function T(O,N){return O[2]?Qi:O[3]?Ki:Wi}let V=T(i),C=V(i);return{c(){e=w("div"),n=w("div"),n.innerHTML=t,a=z(),s=w("div"),r=w("button"),o=w("span"),l=z(),c=w("span"),C.c(),u=z(),d=w("button"),d.innerHTML=h,b=z(),g=w("button"),g.innerHTML=S,E=z(),P=w("button"),P.innerHTML=D,f=z(),M=w("div"),M.innerHTML=y,this.h()},l(O){e=_(O,"DIV",{class:!0});var N=I(e);n=_(N,"DIV",{class:!0,"data-svelte-h":!0}),re(n)!=="svelte-i65zl2"&&(n.innerHTML=t),a=R(N),s=_(N,"DIV",{class:!0});var H=I(s);r=_(H,"BUTTON",{class:!0,title:!0});var x=I(r);o=_(x,"SPAN",{class:!0}),I(o).forEach(v),l=R(x),c=_(x,"SPAN",{class:!0});var W=I(c);C.l(W),W.forEach(v),x.forEach(v),u=R(H),d=_(H,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),re(d)!=="svelte-1xg66l0"&&(d.innerHTML=h),b=R(H),g=_(H,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),re(g)!=="svelte-e1kxas"&&(g.innerHTML=S),E=R(H),P=_(H,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),re(P)!=="svelte-c7hw7k"&&(P.innerHTML=D),H.forEach(v),f=R(N),M=_(N,"DIV",{class:!0,title:!0,"data-svelte-h":!0}),re(M)!=="svelte-1ll3wf0"&&(M.innerHTML=y),N.forEach(v),this.h()},h(){m(n,"class","panel-header svelte-60ik2m"),m(o,"class","indicator svelte-60ik2m"),Z(o,"on",i[3]),m(c,"class","label"),m(r,"class","ctrl-btn mic svelte-60ik2m"),r.disabled=i[2],m(r,"title","Enable microphone to let visuals react to music and sounds around you"),Z(r,"active",i[3]),Z(r,"loading",i[2]),m(d,"class","ctrl-btn svelte-60ik2m"),m(d,"title","Enter or exit fullscreen mode for an immersive experience"),Z(d,"active",i[4].fullscreen),m(g,"class","ctrl-btn svelte-60ik2m"),m(g,"title","Reduce frame rate to save battery and CPU on laptops"),Z(g,"active",i[4].powerSaverEnabled),m(P,"class","ctrl-btn svelte-60ik2m"),m(P,"title","Show help and information (press ?)"),m(s,"class","controls-grid svelte-60ik2m"),m(M,"class","panel-footer svelte-60ik2m"),m(M,"title","Keyboard shortcuts for quick access"),m(e,"class","panel controls-panel svelte-60ik2m")},m(O,N){U(O,e,N),p(e,n),p(e,a),p(e,s),p(s,r),p(r,o),p(r,l),p(r,c),C.m(c,null),p(s,u),p(s,d),p(s,b),p(s,g),p(s,E),p(s,P),p(e,f),p(e,M),X||(A=[J(r,"click",i[5]),J(d,"click",i[6]),J(g,"click",bi),J(P,"click",function(){ni(i[0])&&i[0].apply(this,arguments)})],X=!0)},p(O,N){i=O,N&8&&Z(o,"on",i[3]),V!==(V=T(i))&&(C.d(1),C=V(i),C&&(C.c(),C.m(c,null))),N&4&&(r.disabled=i[2]),N&8&&Z(r,"active",i[3]),N&4&&Z(r,"loading",i[2]),N&16&&Z(d,"active",i[4].fullscreen),N&16&&Z(g,"active",i[4].powerSaverEnabled)},d(O){O&&v(e),C.d(),X=!1,ze(A)}}}function Wi(i){let e;return{c(){e=se("MIC OFF")},l(n){e=ae(n,"MIC OFF")},m(n,t){U(n,e,t)},d(n){n&&v(e)}}}function Ki(i){let e;return{c(){e=se("MIC ON")},l(n){e=ae(n,"MIC ON")},m(n,t){U(n,e,t)},d(n){n&&v(e)}}}function Qi(i){let e;return{c(){e=se("...")},l(n){e=ae(n,"...")},m(n,t){U(n,e,t)},d(n){n&&v(e)}}}function Ji(i){let e,n=i[1]&&Et(i);return{c(){n&&n.c(),e=he()},l(t){n&&n.l(t),e=he()},m(t,a){n&&n.m(t,a),U(t,e,a)},p(t,[a]){t[1]?n?n.p(t,a):(n=Et(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:ge,o:ge,d(t){t&&v(e),n&&n.d(t)}}}function en(i,e,n){let t,a;we(i,at,h=>n(3,t=h)),we(i,ce,h=>n(4,a=h));let{onEnableMic:s}=e,{onDisableMic:r}=e,{onShowInfo:o}=e,{visible:l=!0}=e,c=!1;async function u(){if(t){r();return}n(2,c=!0),await s(),n(2,c=!1)}async function d(){document.fullscreenElement?(await document.exitFullscreen(),ce.update(h=>({...h,fullscreen:!1}))):(await document.documentElement.requestFullscreen(),ce.update(h=>({...h,fullscreen:!0})))}return i.$$set=h=>{"onEnableMic"in h&&n(7,s=h.onEnableMic),"onDisableMic"in h&&n(8,r=h.onDisableMic),"onShowInfo"in h&&n(0,o=h.onShowInfo),"visible"in h&&n(1,l=h.visible)},[o,l,c,t,a,u,d,s,r]}class tn extends Be{constructor(e){super(),Ie(this,e,en,Ji,Le,{onEnableMic:7,onDisableMic:8,onShowInfo:0,visible:1})}}function Mt(i,e,n){const t=i.slice();return t[16]=e[n].definition,t[17]=e[n].state,t}function St(i,e,n){const t=i.slice();return t[20]=e[n],t}function Lt(i){let e,n,t,a,s,r,o,l="LAYERS",c,u,d=i[1].filter(Ct).length+"",h,b,g=i[1].length+"",S,E,P,D,f="RANDOM",M,y,X="STROBE",A,T,V=[],C=new Map,O,N,H,x=xe(i[1]);const W=F=>F[16].id;for(let F=0;F<x.length;F+=1){let L=Mt(i,x,F),k=W(L);C.set(k,V[F]=Pt(k,L))}return{c(){e=w("div"),n=w("div"),t=w("button"),a=w("span"),r=z(),o=w("span"),o.textContent=l,c=z(),u=w("span"),h=se(d),b=se("/"),S=se(g),E=z(),P=w("div"),D=w("button"),D.textContent=f,M=z(),y=w("button"),y.textContent=X,A=z(),T=w("div");for(let F=0;F<V.length;F+=1)V[F].c();this.h()},l(F){e=_(F,"DIV",{class:!0});var L=I(e);n=_(L,"DIV",{class:!0});var k=I(n);t=_(k,"BUTTON",{class:!0,title:!0,type:!0});var q=I(t);a=_(q,"SPAN",{class:!0}),I(a).forEach(v),q.forEach(v),r=R(k),o=_(k,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),re(o)!=="svelte-1k3t9ew"&&(o.textContent=l),c=R(k),u=_(k,"SPAN",{class:!0,title:!0});var K=I(u);h=ae(K,d),b=ae(K,"/"),S=ae(K,g),K.forEach(v),k.forEach(v),E=R(L),P=_(L,"DIV",{class:!0});var j=I(P);D=_(j,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),re(D)!=="svelte-oljq6x"&&(D.textContent=f),M=R(j),y=_(j,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),re(y)!=="svelte-1j3wa1w"&&(y.textContent=X),j.forEach(v),A=R(L),T=_(L,"DIV",{class:!0});var Q=I(T);for(let pe=0;pe<V.length;pe+=1)V[pe].l(Q);Q.forEach(v),L.forEach(v),this.h()},h(){m(a,"class","master-indicator svelte-19n2guw"),m(t,"class","master-toggle svelte-19n2guw"),m(t,"title",s=i[3]?"Turn off all layers":"Turn on all layers"),m(t,"type","button"),Z(t,"active",i[3]),m(o,"class","panel-title svelte-19n2guw"),m(o,"title","Visual effect layers - toggle and customize each one"),m(u,"class","panel-count svelte-19n2guw"),m(u,"title","Number of active layers"),m(n,"class","panel-header svelte-19n2guw"),m(D,"class","global-btn svelte-19n2guw"),m(D,"title","Automatically change visual settings on every beat for variety"),m(D,"type","button"),Z(D,"active",i[4].randomizerEnabled),m(y,"class","global-btn strobe svelte-19n2guw"),m(y,"title","Flash layers on/off with the beat for a strobe-like effect"),m(y,"type","button"),Z(y,"active",i[4].randomizerTogglesLayers),m(P,"class","global-controls svelte-19n2guw"),m(T,"class","layer-list svelte-19n2guw"),m(e,"class","panel layers-panel svelte-19n2guw")},m(F,L){U(F,e,L),p(e,n),p(n,t),p(t,a),p(n,r),p(n,o),p(n,c),p(n,u),p(u,h),p(u,b),p(u,S),p(e,E),p(e,P),p(P,D),p(P,M),p(P,y),p(e,A),p(e,T);for(let k=0;k<V.length;k+=1)V[k]&&V[k].m(T,null);O=!0,N||(H=[J(t,"click",i[5]),J(D,"click",yi),J(y,"click",_i)],N=!0)},p(F,L){(!O||L&8&&s!==(s=F[3]?"Turn off all layers":"Turn on all layers"))&&m(t,"title",s),(!O||L&8)&&Z(t,"active",F[3]),(!O||L&2)&&d!==(d=F[1].filter(Ct).length+"")&&me(h,d),(!O||L&2)&&g!==(g=F[1].length+"")&&me(S,g),(!O||L&16)&&Z(D,"active",F[4].randomizerEnabled),(!O||L&16)&&Z(y,"active",F[4].randomizerTogglesLayers),L&198&&(x=xe(F[1]),De(),V=Zt(V,L,W,1,F,x,C,T,jt,Pt,null,Mt),Pe())},i(F){if(!O){for(let L=0;L<x.length;L+=1)$(V[L]);O=!0}},o(F){for(let L=0;L<V.length;L+=1)G(V[L]);O=!1},d(F){F&&v(e);for(let L=0;L<V.length;L+=1)V[L].d();N=!1,ze(H)}}}function Bt(i){let e,n="R",t,a,s="S",r,o;function l(){return i[11](i[16])}function c(){return i[12](i[16])}return{c(){e=w("button"),e.textContent=n,t=z(),a=w("button"),a.textContent=s,this.h()},l(u){e=_(u,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),re(e)!=="svelte-mwgvpg"&&(e.textContent=n),t=R(u),a=_(u,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),re(a)!=="svelte-v7hsdo"&&(a.textContent=s),this.h()},h(){m(e,"class","quick-btn svelte-19n2guw"),m(e,"title","Include in randomizer - properties (theme, intensity, zoom) will change automatically"),m(e,"type","button"),Z(e,"active",i[17].includeInRandomizer),m(a,"class","quick-btn strobe-btn svelte-19n2guw"),m(a,"title","Include in strobe - layer can flash on/off with the beat"),m(a,"type","button"),Z(a,"active",i[17].includeInStrobe)},m(u,d){U(u,e,d),U(u,t,d),U(u,a,d),r||(o=[J(e,"click",l),J(a,"click",c)],r=!0)},p(u,d){i=u,d&2&&Z(e,"active",i[17].includeInRandomizer),d&2&&Z(a,"active",i[17].includeInStrobe)},d(u){u&&(v(e),v(t),v(a)),r=!1,ze(o)}}}function It(i){let e,n=[],t=new Map,a,s=xe(i[16].properties);const r=o=>o[20].id;for(let o=0;o<s.length;o+=1){let l=St(i,s,o),c=r(l);t.set(c,n[o]=Dt(c,l))}return{c(){e=w("div");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=_(o,"DIV",{class:!0});var l=I(e);for(let c=0;c<n.length;c+=1)n[c].l(l);l.forEach(v),this.h()},h(){m(e,"class","layer-controls svelte-19n2guw")},m(o,l){U(o,e,l);for(let c=0;c<n.length;c+=1)n[c]&&n[c].m(e,null);a=!0},p(o,l){l&66&&(s=xe(o[16].properties),De(),n=Zt(n,l,r,1,o,s,t,e,jt,Dt,null,St),Pe())},i(o){if(!a){for(let l=0;l<s.length;l+=1)$(n[l]);a=!0}},o(o){for(let l=0;l<n.length;l+=1)G(n[l]);a=!1},d(o){o&&v(e);for(let l=0;l<n.length;l+=1)n[l].d()}}}function nn(i){let e,n,t,a;function s(...r){return i[15](i[16],i[20],...r)}return n=new ei({props:{label:"Thm",value:i[17].properties[i[20].id]??i[20].default,options:i[6]}}),n.$on("change",s),{c(){e=w("div"),ne(n.$$.fragment),t=z(),this.h()},l(r){e=_(r,"DIV",{title:!0});var o=I(e);ie(n.$$.fragment,o),t=R(o),o.forEach(v),this.h()},h(){m(e,"title","Color scheme for this visual effect")},m(r,o){U(r,e,o),te(n,e,null),p(e,t),a=!0},p(r,o){i=r;const l={};o&2&&(l.value=i[17].properties[i[20].id]??i[20].default),n.$set(l)},i(r){a||($(n.$$.fragment,r),a=!0)},o(r){G(n.$$.fragment,r),a=!1},d(r){r&&v(e),ee(n)}}}function an(i){let e,n,t,a,s;function r(...o){return i[14](i[16],i[20],...o)}return n=new Ee({props:{label:i[20].label.slice(0,4),value:i[17].properties[i[20].id]??i[20].default,min:i[20].min??0,max:i[20].max??1,step:i[20].step??.01}}),n.$on("input",r),{c(){e=w("div"),ne(n.$$.fragment),t=z(),this.h()},l(o){e=_(o,"DIV",{title:!0});var l=I(e);ie(n.$$.fragment,l),t=R(l),l.forEach(v),this.h()},h(){m(e,"title",a=i[20].id==="intensity"?"How visible/strong this effect is":i[20].id==="zoom"?"Scale/size of the effect pattern":i[20].id==="sensitivity"?"How much this layer reacts to audio":i[20].label)},m(o,l){U(o,e,l),te(n,e,null),p(e,t),s=!0},p(o,l){i=o;const c={};l&2&&(c.label=i[20].label.slice(0,4)),l&2&&(c.value=i[17].properties[i[20].id]??i[20].default),l&2&&(c.min=i[20].min??0),l&2&&(c.max=i[20].max??1),l&2&&(c.step=i[20].step??.01),n.$set(c),(!s||l&2&&a!==(a=i[20].id==="intensity"?"How visible/strong this effect is":i[20].id==="zoom"?"Scale/size of the effect pattern":i[20].id==="sensitivity"?"How much this layer reacts to audio":i[20].label))&&m(e,"title",a)},i(o){s||($(n.$$.fragment,o),s=!0)},o(o){G(n.$$.fragment,o),s=!1},d(o){o&&v(e),ee(n)}}}function Dt(i,e){let n,t,a,s,r;const o=[an,nn],l=[];function c(u,d){return u[20].type==="range"?0:u[20].type==="select"&&u[20].id==="theme"?1:-1}return~(t=c(e))&&(a=l[t]=o[t](e)),{key:i,first:null,c(){n=he(),a&&a.c(),s=he(),this.h()},l(u){n=he(),a&&a.l(u),s=he(),this.h()},h(){this.first=n},m(u,d){U(u,n,d),~t&&l[t].m(u,d),U(u,s,d),r=!0},p(u,d){e=u;let h=t;t=c(e),t===h?~t&&l[t].p(e,d):(a&&(De(),G(l[h],1,1,()=>{l[h]=null}),Pe()),~t?(a=l[t],a?a.p(e,d):(a=l[t]=o[t](e),a.c()),$(a,1),a.m(s.parentNode,s)):a=null)},i(u){r||($(a),r=!0)},o(u){G(a),r=!1},d(u){u&&(v(n),v(s)),~t&&l[t].d(u)}}}function Pt(i,e){let n,t,a,s,r,o,l=e[16].label+"",c,u,d,h,b,g,S=e[2]===e[16].id?"":"+",E,P,D,f,M,y;function X(){return e[9](e[16])}function A(){return e[10](e[16])}let T=e[16].randomizable!==!1&&Bt(e);function V(){return e[13](e[16])}let C=e[2]===e[16].id&&It(e);return{key:i,first:null,c(){n=w("div"),t=w("div"),a=w("button"),s=w("span"),r=z(),o=w("button"),c=se(l),d=z(),h=w("div"),T&&T.c(),b=z(),g=w("button"),E=se(S),P=z(),C&&C.c(),D=z(),this.h()},l(O){n=_(O,"DIV",{class:!0});var N=I(n);t=_(N,"DIV",{class:!0});var H=I(t);a=_(H,"BUTTON",{class:!0,type:!0,title:!0});var x=I(a);s=_(x,"SPAN",{class:!0}),I(s).forEach(v),x.forEach(v),r=R(H),o=_(H,"BUTTON",{class:!0,type:!0,title:!0});var W=I(o);c=ae(W,l),W.forEach(v),d=R(H),h=_(H,"DIV",{class:!0});var F=I(h);T&&T.l(F),b=R(F),g=_(F,"BUTTON",{class:!0,type:!0,title:!0});var L=I(g);E=ae(L,S),L.forEach(v),F.forEach(v),H.forEach(v),P=R(N),C&&C.l(N),D=R(N),N.forEach(v),this.h()},h(){m(s,"class","indicator svelte-19n2guw"),Z(s,"active",e[17].enabled),m(a,"class","layer-toggle svelte-19n2guw"),m(a,"type","button"),m(a,"title","Turn this visual effect on or off"),m(o,"class","layer-name svelte-19n2guw"),m(o,"type","button"),m(o,"title",u=e[16].description+" - click to adjust settings"),m(g,"class","quick-btn expand-btn svelte-19n2guw"),m(g,"type","button"),m(g,"title","Expand to see detailed controls for this layer"),m(h,"class","layer-quick svelte-19n2guw"),m(t,"class","layer-row svelte-19n2guw"),m(n,"class","layer-item svelte-19n2guw"),Z(n,"disabled",!e[17].enabled),Z(n,"expanded",e[2]===e[16].id),this.first=n},m(O,N){U(O,n,N),p(n,t),p(t,a),p(a,s),p(t,r),p(t,o),p(o,c),p(t,d),p(t,h),T&&T.m(h,null),p(h,b),p(h,g),p(g,E),p(n,P),C&&C.m(n,null),p(n,D),f=!0,M||(y=[J(a,"click",X),J(o,"click",A),J(g,"click",V)],M=!0)},p(O,N){e=O,(!f||N&2)&&Z(s,"active",e[17].enabled),(!f||N&2)&&l!==(l=e[16].label+"")&&me(c,l),(!f||N&2&&u!==(u=e[16].description+" - click to adjust settings"))&&m(o,"title",u),e[16].randomizable!==!1?T?T.p(e,N):(T=Bt(e),T.c(),T.m(h,b)):T&&(T.d(1),T=null),(!f||N&6)&&S!==(S=e[2]===e[16].id?"":"+")&&me(E,S),e[2]===e[16].id?C?(C.p(e,N),N&6&&$(C,1)):(C=It(e),C.c(),$(C,1),C.m(n,D)):C&&(De(),G(C,1,1,()=>{C=null}),Pe()),(!f||N&2)&&Z(n,"disabled",!e[17].enabled),(!f||N&6)&&Z(n,"expanded",e[2]===e[16].id)},i(O){f||($(C),f=!0)},o(O){G(C),f=!1},d(O){O&&v(n),T&&T.d(),C&&C.d(),M=!1,ze(y)}}}function sn(i){let e,n,t=i[0]&&Lt(i);return{c(){t&&t.c(),e=he()},l(a){t&&t.l(a),e=he()},m(a,s){t&&t.m(a,s),U(a,e,s),n=!0},p(a,[s]){a[0]?t?(t.p(a,s),s&1&&$(t,1)):(t=Lt(a),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(De(),G(t,1,1,()=>{t=null}),Pe())},i(a){n||($(t),n=!0)},o(a){G(t),n=!1},d(a){a&&v(e),t&&t.d(a)}}}const Ct=i=>i.state.enabled;function ln(i,e,n){let t,a,s,r;we(i,Re,f=>n(8,s=f)),we(i,ce,f=>n(4,r=f));let{visible:o=!0}=e,l=null;function c(){hi(!a)}const u=ot.map(f=>({value:f.id,label:f.label,preview:f.preview}));function d(f){n(2,l=l===f?null:f)}const h=f=>di(f.id),b=f=>d(f.id),g=f=>ci(f.id),S=f=>mi(f.id),E=f=>d(f.id),P=(f,M,y)=>pt(f.id,M.id,y.detail),D=(f,M,y)=>pt(f.id,M.id,y.detail);return i.$$set=f=>{"visible"in f&&n(0,o=f.visible)},i.$$.update=()=>{i.$$.dirty&256&&n(1,t=$e.map(f=>({definition:f,state:s.get(f.id)})).filter(f=>f.state)),i.$$.dirty&2&&n(3,a=t.some(f=>f.state.enabled))},[o,t,l,a,r,c,u,d,s,h,b,g,S,E,P,D]}class rn extends Be{constructor(e){super(),Ie(this,e,ln,sn,Le,{visible:0})}}function Rt(i){let e,n,t='<span class="panel-title svelte-9wroah">LEVELS</span>',a,s,r,o,l,c,u,d,h,b,g,S,E,P,D,f,M,y,X,A;return o=new je({props:{label:"HI",value:i[1].raw.highs}}),u=new je({props:{label:"MD",value:i[1].raw.mids}}),b=new je({props:{label:"LO",value:i[1].raw.lows}}),E=new je({props:{label:"TR",value:i[1].raw.treble}}),f=new je({props:{label:"BS",value:i[1].raw.bass}}),X=new je({props:{label:"BT",value:i[1].raw.beat}}),{c(){e=w("div"),n=w("div"),n.innerHTML=t,a=z(),s=w("div"),r=w("div"),ne(o.$$.fragment),l=z(),c=w("div"),ne(u.$$.fragment),d=z(),h=w("div"),ne(b.$$.fragment),g=z(),S=w("div"),ne(E.$$.fragment),P=z(),D=w("div"),ne(f.$$.fragment),M=z(),y=w("div"),ne(X.$$.fragment),this.h()},l(T){e=_(T,"DIV",{class:!0});var V=I(e);n=_(V,"DIV",{class:!0,title:!0,"data-svelte-h":!0}),re(n)!=="svelte-1qdq6z0"&&(n.innerHTML=t),a=R(V),s=_(V,"DIV",{class:!0});var C=I(s);r=_(C,"DIV",{title:!0});var O=I(r);ie(o.$$.fragment,O),O.forEach(v),l=R(C),c=_(C,"DIV",{title:!0});var N=I(c);ie(u.$$.fragment,N),N.forEach(v),d=R(C),h=_(C,"DIV",{title:!0});var H=I(h);ie(b.$$.fragment,H),H.forEach(v),g=R(C),S=_(C,"DIV",{title:!0});var x=I(S);ie(E.$$.fragment,x),x.forEach(v),P=R(C),D=_(C,"DIV",{title:!0});var W=I(D);ie(f.$$.fragment,W),W.forEach(v),M=R(C),y=_(C,"DIV",{title:!0});var F=I(y);ie(X.$$.fragment,F),F.forEach(v),C.forEach(v),V.forEach(v),this.h()},h(){m(n,"class","panel-header svelte-9wroah"),m(n,"title","Real-time audio levels from your microphone"),m(r,"title","High frequencies - cymbals, hi-hats, bright sounds"),m(c,"title","Mid frequencies - vocals, guitars, main melody"),m(h,"title","Low frequencies - bass, kick drum, rumble"),m(S,"title","Treble - combined high-pitched sounds"),m(D,"title","Bass - combined low-pitched sounds"),m(y,"title","Beat detection - pulses when drums or strong beats hit"),m(s,"class","levels-grid svelte-9wroah"),m(e,"class","panel levels-panel svelte-9wroah")},m(T,V){U(T,e,V),p(e,n),p(e,a),p(e,s),p(s,r),te(o,r,null),p(s,l),p(s,c),te(u,c,null),p(s,d),p(s,h),te(b,h,null),p(s,g),p(s,S),te(E,S,null),p(s,P),p(s,D),te(f,D,null),p(s,M),p(s,y),te(X,y,null),A=!0},p(T,V){const C={};V&2&&(C.value=T[1].raw.highs),o.$set(C);const O={};V&2&&(O.value=T[1].raw.mids),u.$set(O);const N={};V&2&&(N.value=T[1].raw.lows),b.$set(N);const H={};V&2&&(H.value=T[1].raw.treble),E.$set(H);const x={};V&2&&(x.value=T[1].raw.bass),f.$set(x);const W={};V&2&&(W.value=T[1].raw.beat),X.$set(W)},i(T){A||($(o.$$.fragment,T),$(u.$$.fragment,T),$(b.$$.fragment,T),$(E.$$.fragment,T),$(f.$$.fragment,T),$(X.$$.fragment,T),A=!0)},o(T){G(o.$$.fragment,T),G(u.$$.fragment,T),G(b.$$.fragment,T),G(E.$$.fragment,T),G(f.$$.fragment,T),G(X.$$.fragment,T),A=!1},d(T){T&&v(e),ee(o),ee(u),ee(b),ee(E),ee(f),ee(X)}}}function on(i){let e,n,t=i[0]&&Rt(i);return{c(){t&&t.c(),e=he()},l(a){t&&t.l(a),e=he()},m(a,s){t&&t.m(a,s),U(a,e,s),n=!0},p(a,[s]){a[0]?t?(t.p(a,s),s&1&&$(t,1)):(t=Rt(a),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(De(),G(t,1,1,()=>{t=null}),Pe())},i(a){n||($(t),n=!0)},o(a){G(t),n=!1},d(a){a&&v(e),t&&t.d(a)}}}function un(i,e,n){let t;we(i,rt,s=>n(1,t=s));let{visible:a=!0}=e;return i.$$set=s=>{"visible"in s&&n(0,a=s.visible)},[a,t]}class fn extends Be{constructor(e){super(),Ie(this,e,un,on,Le,{visible:0})}}function zt(i){let e,n,t,a="TUNING",s,r,o=i[1]?"":"+",l,c,u,d,h,b,g,S,E,P,D,f,M,y,X,A,T,V;function C(L){i[5](L)}let O={label:"Sens",min:0,max:2,formatValue:i[3]};i[2].sensitivity!==void 0&&(O.value=i[2].sensitivity),h=new Ee({props:O}),ve.push(()=>_e(h,"value",C));function N(L){i[6](L)}let H={label:"Beat",min:0,max:2,formatValue:i[3]};i[2].beatBoost!==void 0&&(H.value=i[2].beatBoost),E=new Ee({props:H}),ve.push(()=>_e(E,"value",N));function x(L){i[7](L)}let W={label:"Gate",min:0,max:1,formatValue:i[3]};i[2].beatGate!==void 0&&(W.value=i[2].beatGate),M=new Ee({props:W}),ve.push(()=>_e(M,"value",x));let F=i[1]&&At(i);return{c(){e=w("div"),n=w("div"),t=w("span"),t.textContent=a,s=z(),r=w("button"),l=se(o),c=z(),u=w("div"),d=w("div"),ne(h.$$.fragment),g=z(),S=w("div"),ne(E.$$.fragment),D=z(),f=w("div"),ne(M.$$.fragment),X=z(),F&&F.c(),this.h()},l(L){e=_(L,"DIV",{class:!0});var k=I(e);n=_(k,"DIV",{class:!0});var q=I(n);t=_(q,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),re(t)!=="svelte-hff578"&&(t.textContent=a),s=R(q),r=_(q,"BUTTON",{class:!0,title:!0});var K=I(r);l=ae(K,o),K.forEach(v),q.forEach(v),c=R(k),u=_(k,"DIV",{class:!0});var j=I(u);d=_(j,"DIV",{title:!0});var Q=I(d);ie(h.$$.fragment,Q),Q.forEach(v),g=R(j),S=_(j,"DIV",{title:!0});var pe=I(S);ie(E.$$.fragment,pe),pe.forEach(v),D=R(j),f=_(j,"DIV",{title:!0});var Me=I(f);ie(M.$$.fragment,Me),Me.forEach(v),X=R(j),F&&F.l(j),j.forEach(v),k.forEach(v),this.h()},h(){m(t,"class","panel-title svelte-1rkomi4"),m(t,"title","Adjust how visuals respond to audio"),m(r,"class","toggle-advanced svelte-1rkomi4"),m(r,"title","Show more advanced audio controls"),m(n,"class","panel-header svelte-1rkomi4"),m(d,"title","Overall sensitivity - how much visuals react to sound"),m(S,"title","Beat boost - make beat reactions stronger or weaker"),m(f,"title","Beat gate - ignore quiet sounds, only react to loud beats"),m(u,"class","tuning-grid svelte-1rkomi4"),m(e,"class","panel tuning-panel svelte-1rkomi4")},m(L,k){U(L,e,k),p(e,n),p(n,t),p(n,s),p(n,r),p(r,l),p(e,c),p(e,u),p(u,d),te(h,d,null),p(u,g),p(u,S),te(E,S,null),p(u,D),p(u,f),te(M,f,null),p(u,X),F&&F.m(u,null),A=!0,T||(V=J(r,"click",i[4]),T=!0)},p(L,k){(!A||k&2)&&o!==(o=L[1]?"":"+")&&me(l,o);const q={};!b&&k&4&&(b=!0,q.value=L[2].sensitivity,ye(()=>b=!1)),h.$set(q);const K={};!P&&k&4&&(P=!0,K.value=L[2].beatBoost,ye(()=>P=!1)),E.$set(K);const j={};!y&&k&4&&(y=!0,j.value=L[2].beatGate,ye(()=>y=!1)),M.$set(j),L[1]?F?(F.p(L,k),k&2&&$(F,1)):(F=At(L),F.c(),$(F,1),F.m(u,null)):F&&(De(),G(F,1,1,()=>{F=null}),Pe())},i(L){A||($(h.$$.fragment,L),$(E.$$.fragment,L),$(M.$$.fragment,L),$(F),A=!0)},o(L){G(h.$$.fragment,L),G(E.$$.fragment,L),G(M.$$.fragment,L),G(F),A=!1},d(L){L&&v(e),ee(h),ee(E),ee(M),F&&F.d(),T=!1,V()}}}function At(i){let e,n,t,a,s,r,o,l,c,u,d,h,b,g,S,E,P,D,f,M,y,X,A,T,V,C,O,N,H,x,W,F,L,k;function q(B){i[8](B)}let K={label:"Hi+",min:0,max:2,formatValue:i[3]};i[2].highsBoost!==void 0&&(K.value=i[2].highsBoost),a=new Ee({props:K}),ve.push(()=>_e(a,"value",q));function j(B){i[9](B)}let Q={label:"Mid+",min:0,max:2,formatValue:i[3]};i[2].midsBoost!==void 0&&(Q.value=i[2].midsBoost),l=new Ee({props:Q}),ve.push(()=>_e(l,"value",j));function pe(B){i[10](B)}let Me={label:"Low+",min:0,max:2,formatValue:i[3]};i[2].lowsBoost!==void 0&&(Me.value=i[2].lowsBoost),h=new Ee({props:Me}),ve.push(()=>_e(h,"value",pe));function de(B){i[11](B)}let ue={label:"Trbl",min:0,max:2,formatValue:i[3]};i[2].trebleBoost!==void 0&&(ue.value=i[2].trebleBoost),E=new Ee({props:ue}),ve.push(()=>_e(E,"value",de));function We(B){i[12](B)}let qe={label:"Bass",min:0,max:2,formatValue:i[3]};i[2].bassBoost!==void 0&&(qe.value=i[2].bassBoost),M=new Ee({props:qe}),ve.push(()=>_e(M,"value",We));function Te(B){i[13](B)}let le={label:"Min",min:0,max:.1,step:.005,formatValue:i[3]};i[2].minMotion!==void 0&&(le.value=i[2].minMotion),T=new Ee({props:le}),ve.push(()=>_e(T,"value",Te));function oe(B){i[14](B)}let He={label:"Auto Suggest"};i[2].autoEnabled!==void 0&&(He.checked=i[2].autoEnabled),x=new Jt({props:He}),ve.push(()=>_e(x,"checked",oe));let fe=i[2].autoEnabled&&Ft(i);return{c(){e=w("div"),n=z(),t=w("div"),ne(a.$$.fragment),r=z(),o=w("div"),ne(l.$$.fragment),u=z(),d=w("div"),ne(h.$$.fragment),g=z(),S=w("div"),ne(E.$$.fragment),D=z(),f=w("div"),ne(M.$$.fragment),X=z(),A=w("div"),ne(T.$$.fragment),C=z(),O=w("div"),N=z(),H=w("div"),ne(x.$$.fragment),F=z(),fe&&fe.c(),L=he(),this.h()},l(B){e=_(B,"DIV",{class:!0}),I(e).forEach(v),n=R(B),t=_(B,"DIV",{title:!0});var Y=I(t);ie(a.$$.fragment,Y),Y.forEach(v),r=R(B),o=_(B,"DIV",{title:!0});var Fe=I(o);ie(l.$$.fragment,Fe),Fe.forEach(v),u=R(B),d=_(B,"DIV",{title:!0});var Ce=I(d);ie(h.$$.fragment,Ce),Ce.forEach(v),g=R(B),S=_(B,"DIV",{title:!0});var Se=I(S);ie(E.$$.fragment,Se),Se.forEach(v),D=R(B),f=_(B,"DIV",{title:!0});var Ue=I(f);ie(M.$$.fragment,Ue),Ue.forEach(v),X=R(B),A=_(B,"DIV",{title:!0});var Ve=I(A);ie(T.$$.fragment,Ve),Ve.forEach(v),C=R(B),O=_(B,"DIV",{class:!0}),I(O).forEach(v),N=R(B),H=_(B,"DIV",{title:!0});var Ne=I(H);ie(x.$$.fragment,Ne),Ne.forEach(v),F=R(B),fe&&fe.l(B),L=he(),this.h()},h(){m(e,"class","divider svelte-1rkomi4"),m(t,"title","Boost high frequency response (cymbals, hi-hats)"),m(o,"title","Boost mid frequency response (vocals, guitars)"),m(d,"title","Boost low frequency response (bass, kick drums)"),m(S,"title","Boost treble (bright, high-pitched sounds)"),m(f,"title","Boost bass (deep, low-pitched sounds)"),m(A,"title","Minimum motion - keep some movement even in silence"),m(O,"class","divider svelte-1rkomi4"),m(H,"title","Automatically adjust settings based on audio levels")},m(B,Y){U(B,e,Y),U(B,n,Y),U(B,t,Y),te(a,t,null),U(B,r,Y),U(B,o,Y),te(l,o,null),U(B,u,Y),U(B,d,Y),te(h,d,null),U(B,g,Y),U(B,S,Y),te(E,S,null),U(B,D,Y),U(B,f,Y),te(M,f,null),U(B,X,Y),U(B,A,Y),te(T,A,null),U(B,C,Y),U(B,O,Y),U(B,N,Y),U(B,H,Y),te(x,H,null),U(B,F,Y),fe&&fe.m(B,Y),U(B,L,Y),k=!0},p(B,Y){const Fe={};!s&&Y&4&&(s=!0,Fe.value=B[2].highsBoost,ye(()=>s=!1)),a.$set(Fe);const Ce={};!c&&Y&4&&(c=!0,Ce.value=B[2].midsBoost,ye(()=>c=!1)),l.$set(Ce);const Se={};!b&&Y&4&&(b=!0,Se.value=B[2].lowsBoost,ye(()=>b=!1)),h.$set(Se);const Ue={};!P&&Y&4&&(P=!0,Ue.value=B[2].trebleBoost,ye(()=>P=!1)),E.$set(Ue);const Ve={};!y&&Y&4&&(y=!0,Ve.value=B[2].bassBoost,ye(()=>y=!1)),M.$set(Ve);const Ne={};!V&&Y&4&&(V=!0,Ne.value=B[2].minMotion,ye(()=>V=!1)),T.$set(Ne);const ut={};!W&&Y&4&&(W=!0,ut.checked=B[2].autoEnabled,ye(()=>W=!1)),x.$set(ut),B[2].autoEnabled?fe?(fe.p(B,Y),Y&4&&$(fe,1)):(fe=Ft(B),fe.c(),$(fe,1),fe.m(L.parentNode,L)):fe&&(De(),G(fe,1,1,()=>{fe=null}),Pe())},i(B){k||($(a.$$.fragment,B),$(l.$$.fragment,B),$(h.$$.fragment,B),$(E.$$.fragment,B),$(M.$$.fragment,B),$(T.$$.fragment,B),$(x.$$.fragment,B),$(fe),k=!0)},o(B){G(a.$$.fragment,B),G(l.$$.fragment,B),G(h.$$.fragment,B),G(E.$$.fragment,B),G(M.$$.fragment,B),G(T.$$.fragment,B),G(x.$$.fragment,B),G(fe),k=!1},d(B){B&&(v(e),v(n),v(t),v(r),v(o),v(u),v(d),v(g),v(S),v(D),v(f),v(X),v(A),v(C),v(O),v(N),v(H),v(F),v(L)),ee(a),ee(l),ee(h),ee(E),ee(M),ee(T),ee(x),fe&&fe.d(B)}}}function Ft(i){let e,n,t,a,s,r,o,l,c,u,d,h;function b(f){i[15](f)}let g={label:"Str",min:0,max:1,formatValue:i[3]};i[2].autoStrength!==void 0&&(g.value=i[2].autoStrength),n=new Ee({props:g}),ve.push(()=>_e(n,"value",b));function S(f){i[16](f)}let E={label:"Dec",min:0,max:1,formatValue:i[3]};i[2].autoDecay!==void 0&&(E.value=i[2].autoDecay),r=new Ee({props:E}),ve.push(()=>_e(r,"value",S));function P(f){i[17](f)}let D={label:"Tgt",options:[{value:"all",label:"All"},{value:"energy",label:"Energy"},{value:"treble",label:"Treble"},{value:"beat",label:"Beat"}]};return i[2].autoTarget!==void 0&&(D.value=i[2].autoTarget),u=new ei({props:D}),ve.push(()=>_e(u,"value",P)),{c(){e=w("div"),ne(n.$$.fragment),a=z(),s=w("div"),ne(r.$$.fragment),l=z(),c=w("div"),ne(u.$$.fragment),this.h()},l(f){e=_(f,"DIV",{title:!0});var M=I(e);ie(n.$$.fragment,M),M.forEach(v),a=R(f),s=_(f,"DIV",{title:!0});var y=I(s);ie(r.$$.fragment,y),y.forEach(v),l=R(f),c=_(f,"DIV",{title:!0});var X=I(c);ie(u.$$.fragment,X),X.forEach(v),this.h()},h(){m(e,"title","How strongly auto-adjust affects the visuals"),m(s,"title","How quickly auto-adjustments fade back to normal"),m(c,"title","Which audio metric to use for auto-adjustment")},m(f,M){U(f,e,M),te(n,e,null),U(f,a,M),U(f,s,M),te(r,s,null),U(f,l,M),U(f,c,M),te(u,c,null),h=!0},p(f,M){const y={};!t&&M&4&&(t=!0,y.value=f[2].autoStrength,ye(()=>t=!1)),n.$set(y);const X={};!o&&M&4&&(o=!0,X.value=f[2].autoDecay,ye(()=>o=!1)),r.$set(X);const A={};!d&&M&4&&(d=!0,A.value=f[2].autoTarget,ye(()=>d=!1)),u.$set(A)},i(f){h||($(n.$$.fragment,f),$(r.$$.fragment,f),$(u.$$.fragment,f),h=!0)},o(f){G(n.$$.fragment,f),G(r.$$.fragment,f),G(u.$$.fragment,f),h=!1},d(f){f&&(v(e),v(a),v(s),v(l),v(c)),ee(n),ee(r),ee(u)}}}function dn(i){let e,n,t=i[0]&&zt(i);return{c(){t&&t.c(),e=he()},l(a){t&&t.l(a),e=he()},m(a,s){t&&t.m(a,s),U(a,e,s),n=!0},p(a,[s]){a[0]?t?(t.p(a,s),s&1&&$(t,1)):(t=zt(a),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(De(),G(t,1,1,()=>{t=null}),Pe())},i(a){n||($(t),n=!0)},o(a){G(t),n=!1},d(a){a&&v(e),t&&t.d(a)}}}function cn(i,e,n){let t;we(i,be,y=>n(2,t=y));let{visible:a=!0}=e,s=!1;const r=y=>`${Math.round(y*100)}%`,o=()=>n(1,s=!s);function l(y){i.$$.not_equal(t.sensitivity,y)&&(t.sensitivity=y,be.set(t))}function c(y){i.$$.not_equal(t.beatBoost,y)&&(t.beatBoost=y,be.set(t))}function u(y){i.$$.not_equal(t.beatGate,y)&&(t.beatGate=y,be.set(t))}function d(y){i.$$.not_equal(t.highsBoost,y)&&(t.highsBoost=y,be.set(t))}function h(y){i.$$.not_equal(t.midsBoost,y)&&(t.midsBoost=y,be.set(t))}function b(y){i.$$.not_equal(t.lowsBoost,y)&&(t.lowsBoost=y,be.set(t))}function g(y){i.$$.not_equal(t.trebleBoost,y)&&(t.trebleBoost=y,be.set(t))}function S(y){i.$$.not_equal(t.bassBoost,y)&&(t.bassBoost=y,be.set(t))}function E(y){i.$$.not_equal(t.minMotion,y)&&(t.minMotion=y,be.set(t))}function P(y){i.$$.not_equal(t.autoEnabled,y)&&(t.autoEnabled=y,be.set(t))}function D(y){i.$$.not_equal(t.autoStrength,y)&&(t.autoStrength=y,be.set(t))}function f(y){i.$$.not_equal(t.autoDecay,y)&&(t.autoDecay=y,be.set(t))}function M(y){i.$$.not_equal(t.autoTarget,y)&&(t.autoTarget=y,be.set(t))}return i.$$set=y=>{"visible"in y&&n(0,a=y.visible)},[a,s,t,r,o,l,c,u,d,h,b,g,S,E,P,D,f,M]}class mn extends Be{constructor(e){super(),Ie(this,e,cn,dn,Le,{visible:0})}}function Ut(i){let e,n,t,a="PERFORMANCE",s,r,o=i[4]?"":"+",l,c,u,d,h,b="FPS",g,S,E=i[2].fps+"",P,D,f,M,y,X,A,T,V="Frame",C,O,N=i[2].frameTime.toFixed(1)+"",H,x,W,F="ms",L,k,q,K,j,Q,pe,Me,de=i[7]&&i[5]>0&&Vt(i),ue=i[4]&&Nt(i);function We(le,oe){return le[7]?pn:hn}let qe=We(i),Te=qe(i);return{c(){e=w("div"),n=w("div"),t=w("span"),t.textContent=a,s=z(),r=w("button"),l=se(o),c=z(),u=w("div"),d=w("div"),h=w("span"),h.textContent=b,g=z(),S=w("span"),P=se(E),D=z(),f=w("span"),M=se("/ "),y=se(i[1]),X=z(),A=w("div"),T=w("span"),T.textContent=V,C=z(),O=w("span"),H=se(N),x=z(),W=w("span"),W.textContent=F,L=z(),de&&de.c(),k=z(),ue&&ue.c(),q=z(),K=w("div"),j=w("span"),Te.c(),this.h()},l(le){e=_(le,"DIV",{class:!0});var oe=I(e);n=_(oe,"DIV",{class:!0});var He=I(n);t=_(He,"SPAN",{class:!0,"data-svelte-h":!0}),re(t)!=="svelte-18fq72a"&&(t.textContent=a),s=R(He),r=_(He,"BUTTON",{class:!0,title:!0});var fe=I(r);l=ae(fe,o),fe.forEach(v),He.forEach(v),c=R(oe),u=_(oe,"DIV",{class:!0});var B=I(u);d=_(B,"DIV",{class:!0});var Y=I(d);h=_(Y,"SPAN",{class:!0,"data-svelte-h":!0}),re(h)!=="svelte-1bu4eeu"&&(h.textContent=b),g=R(Y),S=_(Y,"SPAN",{class:!0,style:!0});var Fe=I(S);P=ae(Fe,E),Fe.forEach(v),D=R(Y),f=_(Y,"SPAN",{class:!0});var Ce=I(f);M=ae(Ce,"/ "),y=ae(Ce,i[1]),Ce.forEach(v),Y.forEach(v),X=R(B),A=_(B,"DIV",{class:!0});var Se=I(A);T=_(Se,"SPAN",{class:!0,"data-svelte-h":!0}),re(T)!=="svelte-1ikbzr0"&&(T.textContent=V),C=R(Se),O=_(Se,"SPAN",{class:!0});var Ue=I(O);H=ae(Ue,N),Ue.forEach(v),x=R(Se),W=_(Se,"SPAN",{class:!0,"data-svelte-h":!0}),re(W)!=="svelte-13w5gq7"&&(W.textContent=F),Se.forEach(v),L=R(B),de&&de.l(B),B.forEach(v),k=R(oe),ue&&ue.l(oe),q=R(oe),K=_(oe,"DIV",{class:!0});var Ve=I(K);j=_(Ve,"SPAN",{class:!0});var Ne=I(j);Te.l(Ne),Ne.forEach(v),Ve.forEach(v),oe.forEach(v),this.h()},h(){m(t,"class","panel-title svelte-yn9y4g"),m(r,"class","toggle-controls svelte-yn9y4g"),m(r,"title","Show performance controls"),m(n,"class","panel-header svelte-yn9y4g"),m(h,"class","label svelte-yn9y4g"),m(S,"class","value svelte-yn9y4g"),Ze(S,"color",i[6]),m(f,"class","target svelte-yn9y4g"),m(d,"class","stat svelte-yn9y4g"),m(T,"class","label svelte-yn9y4g"),m(O,"class","value svelte-yn9y4g"),m(W,"class","unit svelte-yn9y4g"),m(A,"class","stat svelte-yn9y4g"),m(u,"class","stats-grid svelte-yn9y4g"),m(j,"class","hint svelte-yn9y4g"),m(K,"class","panel-footer svelte-yn9y4g"),m(e,"class","panel perf-panel svelte-yn9y4g"),Z(e,"power-saver",i[7])},m(le,oe){U(le,e,oe),p(e,n),p(n,t),p(n,s),p(n,r),p(r,l),p(e,c),p(e,u),p(u,d),p(d,h),p(d,g),p(d,S),p(S,P),p(d,D),p(d,f),p(f,M),p(f,y),p(u,X),p(u,A),p(A,T),p(A,C),p(A,O),p(O,H),p(A,x),p(A,W),p(u,L),de&&de.m(u,null),p(e,k),ue&&ue.m(e,null),p(e,q),p(e,K),p(K,j),Te.m(j,null),Q=!0,pe||(Me=J(r,"click",i[10]),pe=!0)},p(le,oe){(!Q||oe&16)&&o!==(o=le[4]?"":"+")&&me(l,o),(!Q||oe&4)&&E!==(E=le[2].fps+"")&&me(P,E),(!Q||oe&64)&&Ze(S,"color",le[6]),(!Q||oe&2)&&me(y,le[1]),(!Q||oe&4)&&N!==(N=le[2].frameTime.toFixed(1)+"")&&me(H,N),le[7]&&le[5]>0?de?de.p(le,oe):(de=Vt(le),de.c(),de.m(u,null)):de&&(de.d(1),de=null),le[4]?ue?(ue.p(le,oe),oe&16&&$(ue,1)):(ue=Nt(le),ue.c(),$(ue,1),ue.m(e,q)):ue&&(De(),G(ue,1,1,()=>{ue=null}),Pe()),qe===(qe=We(le))&&Te?Te.p(le,oe):(Te.d(1),Te=qe(le),Te&&(Te.c(),Te.m(j,null))),(!Q||oe&128)&&Z(e,"power-saver",le[7])},i(le){Q||($(ue),Q=!0)},o(le){G(ue),Q=!1},d(le){le&&v(e),de&&de.d(),ue&&ue.d(),Te.d(),pe=!1,Me()}}}function Vt(i){let e,n,t="Saved",a,s,r,o,l;return{c(){e=w("div"),n=w("span"),n.textContent=t,a=z(),s=w("span"),r=se("~"),o=se(i[5]),l=se("%"),this.h()},l(c){e=_(c,"DIV",{class:!0});var u=I(e);n=_(u,"SPAN",{class:!0,"data-svelte-h":!0}),re(n)!=="svelte-dz9cv6"&&(n.textContent=t),a=R(u),s=_(u,"SPAN",{class:!0});var d=I(s);r=ae(d,"~"),o=ae(d,i[5]),l=ae(d,"%"),d.forEach(v),u.forEach(v),this.h()},h(){m(n,"class","label svelte-yn9y4g"),m(s,"class","value success svelte-yn9y4g"),m(e,"class","stat savings svelte-yn9y4g")},m(c,u){U(c,e,u),p(e,n),p(e,a),p(e,s),p(s,r),p(s,o),p(s,l)},p(c,u){u&32&&me(o,c[5])},d(c){c&&v(e)}}}function Nt(i){let e,n,t,a,s,r,o,l,c,u,d,h,b,g,S,E="Quick:",P,D,f="Mobile",M,y,X="Laptop",A,T,V="Desktop",C,O,N;function H(k){i[11](k)}let x={label:"Power Saver"};i[3].powerSaverEnabled!==void 0&&(x.checked=i[3].powerSaverEnabled),s=new Jt({props:x}),ve.push(()=>_e(s,"checked",H));function W(k){i[12](k)}let F={label:"Target",min:15,max:60,step:5,formatValue:i[8]};i[3].targetFps!==void 0&&(F.value=i[3].targetFps),c=new Ee({props:F}),ve.push(()=>_e(c,"value",W));let L=!i[7]&&Ot();return{c(){e=w("div"),n=z(),t=w("div"),a=w("div"),ne(s.$$.fragment),o=z(),l=w("div"),ne(c.$$.fragment),d=z(),L&&L.c(),b=z(),g=w("div"),S=w("span"),S.textContent=E,P=z(),D=w("button"),D.textContent=f,M=z(),y=w("button"),y.textContent=X,A=z(),T=w("button"),T.textContent=V,this.h()},l(k){e=_(k,"DIV",{class:!0}),I(e).forEach(v),n=R(k),t=_(k,"DIV",{class:!0});var q=I(t);a=_(q,"DIV",{title:!0});var K=I(a);ie(s.$$.fragment,K),K.forEach(v),o=R(q),l=_(q,"DIV",{class:!0,title:!0});var j=I(l);ie(c.$$.fragment,j),d=R(j),L&&L.l(j),j.forEach(v),b=R(q),g=_(q,"DIV",{class:!0});var Q=I(g);S=_(Q,"SPAN",{class:!0,"data-svelte-h":!0}),re(S)!=="svelte-9ap1jd"&&(S.textContent=E),P=R(Q),D=_(Q,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),re(D)!=="svelte-211gfj"&&(D.textContent=f),M=R(Q),y=_(Q,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),re(y)!=="svelte-mfdn79"&&(y.textContent=X),A=R(Q),T=_(Q,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),re(T)!=="svelte-13c6eed"&&(T.textContent=V),Q.forEach(v),q.forEach(v),this.h()},h(){m(e,"class","divider svelte-yn9y4g"),m(a,"title","Enable power saving mode to limit frame rate"),m(l,"class","fps-slider-wrapper svelte-yn9y4g"),m(l,"title",h=i[7]?"Target frames per second - lower values save more battery":"Enable Power Saver to limit frame rate"),Z(l,"disabled",!i[7]),m(S,"class","presets-label svelte-yn9y4g"),m(D,"class","preset-btn svelte-yn9y4g"),m(D,"title","24fps - Best for phones and old devices"),Z(D,"active",i[1]<=24),m(y,"class","preset-btn svelte-yn9y4g"),m(y,"title","30fps - Good for laptops on battery"),Z(y,"active",i[1]===30),m(T,"class","preset-btn svelte-yn9y4g"),m(T,"title","60fps - Full quality for desktops"),Z(T,"active",i[1]>=60&&!i[7]),m(g,"class","presets svelte-yn9y4g"),m(t,"class","controls-grid svelte-yn9y4g")},m(k,q){U(k,e,q),U(k,n,q),U(k,t,q),p(t,a),te(s,a,null),p(t,o),p(t,l),te(c,l,null),p(l,d),L&&L.m(l,null),p(t,b),p(t,g),p(g,S),p(g,P),p(g,D),p(g,M),p(g,y),p(g,A),p(g,T),C=!0,O||(N=[J(D,"click",i[13]),J(y,"click",i[14]),J(T,"click",i[15])],O=!0)},p(k,q){const K={};!r&&q&8&&(r=!0,K.checked=k[3].powerSaverEnabled,ye(()=>r=!1)),s.$set(K);const j={};!u&&q&8&&(u=!0,j.value=k[3].targetFps,ye(()=>u=!1)),c.$set(j),k[7]?L&&(L.d(1),L=null):L||(L=Ot(),L.c(),L.m(l,null)),(!C||q&128&&h!==(h=k[7]?"Target frames per second - lower values save more battery":"Enable Power Saver to limit frame rate"))&&m(l,"title",h),(!C||q&128)&&Z(l,"disabled",!k[7]),(!C||q&2)&&Z(D,"active",k[1]<=24),(!C||q&2)&&Z(y,"active",k[1]===30),(!C||q&130)&&Z(T,"active",k[1]>=60&&!k[7])},i(k){C||($(s.$$.fragment,k),$(c.$$.fragment,k),C=!0)},o(k){G(s.$$.fragment,k),G(c.$$.fragment,k),C=!1},d(k){k&&(v(e),v(n),v(t)),ee(s),ee(c),L&&L.d(),O=!1,ze(N)}}}function Ot(i){let e,n="Enable Power Saver to apply";return{c(){e=w("span"),e.textContent=n,this.h()},l(t){e=_(t,"SPAN",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-18yqm2c"&&(e.textContent=n),this.h()},h(){m(e,"class","slider-hint svelte-yn9y4g")},m(t,a){U(t,e,a)},d(t){t&&v(e)}}}function hn(i){let e;return{c(){e=se("Running at display refresh rate")},l(n){e=ae(n,"Running at display refresh rate")},m(n,t){U(n,e,t)},p:ge,d(n){n&&v(e)}}}function pn(i){let e,n,t,a,s;return{c(){e=se("Limiting to "),n=se(i[1]),t=se("fps ("),a=se(i[5]),s=se("% less GPU)")},l(r){e=ae(r,"Limiting to "),n=ae(r,i[1]),t=ae(r,"fps ("),a=ae(r,i[5]),s=ae(r,"% less GPU)")},m(r,o){U(r,e,o),U(r,n,o),U(r,t,o),U(r,a,o),U(r,s,o)},p(r,o){o&2&&me(n,r[1]),o&32&&me(a,r[5])},d(r){r&&(v(e),v(n),v(t),v(a),v(s))}}}function vn(i){let e,n,t=i[0]&&Ut(i);return{c(){t&&t.c(),e=he()},l(a){t&&t.l(a),e=he()},m(a,s){t&&t.m(a,s),U(a,e,s),n=!0},p(a,[s]){a[0]?t?(t.p(a,s),s&1&&$(t,1)):(t=Ut(a),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(De(),G(t,1,1,()=>{t=null}),Pe())},i(a){n||($(t),n=!0)},o(a){G(t),n=!1},d(a){a&&v(e),t&&t.d(a)}}}function gn(i,e,n){let t,a,s,r,o,l;we(i,Qt,f=>n(2,o=f)),we(i,ce,f=>n(3,l=f));let{visible:c=!0}=e,u=!1;const d=f=>`${Math.round(f)}`;function h(f){ce.update(M=>{switch(f){case"mobile":return{...M,powerSaverEnabled:!0,targetFps:24};case"laptop":return{...M,powerSaverEnabled:!0,targetFps:30};case"desktop":return{...M,powerSaverEnabled:!1,targetFps:60};default:return M}})}const b=()=>n(4,u=!u);function g(f){i.$$.not_equal(l.powerSaverEnabled,f)&&(l.powerSaverEnabled=f,ce.set(l))}function S(f){i.$$.not_equal(l.targetFps,f)&&(l.targetFps=f,ce.set(l))}const E=()=>h("mobile"),P=()=>h("laptop"),D=()=>h("desktop");return i.$$set=f=>{"visible"in f&&n(0,c=f.visible)},i.$$.update=()=>{i.$$.dirty&8&&n(7,t=l.powerSaverEnabled),i.$$.dirty&8&&n(1,a=l.targetFps),i.$$.dirty&6&&n(6,s=o.fps>=a*.9?"var(--color-success)":o.fps>=a*.5?"var(--color-warning, #f59e0b)":"var(--color-error, #ef4444)"),i.$$.dirty&2&&n(5,r=Math.round((1-a/60)*100))},[c,a,o,l,u,r,s,t,d,h,b,g,S,E,P,D]}class bn extends Be{constructor(e){super(),Ie(this,e,gn,vn,Le,{visible:0})}}function $t(i){let e,n,t,a="",s,r,o='<h1 id="info-title" class="svelte-199k3h4">SOUNDART</h1> <p class="tagline svelte-199k3h4">Audio-reactive WebGL visualizer that transforms sound into mesmerizing visuals in real-time.</p>',l,c,u='<section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Getting Started</h2> <ol class="svelte-199k3h4"><li class="svelte-199k3h4">Click <strong class="svelte-199k3h4">MIC ON</strong> to enable microphone</li> <li class="svelte-199k3h4">Play music or make sounds</li> <li class="svelte-199k3h4">Watch the visuals react!</li></ol></section> <section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Keyboard Shortcuts</h2> <div class="shortcuts svelte-199k3h4"><div class="shortcut svelte-199k3h4"><kbd class="svelte-199k3h4">C</kbd><span>Toggle control panels</span></div> <div class="shortcut svelte-199k3h4"><kbd class="svelte-199k3h4">F</kbd><span>Toggle fullscreen</span></div> <div class="shortcut svelte-199k3h4"><kbd class="svelte-199k3h4">?</kbd><span>Show/hide this help</span></div></div></section> <section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Touch Controls</h2> <div class="shortcuts svelte-199k3h4"><div class="shortcut svelte-199k3h4"><span class="gesture svelte-199k3h4">Single tap</span><span>Toggle panels</span></div> <div class="shortcut svelte-199k3h4"><span class="gesture svelte-199k3h4">Double tap</span><span>Toggle fullscreen</span></div></div></section> <section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Layers</h2> <ul class="svelte-199k3h4"><li class="svelte-199k3h4">Toggle layers on/off with the indicator dot</li> <li class="svelte-199k3h4">Click <strong class="svelte-199k3h4">+</strong> to expand and adjust settings</li> <li class="svelte-199k3h4">Adjust <strong class="svelte-199k3h4">intensity</strong>, <strong class="svelte-199k3h4">zoom</strong>, <strong class="svelte-199k3h4">theme</strong>, and <strong class="svelte-199k3h4">sensitivity</strong></li></ul> <h3 class="svelte-199k3h4">Global Controls</h3> <ul class="svelte-199k3h4"><li class="svelte-199k3h4"><strong class="svelte-199k3h4">RANDOM</strong> - Enable automatic parameter changes on beats</li> <li class="svelte-199k3h4"><strong class="svelte-199k3h4">STROBE</strong> - Enable layers flashing on/off with beats</li></ul> <h3 class="svelte-199k3h4">Per-Layer Buttons</h3> <div class="button-legend svelte-199k3h4"><div class="legend-item svelte-199k3h4"><span class="legend-btn r svelte-199k3h4">R</span><span>Include in randomizer (theme/intensity/zoom)</span></div> <div class="legend-item svelte-199k3h4"><span class="legend-btn s svelte-199k3h4">S</span><span>Include in strobe (flash on/off)</span></div></div></section> <section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Audio Tuning</h2> <ul class="svelte-199k3h4"><li class="svelte-199k3h4"><strong class="svelte-199k3h4">Global sensitivity</strong>: overall audio reactivity</li> <li class="svelte-199k3h4"><strong class="svelte-199k3h4">Frequency boosts</strong>: enhance specific ranges</li> <li class="svelte-199k3h4"><strong class="svelte-199k3h4">Beat gate</strong>: threshold for beat detection</li> <li class="svelte-199k3h4"><strong class="svelte-199k3h4">Auto-suggest</strong>: automatic sensitivity adjustment</li></ul></section> <section class="svelte-199k3h4"><h2 class="svelte-199k3h4"> Tips</h2> <ul class="svelte-199k3h4"><li class="svelte-199k3h4">Use <strong class="svelte-199k3h4">fullscreen</strong> for best experience</li> <li class="svelte-199k3h4">Try different <strong class="svelte-199k3h4">themes</strong> on each layer</li> <li class="svelte-199k3h4">Adjust <strong class="svelte-199k3h4">sensitivity</strong> if visuals are too subtle or intense</li> <li class="svelte-199k3h4">Enable <strong class="svelte-199k3h4">Power Saver</strong> on laptops to save battery</li></ul></section>',d,h,b='<span>Press <kbd class="svelte-199k3h4">?</kbd> or tap the help button to reopen</span>',g,S;return{c(){e=w("div"),n=w("div"),t=w("button"),t.textContent=a,s=z(),r=w("header"),r.innerHTML=o,l=z(),c=w("div"),c.innerHTML=u,d=z(),h=w("footer"),h.innerHTML=b,this.h()},l(E){e=_(E,"DIV",{class:!0});var P=I(e);n=_(P,"DIV",{class:!0,role:!0,"aria-modal":!0,"aria-labelledby":!0});var D=I(n);t=_(D,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),re(t)!=="svelte-h7on2u"&&(t.textContent=a),s=R(D),r=_(D,"HEADER",{class:!0,"data-svelte-h":!0}),re(r)!=="svelte-1jvg3xd"&&(r.innerHTML=o),l=R(D),c=_(D,"DIV",{class:!0,"data-svelte-h":!0}),re(c)!=="svelte-1k0sc2q"&&(c.innerHTML=u),d=R(D),h=_(D,"FOOTER",{class:!0,"data-svelte-h":!0}),re(h)!=="svelte-5jo3kb"&&(h.innerHTML=b),D.forEach(v),P.forEach(v),this.h()},h(){m(t,"class","close-btn svelte-199k3h4"),m(t,"aria-label","Close"),m(r,"class","info-header svelte-199k3h4"),m(c,"class","info-content svelte-199k3h4"),m(h,"class","info-footer svelte-199k3h4"),m(n,"class","info-panel svelte-199k3h4"),m(n,"role","dialog"),m(n,"aria-modal","true"),m(n,"aria-labelledby","info-title"),m(e,"class","overlay svelte-199k3h4")},m(E,P){U(E,e,P),p(e,n),p(n,t),p(n,s),p(n,r),p(n,l),p(n,c),p(n,d),p(n,h),g||(S=[J(t,"click",i[1]),J(e,"click",i[3])],g=!0)},p:ge,d(E){E&&v(e),g=!1,ze(S)}}}function yn(i){let e,n,t,a=i[0]&&$t(i);return{c(){a&&a.c(),e=he()},l(s){a&&a.l(s),e=he()},m(s,r){a&&a.m(s,r),U(s,e,r),n||(t=J(window,"keydown",i[2]),n=!0)},p(s,[r]){s[0]?a?a.p(s,r):(a=$t(s),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null)},i:ge,o:ge,d(s){s&&v(e),a&&a.d(s),n=!1,t()}}}const qt="soundart-seen-info";function _n(i,e,n){let{visible:t=!1}=e,{onClose:a}=e;function s(){return!localStorage.getItem(qt)}function r(){localStorage.setItem(qt,"true")}function o(){r(),a()}function l(u){u.key==="Escape"&&t&&o()}function c(u){u.target===u.currentTarget&&o()}return i.$$set=u=>{"visible"in u&&n(0,t=u.visible),"onClose"in u&&n(4,a=u.onClose)},[t,o,l,c,a,s]}class wn extends Be{constructor(e){super(),Ie(this,e,_n,yn,Le,{visible:0,onClose:4,shouldShowOnFirstVisit:5})}get shouldShowOnFirstVisit(){return this.$$.ctx[5]}}function Tn(i){let e,n,t,a,s,r,o,l,c,u,d,h,b,g,S,E,P,D={};return n=new $i({props:D}),i[10](n),a=new tn({props:{onEnableMic:i[4],onDisableMic:i[5],onShowInfo:i[6],visible:i[3].panelsVisible}}),r=new rn({props:{visible:i[3].panelsVisible}}),l=new fn({props:{visible:i[3].panelsVisible}}),u=new mn({props:{visible:i[3].panelsVisible}}),h=new bn({props:{visible:i[3].panelsVisible}}),g=new wn({props:{visible:i[1],onClose:i[7]}}),{c(){e=w("main"),ne(n.$$.fragment),t=z(),ne(a.$$.fragment),s=z(),ne(r.$$.fragment),o=z(),ne(l.$$.fragment),c=z(),ne(u.$$.fragment),d=z(),ne(h.$$.fragment),b=z(),ne(g.$$.fragment),this.h()},l(f){e=_(f,"MAIN",{class:!0});var M=I(e);ie(n.$$.fragment,M),t=R(M),ie(a.$$.fragment,M),s=R(M),ie(r.$$.fragment,M),o=R(M),ie(l.$$.fragment,M),c=R(M),ie(u.$$.fragment,M),d=R(M),ie(h.$$.fragment,M),b=R(M),ie(g.$$.fragment,M),M.forEach(v),this.h()},h(){m(e,"class","app svelte-oysh0a"),Z(e,"cursor-hidden",i[2])},m(f,M){U(f,e,M),te(n,e,null),p(e,t),te(a,e,null),p(e,s),te(r,e,null),p(e,o),te(l,e,null),p(e,c),te(u,e,null),p(e,d),te(h,e,null),p(e,b),te(g,e,null),S=!0,E||(P=[J(window,"keydown",i[8]),J(window,"mousemove",i[9])],E=!0)},p(f,[M]){const y={};n.$set(y);const X={};M&8&&(X.visible=f[3].panelsVisible),a.$set(X);const A={};M&8&&(A.visible=f[3].panelsVisible),r.$set(A);const T={};M&8&&(T.visible=f[3].panelsVisible),l.$set(T);const V={};M&8&&(V.visible=f[3].panelsVisible),u.$set(V);const C={};M&8&&(C.visible=f[3].panelsVisible),h.$set(C);const O={};M&2&&(O.visible=f[1]),g.$set(O),(!S||M&4)&&Z(e,"cursor-hidden",f[2])},i(f){S||($(n.$$.fragment,f),$(a.$$.fragment,f),$(r.$$.fragment,f),$(l.$$.fragment,f),$(u.$$.fragment,f),$(h.$$.fragment,f),$(g.$$.fragment,f),S=!0)},o(f){G(n.$$.fragment,f),G(a.$$.fragment,f),G(r.$$.fragment,f),G(l.$$.fragment,f),G(u.$$.fragment,f),G(h.$$.fragment,f),G(g.$$.fragment,f),S=!1},d(f){f&&v(e),i[10](null),ee(n),ee(a),ee(r),ee(l),ee(u),ee(h),ee(g),E=!1,ze(P)}}}const nt="soundart-seen-info",kn=3e3;function En(i,e,n){let t;we(i,ce,f=>n(3,t=f));let a,s=!1,r=!1,o=null;async function l(){return a?await a.enableMicrophone():!1}function c(){a&&a.disableMicrophone()}function u(){n(1,s=!0)}function d(){n(1,s=!1),localStorage.setItem(nt,"true")}function h(){s?d():u()}function b(f){if(!(f.target instanceof HTMLInputElement||f.target instanceof HTMLTextAreaElement))switch(f.key){case"?":h();break;case"c":case"C":s||gi();break;case"f":case"F":s||g();break}}async function g(){document.fullscreenElement?(await document.exitFullscreen(),ce.update(f=>({...f,fullscreen:!1}))):(await document.documentElement.requestFullscreen(),ce.update(f=>({...f,fullscreen:!0})))}function S(){ce.update(f=>({...f,fullscreen:!!document.fullscreenElement}))}function E(){r&&n(2,r=!1),o&&clearTimeout(o),o=setTimeout(()=>{n(2,r=!0)},kn)}function P(){E()}Ht(()=>{document.addEventListener("fullscreenchange",S),E(),localStorage.getItem(nt)||setTimeout(()=>{n(1,s=!0)},800);const f=localStorage.getItem(nt)?500:1500;return setTimeout(()=>{l()},f),()=>{document.removeEventListener("fullscreenchange",S),o&&clearTimeout(o)}});function D(f){ve[f?"unshift":"push"](()=>{a=f,n(0,a)})}return[a,s,r,t,l,c,u,d,b,P,D]}class Bn extends Be{constructor(e){super(),Ie(this,e,En,Tn,Le,{})}}export{Bn as component};
